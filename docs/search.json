[
  {
    "objectID": "code_climate_forest_regeneration.html",
    "href": "code_climate_forest_regeneration.html",
    "title": "Packages",
    "section": "",
    "text": "library(ggplot2)\nlibrary(RColorBrewer)\nlibrary(writexl)\nlibrary(extrafont)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(grid)\nlibrary(gridExtra)\nlibrary(gtable)\nlibrary(ggpubr)\nlibrary(car)\nlibrary(dunn.test)\nlibrary(data.table)\nlibrary(rstatix)\nlibrary(tidyr)\nlibrary(purrr)\nlibrary(patchwork)\nlibrary(reshape2)\nlibrary(ggthemes)\nlibrary(sf)\nlibrary(scales)"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#filtragem---pixels-não-puros",
    "href": "code_climate_forest_regeneration.html#filtragem---pixels-não-puros",
    "title": "Packages",
    "section": "Filtragem - Pixels “não-puros”",
    "text": "Filtragem - Pixels “não-puros”\n\n# Condicionais\nall_lulc_fil_50 &lt;- all_lulc %&gt;%\n  filter(\n    # PF ausente e SF predominante\n    (frac_area_SF &gt; 0.5 & frac_area_PF == 0) |\n    \n    # SF baixo sem outros usos dominantes\n    (frac_area_SF &gt; 0 & frac_area_SF &lt;= 0.5 & \n     (frac_area_PF + frac_area_Agriculture + frac_area_Pasture) &lt; frac_area_SF) |\n    \n    # SF ausente e PF predominante\n    (frac_area_SF == 0 & frac_area_PF &gt; 0.5) |\n    \n    # PF baixo sem outros usos dominantes\n    (frac_area_PF &gt; 0 & frac_area_PF &lt;= 0.5 & \n     (frac_area_Agriculture + frac_area_Pasture + frac_area_SF) &lt; frac_area_PF) |\n    \n    # Para avaliar o histórico é importante ter os casos abaixo  \n    # Florestas ausentes e AG presente\n    (frac_area_SF == 0 & frac_area_PF == 0 & frac_area_Agriculture &gt;= 0.1) |\n    \n    # Florestas ausentes e Pasture presente\n    (frac_area_SF == 0 & frac_area_PF == 0 & frac_area_Pasture &gt;= 0.1)\n    )\n\n# Exportar planilha filtrada\nfwrite(all_lulc_fil_50, file = \"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_fil_all_lulc.csv\")\n\n\n# Transformar colunas de fração de volta para formato original\nall_lulc_long_50 &lt;- melt(all_lulc_fil_50, \n                         id.vars = c(\"Lon\", \"Lat\", \"Prec\", \"Evapo\", \"Temp\", \"Region\", \"Ano\", \"Idade_SF\"),\n                         variable.name = \"Tipo\", \n                         value.name = \"frac_area\")\n\n# Converter para data.table antes de usar :=\nsetDT(all_lulc_long_50)\n\n# Ajustar nomes de Tipo para corresponder ao original\nall_lulc_long_50[, Tipo := gsub(\"frac_area_\", \"\", Tipo)]\n\n# Remover pixels onde a fração de área é 1% (~1 ha)\nall_lulc_50_final &lt;- all_lulc_long_50[frac_area &gt; 0.01]\n\n## Exportar\nfwrite(all_lulc_50_final, file = \"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv\")\n\nrm(all_lulc)\nrm(all_lulc_fil_50)\nrm(all_lulc_long_50)\n#rm(all_lulc_50_final)\n\ngc()\n\n\n# Contagem de dados por região DEPOIS da filtragem\n\n## CBA\nn_obs_cba_d &lt;- all_lulc_50_final %&gt;% \n  filter(Region == \"CBA\")\n\n## EBA\nn_obs_eba_d &lt;- all_lulc_50_final %&gt;% \n  filter(Region == \"EBA\")\n\n## SBA\nn_obs_sba_d &lt;- all_lulc_50_final %&gt;% \n  filter(Region == \"SBA\")"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#plot---observações",
    "href": "code_climate_forest_regeneration.html#plot---observações",
    "title": "Packages",
    "section": "Plot - Observações",
    "text": "Plot - Observações\n\n## Obter contagens\nbefore &lt;- c(\n  CBA = nrow(n_obs_cba_a),\n  EBA = nrow(n_obs_eba_a),\n  SBA = nrow(n_obs_sba_a)\n)\n\nafter &lt;- c(\n  CBA = nrow(n_obs_cba_d),\n  EBA = nrow(n_obs_eba_d),\n  SBA = nrow(n_obs_sba_d)\n)\n\nreducoes_percentuais &lt;- round((before - after) / before * 100, 1)\nregioes &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Data frame em formato longo com valores intercalados\ndf_plot &lt;- data.frame(\n  Regiao = rep(regioes, each = 2),\n  Status = factor(rep(c(\"Before\", \"After\"), times = 3), levels = c(\"Before\", \"After\")),\n  Observacoes = as.vector(rbind(before, after))\n)\n\n# Posição dos rótulos acima de cada barra correspondente\ndf_text &lt;- df_plot %&gt;%\n  group_by(Regiao) %&gt;%\n  summarize(y_pos = max(Observacoes) * 1.05) %&gt;%\n  mutate(\n    x_pos = Regiao,\n    Reducao = paste0(\"-\", reducoes_percentuais, \"%\")\n  )\n\n# Gráfico\n# Esse gráfio já inclui observações de Agriulture e Pasture\n# O gráfico com o número de observações sem esses usos foi gerado antes\nggplot(df_plot, aes(x = Regiao, y = Observacoes, fill = Status)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.7), width = 0.6) +\n  geom_text(data = df_text, aes(x = x_pos, y = y_pos, label = Reducao),\n            inherit.aes = FALSE, size = 3, fontface = \"bold\", family = \"serif\") +\n  scale_fill_manual(values = c(\"Before\" = \"skyblue\", \"After\" = \"lightgreen\")) +\n  labs(\n    title = \"\",\n    y = \"Number of observations (pixels)\", x = \"\", fill = \"\"\n  ) +\n  ggthemes::theme_few()+\n  theme(legend.position = c(0.15, 0.90),\n    legend.background = element_rect(fill = \"transparent\"),\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n    axis.title.y = element_text(size = 10))\n\n# Salvando a figura\n#ggsave(\"fig/observatios_before_after.png\", dpi = 600)\n\n\nrm(n_obs_cba_a, n_obs_eba_a, n_obs_sba_a)\nrm(n_obs_cba_d, n_obs_eba_d, n_obs_sba_d)\nrm(df_plot, df_text)\n\ngc()"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#precipitation",
    "href": "code_climate_forest_regeneration.html#precipitation",
    "title": "Packages",
    "section": "PRECIPITATION",
    "text": "PRECIPITATION\n\nLeitura dos dados\n\n# Lendo a planilha\nall_lulc_50_final &lt;- fread(\"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv\")\n\nall_lulc_50_fil &lt;- all_lulc_50_final %&gt;% \n   filter(Tipo %in% c(\"SF\", \"PF\"))\n\n#rm(all_lulc_50_final)\n\n## CBA\nn_obs_cba_d &lt;- all_lulc_50_fil %&gt;% \n  filter(Region == \"CBA\")\n\n## EBA\nn_obs_eba_d &lt;- all_lulc_50_fil %&gt;% \n  filter(Region == \"EBA\")\n\n## SBA\nn_obs_sba_d &lt;- all_lulc_50_fil %&gt;% \n  filter(Region == \"SBA\")\n\n\ngc()\n\n\n\nAgrupamento\n\n# Criar intervalos de fração de área \nall_lulc_prec &lt;- all_lulc_50_fil %&gt;% \n  summarise(\n    Prec = Prec,\n    Frac = frac_area,\n    Tipo = Tipo,\n    Ano = Ano,\n    region = Region,\n    Idade = Idade_SF\n  ) %&gt;%\n  mutate(\n    ff_area = case_when(Frac &gt;= 0.01 & Frac &lt;= 0.1 ~ \"1-10\",\n                        Frac &gt; 0.1 & Frac &lt;= 0.2 ~ \"10-20\",\n                        Frac &gt; 0.2 & Frac &lt;= 0.3 ~ \"20-30\",\n                        Frac &gt; 0.3 & Frac &lt;= 0.4 ~ \"30-40\",\n                        Frac &gt; 0.4 & Frac &lt;= 0.5 ~ \"40-50\",\n                        Frac &gt; 0.5 & Frac &lt;= 0.6 ~ \"50-60\",\n                        Frac &gt; 0.6 & Frac &lt;= 0.7 ~ \"60-70\",\n                        Frac &gt; 0.7 & Frac &lt;= 0.8 ~ \"70-80\",\n                        Frac &gt; 0.8 & Frac &lt;= 0.9 ~ \"80-90\",\n                        Frac &gt; 0.9 & Frac &lt;= 1.0 ~ \"90-100\")) %&gt;%\n  mutate(\n    idade = case_when(Idade &gt;= 0 & Idade &lt;= 10 ~ \"&lt;= 10\",\n                      Idade &gt; 10 & Idade &lt;= 20 ~ \"10-20\",\n                      Idade &gt; 20 ~ \"&gt; 20\")) %&gt;%\n  # Calcular a precipitação média para cada agrupamento\n  group_by(Ano, Tipo, region, ff_area, idade) %&gt;% \n  summarise(\n    Prec = mean(Prec),\n    n_obs = n(),\n    .groups = \"drop\"\n  )\n\n\n# Criar o novo dataframe com as categorias desejadas\nall_lulc_prec_stages &lt;- all_lulc_prec %&gt;%\n  mutate(Tipo = case_when(Tipo == \"PF\" ~ \"PF\",\n                          Tipo == \"SF\" & idade == \"&lt;= 10\" ~ \"SF_early\",\n                          Tipo == \"SF\" & idade == \"10-20\" ~ \"SF_intermediate\",\n                          Tipo == \"SF\" & idade == \"&gt; 20\" ~ \"SF_advanced\",\n                          TRUE ~ NA_character_)) %&gt;% \n  filter(!is.na(Tipo))  # Remove linhas que não se encaixam nas categorias definidas\n\n\nall_lulc_prec_final &lt;- all_lulc_prec_stages %&gt;% \n  mutate(type = case_when(Tipo == \"PF\" ~ 1,\n                          Tipo == \"SF_early\" ~ 2, \n                          Tipo == \"SF_intermediate\" ~ 3,\n                          Tipo == \"SF_advanced\" ~ 4))\n\n# Verificar o resultado\n#head(all_lulc_prec_final)\n\n# Calcular valores máximos e mínimos\nmax_min_prec = all_lulc_prec_final %&gt;%\n  group_by(Tipo, region, ff_area, idade) %&gt;%\n  summarise(\n    max_prec = max(Prec),\n    median_prec = median(Prec),\n    min_prec = min(Prec)\n  )\n\n# Exportar dados min e max\nwrite_xlsx(max_min_prec, \"data_group/plan_max_and_min_group_prec.xlsx\")\n\n# Exportar dados agrupados\nwrite_xlsx(all_lulc_prec_final, \"data_group/plan_data_group_prec.xlsx\")\n\nrm(all_lulc_prec, all_lulc_prec_stages)\nrm(max_min_prec)\n\ngc()\n\n\n\nTestes normalidade, homocedasticidade e independência\n\nall_pf_sf_prec = read_xlsx(\"data_group/plan_data_group_prec.xlsx\")\n\n# ---- NORMALIDADE ----\n\n# Realizar o teste de normalidade Shapiro-Wilk \nshapiro_test_results_prec &lt;- all_pf_sf_prec %&gt;%\n  group_by(Tipo, region, ff_area) %&gt;%\n  summarise(\n    p_value = shapiro.test(Prec)$p.value\n  ) %&gt;%\n  ungroup()\n\n# Visualizar os resultados do teste Shapiro-Wilk\nprint(shapiro_test_results_prec)\n\n# A tibble: 120 × 4\n   Tipo  region ff_area p_value\n   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;\n 1 PF    CBA    1-10      0.214\n 2 PF    CBA    10-20     0.226\n 3 PF    CBA    20-30     0.225\n 4 PF    CBA    30-40     0.234\n 5 PF    CBA    40-50     0.254\n 6 PF    CBA    50-60     0.277\n 7 PF    CBA    60-70     0.264\n 8 PF    CBA    70-80     0.269\n 9 PF    CBA    80-90     0.276\n10 PF    CBA    90-100    0.369\n# ℹ 110 more rows\n\n# Exportar os resultados do teste de normalidade\nwrite_xlsx(shapiro_test_results_prec, \"data_group/shapiro_test_prec_results.xlsx\")\n\n\n# ---- HOMOCEDASTICIDADE ----\n\n# Garantindo que 'Tipo' seja tratado como fator\nall_pf_sf_prec$Tipo &lt;- as.factor(all_pf_sf_prec$Tipo)\n\n# Lista para armazenar os resultados\nresults_list_prec &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_prec$region)) {\n  for (ff_area in unique(all_pf_sf_prec$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_prec %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de homocedasticidade Levene\n        levene_test_prec &lt;- leveneTest(Prec ~ Tipo, data = data_subset)\n        p_value &lt;- levene_test_prec$`Pr(&gt;F)`[1]  # Extraindo o valor p\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      results_list_prec[[length(results_list_prec) + 1]] &lt;- data.frame(region = region, \n                                                             ff_area = ff_area, \n                                                             p_value = p_value)\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nlevene_test_results_prec &lt;- do.call(rbind, results_list_prec)\n\n# Exibir os resultados\nprint(levene_test_results_prec)\n\n   region ff_area    p_value\n1     CBA    1-10 0.97612362\n2     CBA   10-20 0.96298538\n3     CBA   20-30 0.90512857\n4     CBA   30-40 0.87575188\n5     CBA   40-50 0.89582737\n6     CBA   50-60 0.80278687\n7     CBA   60-70 0.92194092\n8     CBA   70-80 0.87427106\n9     CBA   80-90 0.46685617\n10    CBA  90-100 0.43278138\n11    EBA    1-10 0.90631834\n12    EBA   10-20 0.79987035\n13    EBA   20-30 0.51196046\n14    EBA   30-40 0.30137629\n15    EBA   40-50 0.32205969\n16    EBA   50-60 0.28913497\n17    EBA   60-70 0.21004335\n18    EBA   70-80 0.39408038\n19    EBA   80-90 0.27698009\n20    EBA  90-100 0.59767399\n21    SBA    1-10 0.96881838\n22    SBA   10-20 0.98244171\n23    SBA   20-30 0.95976760\n24    SBA   30-40 0.90811530\n25    SBA   40-50 0.83891510\n26    SBA   50-60 0.71954247\n27    SBA   60-70 0.61771648\n28    SBA   70-80 0.56330832\n29    SBA   80-90 0.25748618\n30    SBA  90-100 0.05150868\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(levene_test_results_prec, \"data_group/levene_test_prec_results.xlsx\")\n\n\n# ---- INDEPENDÊNCIA ----\n\n\n# Lista para armazenar os resultados\nkendall_results_list_prec &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_prec$region)) {\n  for (ff_area in unique(all_pf_sf_prec$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_prec %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de correlação de Kendall entre 'Prec' e 'Tipo'\n        cor_test &lt;- cor.test(as.numeric(data_subset$Prec), as.numeric(data_subset$Tipo), method = \"kendall\")\n        p_value &lt;- cor_test$p.value  # Extraindo o valor p\n        cor_value &lt;- cor_test$estimate  # Extraindo o valor da correlação\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n      cor_value &lt;- NA\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      kendall_results_list_prec[[length(kendall_results_list_prec) + 1]] &lt;- data.frame(\n        region = region, \n        ff_area = ff_area, \n        cor_value = cor_value,\n        p_value = p_value\n      )\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nkendall_test_results_prec &lt;- do.call(rbind, kendall_results_list_prec)\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(kendall_test_results_prec, \"data_group/kendall_test_prec_results.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1551429 82.9    2951642 157.7  2161542 115.5\nVcells 2791553 21.3    8388608  64.0  3894952  29.8\n\n\n\n\nTeste t entre os tipos de cobertura - PF e SF\n\n# -------------------------------------------------------------------------------\n# OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - PULAR PARA RODAR O TESTE NÃO PARAMÉTRICO \n# -------------------------------------------------------------------------------\n\n# Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame para armazenar os resultados\nsignificance_results_t_prec &lt;- data.frame(Intervalo = area_ranges)\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados\n    pv_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste t para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, t.test(pv_data$Prec, sv_early_data$Prec, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, t.test(pv_data$Prec, sv_intermediate_data$Prec, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, t.test(pv_data$Prec, sv_advanced_data$Prec, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_t_prec[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_t_prec[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_t_prec[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_t_prec, \"data_group/significance_results_prec_testt.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1554154 83.1    2951642 157.7  2951642 157.7\nVcells 2799174 21.4    8388608  64.0  3983595  30.4\n\n\n\n\nTeste Wilcox entre os tipos de cobertura - PF e SF\n\n# Leitura da planilha com os dados\nall_pf_sf_prec = read_xlsx(\"data_group/plan_data_group_prec.xlsx\")\n\n#Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\",\n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame para armazenar os resultados\nsignificance_results_w_prec &lt;- data.frame(Intervalo = area_ranges)\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados\n    pv_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_prec %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste de Wilcoxon para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, wilcox.test(pv_data$Prec, sv_early_data$Prec, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, wilcox.test(pv_data$Prec, sv_intermediate_data$Prec, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, wilcox.test(pv_data$Prec, sv_advanced_data$Prec, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_w_prec[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_w_prec[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_w_prec[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_w_prec, \"data_group/significance_results_prec_Wilcox_test.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1558202 83.3    2951642 157.7  2951642 157.7\nVcells 2809389 21.5    8388608  64.0  4125453  31.5\n\n\n\nPlot com significance\n\n# Criar um dataframe \"long\" de significância, onde cada linha tem uma região e o intervalo associado\nlong_significance_results_w_prec &lt;- significance_results_w_prec %&gt;%\n  gather(key = \"Comparison\", value = \"P_value\", -Intervalo) %&gt;%\n  separate(Comparison, into = c(\"region\", \"Comparison_Type\"), sep = \"_PF_vs_\")\n\n# Mesclar esses resultados com os dados originais\nall_pf_sf_prec &lt;- all_pf_sf_prec %&gt;%\n  left_join(long_significance_results_w_prec, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\"))\n\n# Adicionando uma coluna indicando se o intervalo foi significativo\nall_pf_sf_prec$Significant &lt;- ifelse(all_pf_sf_prec$P_value &lt; 0.05, \"*\", \"\")\n\n# Reordenar os níveis de 'Tipo'\nall_pf_sf_prec &lt;- all_pf_sf_prec %&gt;%\n  mutate(Tipo = factor(Tipo, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n# Função para calcular o valor máximo do bigode\nget_whisker_max &lt;- function(x) {\n  stats &lt;- boxplot.stats(x)$stats\n  return(stats[5]) # stats[5] normalmente corresponde ao valor máximo do bigode\n}\n\n\n# Calcular a posição do asterisco\nsignificance_positions &lt;- all_pf_sf_prec %&gt;%\n  group_by(ff_area, region, Tipo) %&gt;%\n  summarise(max_whisker = get_whisker_max(Prec), .groups = \"drop\") %&gt;%\n  left_join(long_significance_results_w_prec, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\")) %&gt;%\n  filter(P_value &lt; 0.05) %&gt;%\n  mutate(\n    asterisk_y = max_whisker + 15, # Ajuste para posicionar acima do bigode\n    x_adjust = case_when(\n      Tipo == \"SF_early\" ~ -0.1,\n      Tipo == \"SF_intermediate\" ~ 0.1,\n      Tipo == \"SF_advanced\" ~ 0.3\n    ),\n    x_pos = as.numeric(factor(ff_area, levels = area_ranges)) + x_adjust\n  )\n\n#head(significance_positions)\n\n# Plot\np_ast_prec_w &lt;- all_pf_sf_prec %&gt;%\n  ggplot(aes(x = ff_area, y = Prec, fill = Tipo)) +\n  geom_boxplot(outlier.alpha = 0.4) +\n  facet_grid(~region) + \n  ggthemes::theme_few() +\n  theme(\n    legend.position = c(0.77, 0.84),\n    legend.background = element_rect(fill = \"transparent\"),\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"), \n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n    axis.text.x = element_blank(),\n    legend.text = element_text(size = 9),\n    panel.spacing.x = unit(1, \"lines\"), \n    panel.spacing.y = unit(1, \"lines\"),\n    axis.title = element_text(size = 14, margin = margin(r = 20)),\n    strip.text = element_text(size = 14, face = \"bold\", family = \"serif\")\n  ) +\n  scale_fill_manual(values = c(\"midnightblue\", \"#87CEFA\", \"#1E90FF\", \"#0000FF\"), name = NULL, labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(0, max(all_pf_sf_prec$Prec, na.rm = TRUE), by = 250)) +\n  labs(\n    x = \"\",\n    y = \"Average annual accumulated \\n precipitation (mm)\",\n    #y = expression(atop(\"Average annual accumulated\", paste(\"precipitation (mm·\", yr^{-1}, \")\")))\n  ) +\n  # Adicionando os asteriscos\n  geom_text(data = significance_positions, aes(x = x_pos, y = asterisk_y, label = \"*\"),\n            size = 3, color = \"red\")\n\np_ast_prec_w\n\n\n\n\n\n\n\n# Salvando a figura\nggsave(\"fig/area_x_prec_pf_sf_significant_asterisco_wilcoxon.png\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1913012 102.2    2951642 157.7  2951642 157.7\nVcells 3479462  26.6    8388608  64.0  5680635  43.4"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#evapotranspiration",
    "href": "code_climate_forest_regeneration.html#evapotranspiration",
    "title": "Packages",
    "section": "EVAPOTRANSPIRATION",
    "text": "EVAPOTRANSPIRATION\n\nAgrupamento\n\n# Lendo a planilha\n# all_lulc_50_final = fread(\"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv\")\n# \n# all_lulc_50_fil &lt;- all_lulc_50_final %&gt;%\n#    filter(Tipo %in% c(\"SF\", \"PF\"))\n\n# Creating area ranges to store the averages of each range\nall_lulc_evapo = all_lulc_50_fil %&gt;%\n  filter(!Evapo &gt;= 2000) %&gt;% \n  summarise(\n    Evapo = Evapo,\n    Frac = frac_area,\n    Tipo = Tipo,\n    Ano = Ano,\n    region = Region,\n    Idade = Idade_SF\n  ) %&gt;%\n  mutate(\n    ff_area = case_when(Frac &gt;= 0.01 & Frac &lt;= 0.1 ~ \"1-10\",\n                        Frac &gt; 0.1 & Frac &lt;= 0.2 ~ \"10-20\",\n                        Frac &gt; 0.2 & Frac &lt;= 0.3 ~ \"20-30\",\n                        Frac &gt; 0.3 & Frac &lt;= 0.4 ~ \"30-40\",\n                        Frac &gt; 0.4 & Frac &lt;= 0.5 ~ \"40-50\",\n                        Frac &gt; 0.5 & Frac &lt;= 0.6 ~ \"50-60\",\n                        Frac &gt; 0.6 & Frac &lt;= 0.7 ~ \"60-70\",\n                        Frac &gt; 0.7 & Frac &lt;= 0.8 ~ \"70-80\",\n                        Frac &gt; 0.8 & Frac &lt;= 0.9 ~ \"80-90\",\n                        Frac &gt; 0.9 & Frac &lt;= 1.0 ~ \"90-100\")) %&gt;% \n  mutate(\n    idade = case_when(Idade &gt;= 0 & Idade &lt;= 10 ~ \"&lt;= 10\",\n                      Idade &gt; 10 & Idade &lt;= 20 ~ \"10-20\",\n                      Idade &gt; 20 ~ \"&gt; 20\")) %&gt;%\n  # Calculating the average evapotranspiration for each cluster\n  group_by(Ano, Tipo, region, ff_area, idade) %&gt;% \n  summarise(\n    Evapo = mean(Evapo),\n    n_obs = n(),\n    .groups = \"drop\"\n  )\n\n# Criar o novo dataframe com as categorias desejadas\nall_lulc_evapo_stages &lt;- all_lulc_evapo %&gt;%\n  mutate(Tipo = case_when(Tipo == \"PF\" ~ \"PF\", \n                          Tipo == \"SF\" & idade == \"&lt;= 10\" ~ \"SF_early\", \n                          Tipo == \"SF\" & idade == \"10-20\" ~ \"SF_intermediate\", \n                          Tipo == \"SF\" & idade == \"&gt; 20\" ~ \"SF_advanced\",\n                          TRUE ~ NA_character_ )) %&gt;% \n  filter(!is.na(Tipo))  # Remove linhas que não se encaixam nas categorias definidas\n\n\nall_lulc_evapo_final &lt;- all_lulc_evapo_stages %&gt;% \n  mutate(type = case_when(Tipo == \"PF\" ~ 1,\n                          Tipo == \"SF_early\" ~ 2, \n                          Tipo == \"SF_intermediate\" ~ 3,\n                          Tipo == \"SF_advanced\" ~ 4))\n\n# Verificar o resultado\n#head(all_lulc_evapo_final)\n\nmax_min_evapo = all_lulc_evapo_final %&gt;%\n  group_by(Tipo, region, ff_area, idade) %&gt;%\n  summarise(\n    max_evapo = max(Evapo),\n    median_evapo = median(Evapo),\n    min_evapo = min(Evapo)\n  )\n\n# Export data min and max\nwrite_xlsx(max_min_evapo, \"data_group/plan_max_and_min_group_evapo.xlsx\")\n\n# Export data grouped\nwrite_xlsx(all_lulc_evapo_final, \"data_group/plan_data_group_evapo.xlsx\")\n\n#rm(all_lulc_50_final)\n\ngc()\n\n\n\nTestes normalidade, homocedasticidade e independência\n\nall_pf_sf_evapo = read_xlsx(\"data_group/plan_data_group_evapo.xlsx\")\n\n# ---- NORMALIDADE ----\n\n# Realizar o teste de normalidade Shapiro-Wilk \nshapiro_test_results_evapo &lt;- all_pf_sf_evapo %&gt;%\n  group_by(Tipo,region, ff_area) %&gt;%\n  summarise(\n    p_value = shapiro.test(Evapo)$p.value\n  ) %&gt;%\n  ungroup()\n\n# Visualizar os resultados do teste Shapiro-Wilk\nprint(shapiro_test_results_evapo)\n\n# A tibble: 120 × 4\n   Tipo  region ff_area p_value\n   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;\n 1 PF    CBA    1-10     0.0391\n 2 PF    CBA    10-20    0.142 \n 3 PF    CBA    20-30    0.346 \n 4 PF    CBA    30-40    0.477 \n 5 PF    CBA    40-50    0.600 \n 6 PF    CBA    50-60    0.620 \n 7 PF    CBA    60-70    0.580 \n 8 PF    CBA    70-80    0.520 \n 9 PF    CBA    80-90    0.512 \n10 PF    CBA    90-100   0.687 \n# ℹ 110 more rows\n\n# Exportar os resultados do teste de normalidade\nwrite_xlsx(shapiro_test_results_evapo, \"data_group/shapiro_test_evapo_results.xlsx\")\n\n\n# ---- HOMOCEDASTICIDADE ----\n\n# Garantindo que 'Tipo' seja tratado como fator\nall_pf_sf_evapo$Tipo &lt;- as.factor(all_pf_sf_evapo$Tipo)\n\n# Lista para armazenar os resultados\nresults_list_evapo &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_evapo$region)) {\n  for (ff_area in unique(all_pf_sf_evapo$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_evapo %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de homocedasticidade Levene\n        levene_test_evapo &lt;- leveneTest(Evapo ~ Tipo, data = data_subset)\n        p_value &lt;- levene_test_evapo$`Pr(&gt;F)`[1]  # Extraindo o valor p\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      results_list_evapo[[length(results_list_evapo) + 1]] &lt;- data.frame(region = region, \n                                                             ff_area = ff_area, \n                                                             p_value = p_value)\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nlevene_test_results_evapo &lt;- do.call(rbind, results_list_evapo)\n\n# Exibir os resultados\nprint(levene_test_results_evapo)\n\n   region ff_area     p_value\n1     CBA    1-10 0.027280895\n2     CBA   10-20 0.025490815\n3     CBA   20-30 0.013992947\n4     CBA   30-40 0.021272158\n5     CBA   40-50 0.047614392\n6     CBA   50-60 0.056851408\n7     CBA   60-70 0.084564405\n8     CBA   70-80 0.079499258\n9     CBA   80-90 0.079682558\n10    CBA  90-100 0.216580324\n11    EBA    1-10 0.749110155\n12    EBA   10-20 0.855139394\n13    EBA   20-30 0.833991746\n14    EBA   30-40 0.578915819\n15    EBA   40-50 0.410490304\n16    EBA   50-60 0.088108876\n17    EBA   60-70 0.011822389\n18    EBA   70-80 0.003527165\n19    EBA   80-90 0.001969657\n20    EBA  90-100 0.001267824\n21    SBA    1-10 0.611671959\n22    SBA   10-20 0.515866928\n23    SBA   20-30 0.322076300\n24    SBA   30-40 0.274488867\n25    SBA   40-50 0.292607858\n26    SBA   50-60 0.204998550\n27    SBA   60-70 0.109533413\n28    SBA   70-80 0.045146106\n29    SBA   80-90 0.016340569\n30    SBA  90-100 0.056639754\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(levene_test_results_evapo, \"data_group/levene_test_evapo_results.xlsx\")\n\n\n# ---- INDEPENDÊNCIA ----\n\n\n# Lista para armazenar os resultados\nkendall_results_list_evapo &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_evapo$region)) {\n  for (ff_area in unique(all_pf_sf_evapo$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_evapo %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de correlação de Kendall entre 'Evapo' e 'Tipo'\n        cor_test &lt;- cor.test(as.numeric(data_subset$Evapo), as.numeric(data_subset$Tipo), method = \"kendall\")\n        p_value &lt;- cor_test$p.value  # Extraindo o valor p\n        cor_value &lt;- cor_test$estimate  # Extraindo o valor da correlação\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n      cor_value &lt;- NA\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      kendall_results_list_evapo[[length(kendall_results_list_evapo) + 1]] &lt;- data.frame(\n        region = region, \n        ff_area = ff_area, \n        cor_value = cor_value,\n        p_value = p_value\n      )\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nkendall_test_results_evapo &lt;- do.call(rbind, kendall_results_list_evapo)\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(kendall_test_results_evapo, \"data_group/kendall_test_evapo_results.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1866247 99.7    2951642 157.7  2951642 157.7\nVcells 3381275 25.8    8388608  64.0  5680635  43.4\n\n\n\n\nTeste t entre os tipos de cobertura - PF e SF\n\n# --------------------------------------------------------------------\n# OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - RODAR O TESTE NÃO PARAMÉTRICO\n# --------------------------------------------------------------------\n\n# Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame vazio para armazenar os resultados\nsignificance_results_t_evapo &lt;- data.frame(Intervalo = area_ranges)  # Adiciona a coluna de intervalos\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados para PF e SF no intervalo atual e região atual\n    pv_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste t para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, t.test(pv_data$Evapo, sv_early_data$Evapo, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, t.test(pv_data$Evapo, sv_intermediate_data$Evapo, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, t.test(pv_data$Evapo, sv_advanced_data$Evapo, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_t_evapo[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_t_evapo[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_t_evapo[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_t_evapo, \"data_group/significance_results_evapo_testt.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1865980 99.7    2951642 157.7  2951642 157.7\nVcells 3381411 25.8    8388608  64.0  5680635  43.4\n\n\n\n\nTeste Wilcox entre os tipos de cobertura - PF e SF\n\n# Leitura da planilha com os dados\nall_pf_sf_evapo = read_xlsx(\"data_group/plan_data_group_evapo.xlsx\")\n\n# Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame para armazenar os resultados\nsignificance_results_w_evapo &lt;- data.frame(Intervalo = area_ranges)\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados\n    pv_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_evapo %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste de Wilcoxon para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, wilcox.test(pv_data$Evapo, sv_early_data$Evapo, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, wilcox.test(pv_data$Evapo, sv_intermediate_data$Evapo, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, wilcox.test(pv_data$Evapo, sv_advanced_data$Evapo, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_w_evapo[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_w_evapo[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_w_evapo[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_w_evapo, \"data_group/significance_results_evapo_Wilcox_test.xlsx\")\n\ngc()\n\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1865988 99.7    2951642 157.7  2951642 157.7\nVcells 3383142 25.9    8388608  64.0  5680635  43.4\n\n\n\nPlot com significance\n\n# Criar um dataframe \"long\" de significância, onde cada linha tem uma região e o intervalo associado\nlong_significance_results_w_evapo &lt;- significance_results_w_evapo %&gt;%\n  gather(key = \"Comparison\", value = \"P_value\", -Intervalo) %&gt;%\n  separate(Comparison, into = c(\"region\", \"Comparison_Type\"), sep = \"_PF_vs_\")\n\n# Mesclar esses resultados com os dados originais\nall_pf_sf_evapo &lt;- all_pf_sf_evapo %&gt;%\n  left_join(long_significance_results_w_evapo, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\"))\n\n# Adicionando uma coluna indicando se o intervalo foi significativo\nall_pf_sf_evapo$Significant &lt;- ifelse(all_pf_sf_evapo$P_value &lt; 0.05, \"*\", \"\")\n\n# Reordenar os níveis de 'Tipo'\nall_pf_sf_evapo &lt;- all_pf_sf_evapo %&gt;%\n  mutate(Tipo = factor(Tipo, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n# Função para calcular o valor máximo do bigode\nget_whisker_max &lt;- function(x) {\n  stats &lt;- boxplot.stats(x)$stats\n  return(stats[5]) # stats[5] normalmente corresponde ao valor máximo do bigode\n}\n\n\n# Calcular a posição do asterisco\nsignificance_positions &lt;- all_pf_sf_evapo %&gt;%\n  group_by(ff_area, region, Tipo) %&gt;%\n  summarise(max_whisker = get_whisker_max(Evapo), .groups = \"drop\") %&gt;%\n  left_join(long_significance_results_w_evapo, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\")) %&gt;%\n  filter(P_value &lt; 0.05) %&gt;%\n  mutate(\n    asterisk_y = max_whisker + 10, # Ajuste para posicionar acima do bigode\n    x_adjust = case_when(\n      Tipo == \"SF_early\" ~ -0.1,\n      Tipo == \"SF_intermediate\" ~ 0.1,\n      Tipo == \"SF_advanced\" ~ 0.3\n    ),\n    x_pos = as.numeric(factor(ff_area, levels = area_ranges)) + x_adjust\n  )\n\n#head(significance_positions)\n\n# Plot com asteriscos de significância\np_ast_evapo_w &lt;- all_pf_sf_evapo %&gt;% \n  ggplot(aes(x=ff_area, y=Evapo, fill=Tipo)) +\n  geom_boxplot(outlier.alpha = 0.4) +\n  facet_grid(~region) + \n  ggthemes::theme_few() +\n  theme(\n    legend.position = c(0.77, 0.84),\n    legend.background = element_rect(fill=\"transparent\"),\n    #legend.position = \"top\",\n    text = element_text(size = 12, face = \"bold\",family = \"serif\"), \n    #text = element_text(size = 7, face = \"bold\",family = \"serif\"), \n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n    #axis.text = element_text(size = 6, face = \"plain\", family = \"serif\", color = \"black\"),\n    axis.text.x = element_blank(),\n    #axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n    legend.text = element_text(size = 9),\n    #legend.text = element_text(size = 7),\n    panel.spacing.x = unit(1, \"lines\"),  \n    panel.spacing.y = unit(1, \"lines\"),\n    axis.title = element_text(size = 14, margin = margin(r = 20)),\n    strip.text = element_blank()) +\n  scale_fill_manual(values = c(\"#02401B\", \"lightgreen\", \"green1\", \"green4\"), name = NULL, labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  #geom_vline(xintercept = c(1,2,3,4,5,6,7,8,9,10), linetype = \"dashed\", color = \"lightgray\", size = 0.5) +\n  #labels = c(\"Primary Vegetation           \", \"Secondary Vegetation\"))+\n  labs(x = \"\",\n       y = \"Average annual accumulated \\n evapotranspiration (mm)\",\n       #y = expression(atop(\"Average annual accumulated\", paste(\"evapotranspiration (mm·\", yr^{-1}, \")\")))\n       ) +\n  # Adicionando os asteriscos\n  geom_text(data = significance_positions, \n            aes(x = x_pos, y = asterisk_y, label = \"*\"),\n            size = 3, color = \"red\")\n\np_ast_evapo_w\n\n\n\n\n\n\n\n# Salvando a figura\nggsave(\"fig/area_x_evapo_pf_sf_significant_asterisco_wilcoxon.png\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1931274 103.2    2951642 157.7  2951642 157.7\nVcells 3532055  27.0    8388608  64.0  5680635  43.4"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#tempertaure",
    "href": "code_climate_forest_regeneration.html#tempertaure",
    "title": "Packages",
    "section": "TEMPERTAURE",
    "text": "TEMPERTAURE\n\nAgrupamento\n\n# Lendo a planilha\n# all_lulc_50_final = fread(\"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv\")\n\n# all_lulc_50_fil &lt;- all_lulc_50_final %&gt;% \n#    filter(Tipo %in% c(\"SF\", \"PF\"))\n\n# Calculating the average evapotranspiration for each cluster\nall_lulc_temp = all_lulc_50_fil %&gt;% \n  summarise(\n    Temp = Temp,\n    Frac = frac_area,\n    Tipo = Tipo,\n    Ano = Ano,\n    region = Region,\n    Idade = Idade_SF\n  ) %&gt;%\n  mutate(\n    ff_area = case_when(Frac &gt;= 0.01 & Frac &lt;= 0.1 ~ \"1-10\",\n                        Frac &gt; 0.1 & Frac &lt;= 0.2 ~ \"10-20\",\n                        Frac &gt; 0.2 & Frac &lt;= 0.3 ~ \"20-30\",\n                        Frac &gt; 0.3 & Frac &lt;= 0.4 ~ \"30-40\",\n                        Frac &gt; 0.4 & Frac &lt;= 0.5 ~ \"40-50\",\n                        Frac &gt; 0.5 & Frac &lt;= 0.6 ~ \"50-60\",\n                        Frac &gt; 0.6 & Frac &lt;= 0.7 ~ \"60-70\",\n                        Frac &gt; 0.7 & Frac &lt;= 0.8 ~ \"70-80\",\n                        Frac &gt; 0.8 & Frac &lt;= 0.9 ~ \"80-90\",\n                        Frac &gt; 0.9 & Frac &lt;= 1.0 ~ \"90-100\")) %&gt;% \n  mutate(\n    idade = case_when(Idade &gt;= 0 & Idade &lt;= 10 ~ \"&lt;= 10\",\n                      Idade &gt; 10 & Idade &lt;= 20 ~ \"10-20\",\n                      Idade &gt; 20 ~ \"&gt; 20\")) %&gt;%\n  # Calculating the average evapotranspiration for each cluster\n  group_by(Ano, Tipo, region, ff_area, idade) %&gt;% \n  summarise(\n    Temp = mean(Temp),\n    n_obs = n(),\n    .groups = \"drop\"\n  )\n\n# Criar o novo dataframe com as categorias desejadas\nall_lulc_temp_stages &lt;- all_lulc_temp %&gt;%\n  mutate(Tipo = case_when(Tipo == \"PF\" ~ \"PF\",\n                          Tipo == \"SF\" & idade == \"&lt;= 10\" ~ \"SF_early\",\n                          Tipo == \"SF\" & idade == \"10-20\" ~ \"SF_intermediate\",\n                          Tipo == \"SF\" & idade == \"&gt; 20\" ~ \"SF_advanced\",\n                          TRUE ~ NA_character_ )) %&gt;% \n\n  filter(!is.na(Tipo))  # Remove linhas que não se encaixam nas categorias definidas\n\n\nall_lulc_temp_final &lt;- all_lulc_temp_stages %&gt;% \n  mutate(type = case_when(Tipo == \"PF\" ~ 1,\n                          Tipo == \"SF_early\" ~ 2, \n                          Tipo == \"SF_intermediate\" ~ 3,\n                          Tipo == \"SF_advanced\" ~ 4))\n\n# Verificar o resultado\n#head(all_lulc_temp_final)\n\nmax_min_temp = all_lulc_temp_final %&gt;%\n  group_by(Tipo, region, ff_area, idade) %&gt;%\n  summarise(\n    max_temp = max(Temp),\n    median_temp = median(Temp),\n    min_temp = min(Temp)\n  )\n\n# Export data min and max\nwrite_xlsx(max_min_temp, \"data_group/plan_max_and_min_group_temp.xlsx\")\n\n# Export data grouped\nwrite_xlsx(all_lulc_temp_final, \"data_group/plan_data_group_temp.xlsx\")\n\n#rm(all_lulc_50_final)\n\ngc()\n\n\n\nTestes normalidade, homocedasticidade e independência\n\nall_pf_sf_temp = read_xlsx(\"data_group/plan_data_group_temp.xlsx\")\n\n# ---- NORMALIDADE ----\n\n# Realizar o teste de normalidade Shapiro-Wilk \nshapiro_test_results_temp &lt;- all_pf_sf_temp %&gt;%\n  group_by(Tipo,region, ff_area) %&gt;%\n  summarise(\n    p_value = shapiro.test(Temp)$p.value\n  ) %&gt;%\n  ungroup()\n\n# Visualizar os resultados do teste Shapiro-Wilk\nprint(shapiro_test_results_temp)\n\n# A tibble: 120 × 4\n   Tipo  region ff_area p_value\n   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;\n 1 PF    CBA    1-10      0.193\n 2 PF    CBA    10-20     0.138\n 3 PF    CBA    20-30     0.148\n 4 PF    CBA    30-40     0.178\n 5 PF    CBA    40-50     0.202\n 6 PF    CBA    50-60     0.218\n 7 PF    CBA    60-70     0.236\n 8 PF    CBA    70-80     0.241\n 9 PF    CBA    80-90     0.244\n10 PF    CBA    90-100    0.298\n# ℹ 110 more rows\n\n# Exportar os resultados do teste de normalidade\nwrite_xlsx(shapiro_test_results_temp, \"data_group/shapiro_test_temp_results.xlsx\")\n\n\n# ---- HOMOCEDASTICIDADE ----\n\n# Garantindo que 'Tipo' seja tratado como fator\nall_pf_sf_temp$Tipo &lt;- as.factor(all_pf_sf_temp$Tipo)\n\n# Lista para armazenar os resultados\nresults_list_temp &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_temp$region)) {\n  for (ff_area in unique(all_pf_sf_temp$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_temp %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de homocedasticidade Levene\n        levene_test_temp &lt;- leveneTest(Temp ~ Tipo, data = data_subset)\n        p_value &lt;- levene_test_temp$`Pr(&gt;F)`[1]  # Extraindo o valor p\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      results_list_temp[[length(results_list_temp) + 1]] &lt;- data.frame(region = region, \n                                                             ff_area = ff_area, \n                                                             p_value = p_value)\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nlevene_test_results_temp &lt;- do.call(rbind, results_list_temp)\n\n# Exibir os resultados\nprint(levene_test_results_temp)\n\n   region ff_area    p_value\n1     CBA    1-10 0.83197458\n2     CBA   10-20 0.80000235\n3     CBA   20-30 0.81306910\n4     CBA   30-40 0.87609097\n5     CBA   40-50 0.82129134\n6     CBA   50-60 0.84953382\n7     CBA   60-70 0.90458652\n8     CBA   70-80 0.28428853\n9     CBA   80-90 0.33982704\n10    CBA  90-100 0.02566782\n11    EBA    1-10 0.27483771\n12    EBA   10-20 0.36583578\n13    EBA   20-30 0.41482398\n14    EBA   30-40 0.54406349\n15    EBA   40-50 0.60625467\n16    EBA   50-60 0.57322143\n17    EBA   60-70 0.58940324\n18    EBA   70-80 0.47304822\n19    EBA   80-90 0.48166457\n20    EBA  90-100 0.25405365\n21    SBA    1-10 0.43587153\n22    SBA   10-20 0.48503728\n23    SBA   20-30 0.61530533\n24    SBA   30-40 0.67667190\n25    SBA   40-50 0.99048509\n26    SBA   50-60 0.85842660\n27    SBA   60-70 0.33119598\n28    SBA   70-80 0.59203270\n29    SBA   80-90 0.95642377\n30    SBA  90-100 0.76793381\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(levene_test_results_temp, \"data_group/levene_test_temp_results.xlsx\")\n\n\n# ---- INDEPENDÊNCIA ----\n\n\n# Lista para armazenar os resultados\nkendall_results_list_temp &lt;- list()\n\n# Loop por cada combinação de 'region' e 'ff_area'\nfor (region in unique(all_pf_sf_temp$region)) {\n  for (ff_area in unique(all_pf_sf_temp$ff_area)) {\n    \n    # Filtrar os dados para a combinação atual\n    data_subset &lt;- all_pf_sf_temp %&gt;%\n      filter(region == !!region, ff_area == !!ff_area)\n    \n    # Verificar se há dados suficientes para realizar o teste (precisa de pelo menos 2 tipos)\n    if (nrow(data_subset) &gt; 1 && length(unique(data_subset$Tipo)) &gt; 1) {\n      try({\n        # Realizar o teste de correlação de Kendall entre 'Temp' e 'Tipo'\n        cor_test &lt;- cor.test(as.numeric(data_subset$Temp), as.numeric(data_subset$Tipo), method = \"kendall\")\n        p_value &lt;- cor_test$p.value  # Extraindo o valor p\n        cor_value &lt;- cor_test$estimate  # Extraindo o valor da correlação\n      }, silent = TRUE)\n    } else {\n      p_value &lt;- NA  # Insere NA se não houver dados suficientes\n      cor_value &lt;- NA\n    }\n    \n    # Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo\n    if (!is.null(p_value)) {\n      kendall_results_list_temp[[length(kendall_results_list_temp) + 1]] &lt;- data.frame(\n        region = region, \n        ff_area = ff_area, \n        cor_value = cor_value,\n        p_value = p_value\n      )\n    }\n  }\n}\n\n# Combinar todos os resultados em um DataFrame\nkendall_test_results_temp &lt;- do.call(rbind, kendall_results_list_temp)\n\n# Exportar os resultados para um arquivo Excel\nwrite_xlsx(kendall_test_results_temp, \"data_group/kendall_test_temp_results.xlsx\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1885046 100.7    2951642 157.7  2951642 157.7\nVcells 3437060  26.3    8388608  64.0  5680635  43.4\n\n\n\n\nTeste t entre os tipos de cobertura - PF e SF\n\n# --------------------------------------------------------------------\n# OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - RODAR O TESTE NÃO PARAMÉTRICO\n# --------------------------------------------------------------------\n\n# Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame vazio para armazenar os resultados\nsignificance_results_t_temp &lt;- data.frame(Intervalo = area_ranges)  # Adiciona a coluna de intervalos\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados\n    pv_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste t para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, t.test(pv_data$Temp, sv_early_data$Temp, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, t.test(pv_data$Temp, sv_intermediate_data$Temp, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, t.test(pv_data$Temp, sv_advanced_data$Temp, var.equal = TRUE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_t_temp[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_t_temp[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_t_temp[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_t_temp, \"data_group/significance_results_temp_testt.xlsx\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1884779 100.7    2951642 157.7  2951642 157.7\nVcells 3437196  26.3    8388608  64.0  5680635  43.4\n\n\n\n\nTeste Wilcox entre os tipos de cobertura - PF e SF\n\n# Leitura da planilha com os dados\nall_pf_sf_temp = read_xlsx(\"data_group/plan_data_group_temp.xlsx\")\n\n# Lista dos intervalos de área\narea_ranges &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \n                 \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\n# Lista das regiões\nregions &lt;- c(\"CBA\", \"EBA\", \"SBA\")\n\n# Criando um DataFrame vazio para armazenar os resultados\nsignificance_results_w_temp &lt;- data.frame(Intervalo = area_ranges)  # Adiciona a coluna de intervalos\n\n# Loop por cada região\nfor (region in regions) {\n  \n  p_values_pf_sf_early &lt;- c()\n  p_values_pf_sf_intermediate &lt;- c()\n  p_values_pf_sf_advanced &lt;- c()\n  \n  # Loop por cada intervalo de área\n  for (range in area_ranges) {\n    \n    # Filtrando os dados\n    pv_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"PF\")\n    sv_early_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_early\")\n    sv_intermediate_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_intermediate\")\n    sv_advanced_data &lt;- all_pf_sf_temp %&gt;% filter(region == !!region, ff_area == range, Tipo == \"SF_advanced\")\n    \n    # Teste de Wilcoxon para cada comparação com PF\n    if (nrow(pv_data) &gt; 1 && nrow(sv_early_data) &gt; 1) {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, wilcox.test(pv_data$Temp, sv_early_data$Temp, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_early &lt;- c(p_values_pf_sf_early, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_intermediate_data) &gt; 1) {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, wilcox.test(pv_data$Temp, sv_intermediate_data$Temp, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_intermediate &lt;- c(p_values_pf_sf_intermediate, NA)\n    }\n    \n    if (nrow(pv_data) &gt; 1 && nrow(sv_advanced_data) &gt; 1) {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, wilcox.test(pv_data$Temp, sv_advanced_data$Temp, paired = FALSE)$p.value)\n    } else {\n      p_values_pf_sf_advanced &lt;- c(p_values_pf_sf_advanced, NA)\n    }\n  }\n  \n  # Adicionando ao DataFrame\n  significance_results_w_temp[[paste0(region, \"_PF_vs_SF_early\")]] &lt;- p_values_pf_sf_early\n  significance_results_w_temp[[paste0(region, \"_PF_vs_SF_intermediate\")]] &lt;- p_values_pf_sf_intermediate\n  significance_results_w_temp[[paste0(region, \"_PF_vs_SF_advanced\")]] &lt;- p_values_pf_sf_advanced\n}\n\n# Salvando os resultados em um arquivo\nwrite_xlsx(significance_results_w_temp, \"data_group/significance_results_temp_Wilcox_test.xlsx\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1884787 100.7    2951642 157.7  2951642 157.7\nVcells 3438924  26.3    8388608  64.0  5680635  43.4\n\n\n\nPlot com significance\n\n# Criar um dataframe \"long\" de significância, onde cada linha tem uma região e o intervalo associado\nlong_significance_results_w_temp &lt;- significance_results_w_temp %&gt;%\n  gather(key = \"Comparison\", value = \"P_value\", -Intervalo) %&gt;%\n  separate(Comparison, into = c(\"region\", \"Comparison_Type\"), sep = \"_PF_vs_\")\n\n# Mesclar esses resultados com os dados originais\nall_pf_sf_temp &lt;- all_pf_sf_temp %&gt;%\n  left_join(long_significance_results_w_temp, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\"))\n\n# Adicionando uma coluna indicando se o intervalo foi significativo\nall_pf_sf_temp$Significant &lt;- ifelse(all_pf_sf_temp$P_value &lt; 0.05, \"*\", \"\")\n\n# Reordenar os níveis de 'Tipo'\nall_pf_sf_temp &lt;- all_pf_sf_temp %&gt;%\n  mutate(Tipo = factor(Tipo, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n# Função para calcular o valor máximo do bigode\nget_whisker_max &lt;- function(x) {\n  stats &lt;- boxplot.stats(x)$stats\n  return(stats[5]) # stats[5] normalmente corresponde ao valor máximo do bigode\n}\n\n\n# Calcular a posição do asterisco\nsignificance_positions &lt;- all_pf_sf_temp %&gt;%\n  group_by(ff_area, region, Tipo) %&gt;%\n  summarise(max_whisker = get_whisker_max(Temp), .groups = \"drop\") %&gt;%\n  left_join(long_significance_results_w_temp, \n            by = c(\"ff_area\" = \"Intervalo\", \"region\" = \"region\", \"Tipo\" = \"Comparison_Type\")) %&gt;%\n  filter(P_value &lt; 0.05) %&gt;%\n  mutate(\n    asterisk_y = max_whisker + 0.1, # Ajuste para posicionar acima do bigode\n    x_adjust = case_when(\n      Tipo == \"SF_early\" ~ -0.1,\n      Tipo == \"SF_intermediate\" ~ 0.1,\n      Tipo == \"SF_advanced\" ~ 0.3\n    ),\n    x_pos = as.numeric(factor(ff_area, levels = area_ranges)) + x_adjust\n  )\n\n#head(significance_positions)\n\n\n# Plot com asteriscos de significância\np_ast_temp_w &lt;-all_pf_sf_temp %&gt;% \n  ggplot(aes(x=ff_area, y=Temp, fill=Tipo)) +\n  geom_boxplot(outlier.alpha = 0.4) +\n  facet_grid(~region) + \n  ggthemes::theme_few() +\n  theme(\n    legend.position = c(0.91, 0.84),\n    legend.background = element_rect(fill=\"transparent\"),\n    text = element_text(size = 12, face = \"bold\",family = \"serif\"), \n    #text = element_text(size = 7, face = \"bold\",family = \"serif\"), \n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n    #axis.text.y = element_text(size = 12, face = \"plain\", family = \"serif\", color = \"black\"),\n    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n    legend.text = element_text(size = 9),\n    #legend.text = element_text(size = 7),\n    panel.spacing.x = unit(1, \"lines\"),  \n    panel.spacing.y = unit(1, \"lines\"),\n    axis.title = element_text(size = 14, margin = margin(r = 20)),\n    strip.text = element_blank()) +\n  scale_fill_manual(values = c(\"#7F3B08\", \"#FEE0B6\", \"#FDB863\", \"#E08214\"), name = NULL, labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = 23:27, limits = c(NA, 27), expand = expansion(mult = c(0.01, 0.05)), \n  labels = label_number(width = 6, zero.print = TRUE)) + \n   labs(x = \"Fractional cover (%)\",\n        y = \"Average annual mean \\n temperature (°C)\",\n        #y = expression(atop(\"Average annual mean\", paste(\"temperature (\", degree, \"C·yr\"^-1, \")\")))\n        ) +\n  # Adicionando os asteriscos\n  geom_text(data = significance_positions, \n            aes(x = x_pos, y = asterisk_y, label = \"*\"),\n            size = 3, color = \"red\")\n\np_ast_temp_w\n\n\n\n\n\n\n\n# Salvando a figura\nggsave(\"fig/area_x_temp_pf_sf_significant_asterisco_wilcoxon.png\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 1949990 104.2    2951642 157.7  2951642 157.7\nVcells 3587917  27.4    8388608  64.0  5680635  43.4"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#painel-all-variables---observation",
    "href": "code_climate_forest_regeneration.html#painel-all-variables---observation",
    "title": "Packages",
    "section": "Painel all variables - observation",
    "text": "Painel all variables - observation\n\n# Ajuste das margens\np_ret_prec_w &lt;- p_ast_prec_w + \n  scale_x_discrete(expand = c(0.05, 0.05)) + \n  theme(plot.margin = margin(t = 10, r = 10, b = 5, l = 20))  # Ajuste de margens\n\np_ret_evapo_w &lt;- p_ast_evapo_w + \n  scale_x_discrete(expand = c(0.05, 0.05)) + \n  theme(plot.margin = margin(t = 5, r = 10, b = 5, l = 20))   # Ajuste de margens\n\np_ret_temp_w &lt;- p_ast_temp_w + \n  scale_x_discrete(expand = c(0.05, 0.05)) + \n  theme(plot.margin = margin(t = 5, r = 10, b = 10, l = 20))  # Ajuste de margens\n\n\n# Criar painel com espaçamento ajustado\npainel_obs &lt;- ggarrange(\n  p_ret_prec_w, p_ret_evapo_w, p_ret_temp_w,\n  ncol = 1, nrow = 3,\n  labels = c(\"A\", \"B\", \"C\"),  # Letras dos subplots\n  font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n  align = \"v\",                # Alinhamento vertical\n  heights = c(1, 1, 1)        # Força os plots a terem alturas iguais\n)\n\n# Salvar figura final\nggsave(\"fig/painels/painel_fraction_forest_x_prec.png\", \n       plot = painel_obs, dpi = 600, width = 10, height = 12, bg = \"white\")\n\nggsave(\"fig/painels/painel_fraction_forest_x_prec.pdf\", \n       plot = painel_obs, width = 10, height = 12, bg = \"white\")"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#precipitation-1",
    "href": "code_climate_forest_regeneration.html#precipitation-1",
    "title": "Packages",
    "section": "PRECIPITATION",
    "text": "PRECIPITATION\n\nModel choice\n\n# Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área\nall_pf_sf_prec_model = read_xlsx(\"data_group/plan_data_group_prec.xlsx\")\n\n# Definindo a ordem correta das categorias\nord_ff   &lt;- c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")\nlev_tipo &lt;- c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")\n\n# Recodifica como fatores na ordem correta\nrecode_fac &lt;- function(d){\n  d %&gt;%\n    mutate(\n      ff_area = factor(ff_area, levels = ord_ff, ordered = TRUE),\n      Tipo    = factor(Tipo,    levels = lev_tipo)\n    )\n}\n\n# Separa por região e aplica a recodificação\nmodel_cba_prec &lt;- all_pf_sf_prec_model %&gt;% filter(region == \"CBA\") %&gt;% recode_fac()\nmodel_eba_prec &lt;- all_pf_sf_prec_model %&gt;% filter(region == \"EBA\") %&gt;% recode_fac()\nmodel_sba_prec &lt;- all_pf_sf_prec_model %&gt;% filter(region == \"SBA\") %&gt;% recode_fac()\n\n# Cria um identificador para cada estrato\nadd_estrato &lt;- function(d){\n  d$estrato_id &lt;- interaction(d$region, d$ff_area, d$Tipo, drop = TRUE)\n  d\n}\n\nmodel_cba_prec &lt;- add_estrato(model_cba_prec)\nmodel_eba_prec &lt;- add_estrato(model_eba_prec)\nmodel_sba_prec &lt;- add_estrato(model_sba_prec)\n\n\nObservações - Tipo x Fraction cover\n\n# labeller \"SI\" compatível com várias versões de {scales}\nsi_labeller &lt;- function(accuracy = 0.1) {\n  if (\"cut_si\" %in% getNamespaceExports(\"scales\")) {\n    label_number(accuracy = accuracy, scale_cut = cut_si(\"\"))\n  } else if (\"cut_short_scale\" %in% getNamespaceExports(\"scales\")) {\n    label_number(accuracy = accuracy, scale_cut = cut_short_scale())\n  } else {\n    label_comma(accuracy = accuracy)\n  }\n}\n\nplot_nobs_heat &lt;- function(dat, region_name,\n                           agg = c(\"sum\"),       \n                           use_si_labels = TRUE,\n                           text_size = 2.5,\n                           family = \"serif\",\n                           fill_limits = NULL,   \n                           fill_breaks = NULL) {\n\n  agg &lt;- match.arg(agg)\n\n  dat_reg &lt;- dat %&gt;%\n    dplyr::filter(region == region_name) %&gt;%\n    dplyr::group_by(region, ff_area, Tipo) %&gt;%\n    dplyr::summarise(\n      n_obs = switch(agg,\n                     sum    = sum(n_obs, na.rm = TRUE),\n                     mean   = mean(n_obs, na.rm = TRUE),\n                     median = median(n_obs, na.rm = TRUE)),\n      .groups = \"drop\"\n    ) %&gt;%\n    dplyr::mutate(\n      logn   = log10(pmax(n_obs, 1L)),\n      n_lab  = if (use_si_labels) si_labeller(accuracy = 0.1)(n_obs) else scales::comma(n_obs),\n      txt_col = ifelse(logn &gt;= median(logn, na.rm = TRUE), \"black\", \"white\")\n    )\n\n  ggplot(dat_reg, aes(ff_area, Tipo, fill = logn)) +\n    geom_tile(color = \"white\") +\n    geom_text(aes(label = n_lab, color = txt_col),\n              size = text_size, family = family, fontface = \"bold\") +\n    scale_color_identity(guide = \"none\") +\n    scale_fill_viridis_c(\n      name   = expression(log[10](n[obs])),\n      limits = fill_limits,               \n      breaks = fill_breaks,               \n      oob = scales::squish                \n    ) +\n    scale_y_discrete(\n    labels = c(\n      \"PF\"             = \"PF\",\n      \"SF_early\"       = \"SF early\",\n      \"SF_intermediate\"= \"SF intermediate\",\n      \"SF_advanced\"    = \"SF advanced\"\n    )\n  ) +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 10, face = \"bold\", family = \"serif\"),\n      axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1)\n    ) +\n    labs(\n      title = paste(region_name, \"\"),\n      x = \"Fractional cover (%)\",\n      y = \"\"\n    )\n}\n\n# Mesma legenda para todos\ncommon_limits &lt;- c(2, 8)\ncommon_breaks &lt;- seq(2, 8, by = 2)\n\np_nobs_cba &lt;- plot_nobs_heat(model_cba_prec, \"CBA\", agg = \"sum\",\n                             fill_limits = common_limits, fill_breaks = common_breaks)\np_nobs_eba &lt;- plot_nobs_heat(model_eba_prec, \"EBA\", agg = \"sum\",\n                             fill_limits = common_limits, fill_breaks = common_breaks)\np_nobs_sba &lt;- plot_nobs_heat(model_sba_prec, \"SBA\", agg = \"sum\",\n                             fill_limits = common_limits, fill_breaks = common_breaks)\n\n# Plot\n\n# --- CBA: esconder eixo-x mas manter o espaço; centralizar título; margens iguais\np_nobs_cba &lt;- p_nobs_cba +\n  labs(x = \"Fractional cover (%)\") +                      \n  theme(\n    axis.title.x = element_text(colour = NA),            \n    axis.ticks.x = element_blank(),                       \n    plot.title   = element_text(hjust = 0.5),\n    plot.margin  = margin(1, 1, 1, 1)                    \n  )\n\n# --- EBA: idem ao CBA\np_nobs_eba &lt;- p_nobs_eba +\n  labs(x = \"Fractional cover (%)\") +\n  theme(\n    axis.title.x = element_text(colour = NA),\n    axis.ticks.x = element_blank(),\n    plot.title   = element_text(hjust = 0.5),\n    plot.margin  = margin(1, 1, 1, 1)\n  )\n\n# --- SBA: eixo-x visível; mesmas margens e título centralizado\np_nobs_sba &lt;- p_nobs_sba +\n  theme(\n    plot.title  = element_text(hjust = 0.5),\n    plot.margin = margin(1, 1, 1, 1)\n  )\n\n# Monta o painel com uma legenda comum\npainel_log &lt;- ggpubr::ggarrange(\n  p_nobs_cba, p_nobs_eba, p_nobs_sba,\n  ncol = 1, nrow = 3,\n  align = \"v\",\n  common.legend = TRUE, legend = \"right\"\n)\npainel_log\n\n\n\n\n\n\n\nggsave(\"fig/n_obs.png\", width = 8, height = 6, dpi = 400, bg = \"white\")\n\n\n\n\nFixed effect\n\n# CBA\nmodel_CBA_prec_w1 &lt;- lmer(Prec ~ ff_area*Tipo + (1|Ano),\n                          data = model_cba_prec)\n\n# EBA\nmodel_EBA_prec_w1 &lt;- lmer(Prec ~ ff_area*Tipo + (1|Ano),\n                          data = model_eba_prec)\n\n# SBA\nmodel_SBA_prec_w1 &lt;- lmer(Prec ~ ff_area*Tipo + (1|Ano),\n                          data = model_sba_prec)\n\n# Coeficientes fixos\nbroom.mixed::tidy(model_CBA_prec_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept) 2417.         42.6   56.8     20.4 5.62e-24\n 2 fixed  ff_area.L     43.2        16.5    2.61   702.  9.12e- 3\n 3 fixed  ff_area.Q    -52.3        16.5   -3.17   702.  1.61e- 3\n 4 fixed  ff_area.C     -0.422      16.5   -0.0256 702.  9.80e- 1\n 5 fixed  ff_area^4    -23.9        16.5   -1.45   702.  1.48e- 1\n 6 fixed  ff_area^5    -13.8        16.5   -0.834  702.  4.04e- 1\n 7 fixed  ff_area^6     -1.96       16.5   -0.119  702.  9.06e- 1\n 8 fixed  ff_area^7      1.05       16.5    0.0633 702.  9.50e- 1\n 9 fixed  ff_area^8     -2.42       16.5   -0.146  702.  8.84e- 1\n10 fixed  ff_area^9     -1.34       16.5   -0.0814 702.  9.35e- 1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_EBA_prec_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept)  2421.        41.6    58.2    20.5 3.16e-24\n 2 fixed  ff_area.L    -333.        16.7   -19.9   710.  2.03e-70\n 3 fixed  ff_area.Q      97.8       16.7     5.86  710.  7.25e- 9\n 4 fixed  ff_area.C     -17.9       16.7    -1.07  710.  2.84e- 1\n 5 fixed  ff_area^4     -83.5       16.7    -5.00  710.  7.40e- 7\n 6 fixed  ff_area^5     -40.1       16.7    -2.40  710.  1.66e- 2\n 7 fixed  ff_area^6      11.5       16.7     0.688 710.  4.91e- 1\n 8 fixed  ff_area^7      -5.47      16.7    -0.328 710.  7.43e- 1\n 9 fixed  ff_area^8     -12.2       16.7    -0.732 710.  4.64e- 1\n10 fixed  ff_area^9      -6.63      16.7    -0.397 710.  6.92e- 1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_SBA_prec_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept) 2105.         31.6   66.7     20.4 2.61e-25\n 2 fixed  ff_area.L     41.8        10.9    3.82   710.  1.44e- 4\n 3 fixed  ff_area.Q     60.2        10.9    5.50   710.  5.20e- 8\n 4 fixed  ff_area.C     37.6        10.9    3.44   710.  6.22e- 4\n 5 fixed  ff_area^4      9.42       10.9    0.861  710.  3.89e- 1\n 6 fixed  ff_area^5      9.75       10.9    0.891  710.  3.73e- 1\n 7 fixed  ff_area^6     11.1        10.9    1.02   710.  3.10e- 1\n 8 fixed  ff_area^7      6.35       10.9    0.580  710.  5.62e- 1\n 9 fixed  ff_area^8     -5.33       10.9   -0.488  710.  6.26e- 1\n10 fixed  ff_area^9      0.329      10.9    0.0301 710.  9.76e- 1\n# ℹ 30 more rows\n\n\n\nR-square for Linear Mixed Model (LMM)\n\n# ---- Helpers coerentes com o ajuste ----\nweighted_mean &lt;- function(y, w) sum(w*y)/sum(w)\nr2_w_sse &lt;- function(y, yhat, w) {\n  sst &lt;- sum(w * (y - weighted_mean(y, w))^2)\n  ssr &lt;- sum(w * (y - yhat)^2)\n  1 - ssr/sst\n}\n\n# R² ponderado \"marginal\" (fixos) e \"condicional\" (fixos + RE) \nr2_lmer_w &lt;- function(m, dat, resp = \"Prec\", type = c(\"marg\",\"cond\")) {\n  type &lt;- match.arg(type)\n  w &lt;- as.numeric(weights(m))           \n  y &lt;- dat[[resp]]\n  yhat &lt;- if (type == \"marg\") predict(m, re.form = ~0) else predict(m, re.form = NULL)\n  r2_w_sse(y, yhat, w)\n}\n\n# Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))\nr2_cba_prec &lt;- c(\n  R2_marg_w = r2_lmer_w(model_CBA_prec_w1, model_cba_prec, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_CBA_prec_w1, model_cba_prec, type=\"cond\")\n)\nr2_eba_prec &lt;- c(\n  R2_marg_w = r2_lmer_w(model_EBA_prec_w1, model_eba_prec, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_EBA_prec_w1, model_eba_prec, type=\"cond\")\n)\nr2_sba_prec &lt;- c(\n  R2_marg_w = r2_lmer_w(model_SBA_prec_w1, model_sba_prec, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_SBA_prec_w1, model_sba_prec, type=\"cond\")\n)\n\nr2_cba_prec; r2_eba_prec; r2_sba_prec\n\nR2_marg_w R2_cond_w \n0.1239456 0.8912121 \n\n\nR2_marg_w R2_cond_w \n0.4521194 0.9281785 \n\n\nR2_marg_w R2_cond_w \n0.1557173 0.9137644 \n\n# Exportar (opcional)\nr2_tbl &lt;- tibble::tibble(\n  region = c(\"CBA\",\"EBA\",\"SBA\"),\n  R2_marg_w = c(r2_cba_prec[\"R2_marg_w\"], r2_eba_prec[\"R2_marg_w\"], r2_sba_prec[\"R2_marg_w\"]),\n  R2_cond_w = c(r2_cba_prec[\"R2_cond_w\"], r2_eba_prec[\"R2_cond_w\"], r2_sba_prec[\"R2_cond_w\"])\n)\nwritexl::write_xlsx(r2_tbl, \"data_group/r2_weighted_prec.xlsx\")\n\n\n# Ajuste múltiplo BH para comparações por faixa.\n# specs = ~ Tipo | ff_area --&gt; Dentro de cada faixa de cobertura, PF e SF têm precipitação diferente?\nemm_CBA &lt;- emmeans(model_CBA_prec_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_CBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   134.10 23.4 702   5.739  &lt;.0001\n PF - SF_intermediate            111.33 23.4 702   4.765  &lt;.0001\n PF - SF_advanced                 73.75 26.2 702   2.814  0.0101\n SF_early - SF_intermediate      -22.77 23.4 702  -0.974  0.3302\n SF_early - SF_advanced          -60.35 26.2 702  -2.302  0.0324\n SF_intermediate - SF_advanced   -37.58 26.2 702  -1.434  0.1825\n\nff_area = 10-20:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   176.04 23.4 702   7.534  &lt;.0001\n PF - SF_intermediate            149.54 23.4 702   6.400  &lt;.0001\n PF - SF_advanced                119.21 26.2 702   4.548  &lt;.0001\n SF_early - SF_intermediate      -26.50 23.4 702  -1.134  0.2572\n SF_early - SF_advanced          -56.84 26.2 702  -2.168  0.0457\n SF_intermediate - SF_advanced   -30.34 26.2 702  -1.157  0.2572\n\nff_area = 20-30:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   198.48 23.4 702   8.494  &lt;.0001\n PF - SF_intermediate            168.06 23.4 702   7.193  &lt;.0001\n PF - SF_advanced                142.42 26.2 702   5.433  &lt;.0001\n SF_early - SF_intermediate      -30.42 23.4 702  -1.302  0.2321\n SF_early - SF_advanced          -56.06 26.2 702  -2.139  0.0492\n SF_intermediate - SF_advanced   -25.64 26.2 702  -0.978  0.3282\n\nff_area = 30-40:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   189.60 23.4 702   8.114  &lt;.0001\n PF - SF_intermediate            167.24 23.4 702   7.157  &lt;.0001\n PF - SF_advanced                146.63 26.2 702   5.594  &lt;.0001\n SF_early - SF_intermediate      -22.36 23.4 702  -0.957  0.4067\n SF_early - SF_advanced          -42.96 26.2 702  -1.639  0.1524\n SF_intermediate - SF_advanced   -20.60 26.2 702  -0.786  0.4321\n\nff_area = 40-50:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   206.26 23.4 702   8.827  &lt;.0001\n PF - SF_intermediate            161.73 23.4 702   6.922  &lt;.0001\n PF - SF_advanced                143.62 26.2 702   5.479  &lt;.0001\n SF_early - SF_intermediate      -44.52 23.4 702  -1.906  0.0685\n SF_early - SF_advanced          -62.64 26.2 702  -2.390  0.0257\n SF_intermediate - SF_advanced   -18.12 26.2 702  -0.691  0.4896\n\nff_area = 50-60:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   199.78 23.4 702   8.550  &lt;.0001\n PF - SF_intermediate            140.97 23.4 702   6.033  &lt;.0001\n PF - SF_advanced                115.35 26.2 702   4.401  &lt;.0001\n SF_early - SF_intermediate      -58.81 23.4 702  -2.517  0.0145\n SF_early - SF_advanced          -84.43 26.2 702  -3.221  0.0020\n SF_intermediate - SF_advanced   -25.62 26.2 702  -0.977  0.3287\n\nff_area = 60-70:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   203.35 23.4 702   8.703  &lt;.0001\n PF - SF_intermediate             99.62 23.4 702   4.263  &lt;.0001\n PF - SF_advanced                 97.42 26.2 702   3.717  0.0003\n SF_early - SF_intermediate     -103.73 23.4 702  -4.439  &lt;.0001\n SF_early - SF_advanced         -105.93 26.2 702  -4.041  0.0001\n SF_intermediate - SF_advanced    -2.19 26.2 702  -0.084  0.9333\n\nff_area = 70-80:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   217.22 23.4 702   9.297  &lt;.0001\n PF - SF_intermediate            137.88 23.4 702   5.901  &lt;.0001\n PF - SF_advanced                 81.09 26.2 702   3.094  0.0025\n SF_early - SF_intermediate      -79.34 23.4 702  -3.396  0.0011\n SF_early - SF_advanced         -136.13 26.2 702  -5.194  &lt;.0001\n SF_intermediate - SF_advanced   -56.79 26.2 702  -2.167  0.0306\n\nff_area = 80-90:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   237.66 24.0 702   9.907  &lt;.0001\n PF - SF_intermediate            110.33 23.4 702   4.722  &lt;.0001\n PF - SF_advanced                 98.11 26.2 702   3.743  0.0002\n SF_early - SF_intermediate     -127.32 24.0 702  -5.308  &lt;.0001\n SF_early - SF_advanced         -139.55 26.8 702  -5.210  &lt;.0001\n SF_intermediate - SF_advanced   -12.22 26.2 702  -0.466  0.6411\n\nff_area = 90-100:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   139.54 25.7 702   5.439  &lt;.0001\n PF - SF_intermediate             40.61 23.4 702   1.738  0.0992\n PF - SF_advanced                -35.64 26.2 702  -1.360  0.1744\n SF_early - SF_intermediate      -98.93 25.7 702  -3.856  0.0003\n SF_early - SF_advanced         -175.18 28.3 702  -6.182  &lt;.0001\n SF_intermediate - SF_advanced   -76.25 26.2 702  -2.909  0.0056\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_EBA &lt;- emmeans(model_EBA_prec_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_EBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    490.7 23.6 710  20.770  &lt;.0001\n PF - SF_intermediate             458.7 23.6 710  19.416  &lt;.0001\n PF - SF_advanced                 421.4 26.5 710  15.901  &lt;.0001\n SF_early - SF_intermediate       -32.0 23.6 710  -1.354  0.1762\n SF_early - SF_advanced           -69.3 26.5 710  -2.615  0.0137\n SF_intermediate - SF_advanced    -37.3 26.5 710  -1.408  0.1762\n\nff_area = 10-20:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    493.7 23.6 710  20.895  &lt;.0001\n PF - SF_intermediate             431.1 23.6 710  18.248  &lt;.0001\n PF - SF_advanced                 350.6 26.5 710  13.227  &lt;.0001\n SF_early - SF_intermediate       -62.5 23.6 710  -2.647  0.0083\n SF_early - SF_advanced          -143.1 26.5 710  -5.400  &lt;.0001\n SF_intermediate - SF_advanced    -80.6 26.5 710  -3.040  0.0029\n\nff_area = 20-30:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    496.4 23.6 710  21.011  &lt;.0001\n PF - SF_intermediate             412.4 23.6 710  17.455  &lt;.0001\n PF - SF_advanced                 300.3 26.5 710  11.331  &lt;.0001\n SF_early - SF_intermediate       -84.0 23.6 710  -3.556  0.0004\n SF_early - SF_advanced          -196.1 26.5 710  -7.399  &lt;.0001\n SF_intermediate - SF_advanced   -112.1 26.5 710  -4.229  &lt;.0001\n\nff_area = 30-40:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    460.3 23.6 710  19.481  &lt;.0001\n PF - SF_intermediate             370.4 23.6 710  15.678  &lt;.0001\n PF - SF_advanced                 239.9 26.5 710   9.052  &lt;.0001\n SF_early - SF_intermediate       -89.9 23.6 710  -3.803  0.0002\n SF_early - SF_advanced          -220.4 26.5 710  -8.315  &lt;.0001\n SF_intermediate - SF_advanced   -130.5 26.5 710  -4.924  &lt;.0001\n\nff_area = 40-50:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    397.0 23.6 710  16.802  &lt;.0001\n PF - SF_intermediate             316.0 23.6 710  13.375  &lt;.0001\n PF - SF_advanced                 195.1 26.5 710   7.363  &lt;.0001\n SF_early - SF_intermediate       -81.0 23.6 710  -3.427  0.0006\n SF_early - SF_advanced          -201.8 26.5 710  -7.616  &lt;.0001\n SF_intermediate - SF_advanced   -120.9 26.5 710  -4.561  &lt;.0001\n\nff_area = 50-60:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    376.3 23.6 710  15.926  &lt;.0001\n PF - SF_intermediate             285.6 23.6 710  12.089  &lt;.0001\n PF - SF_advanced                 183.2 26.5 710   6.913  &lt;.0001\n SF_early - SF_intermediate       -90.7 23.6 710  -3.837  0.0001\n SF_early - SF_advanced          -193.1 26.5 710  -7.284  &lt;.0001\n SF_intermediate - SF_advanced   -102.4 26.5 710  -3.864  0.0001\n\nff_area = 60-70:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    392.1 23.6 710  16.594  &lt;.0001\n PF - SF_intermediate             301.8 23.6 710  12.774  &lt;.0001\n PF - SF_advanced                 231.4 26.5 710   8.729  &lt;.0001\n SF_early - SF_intermediate       -90.3 23.6 710  -3.821  0.0002\n SF_early - SF_advanced          -160.7 26.5 710  -6.064  &lt;.0001\n SF_intermediate - SF_advanced    -70.4 26.5 710  -2.658  0.0080\n\nff_area = 70-80:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    428.9 23.6 710  18.155  &lt;.0001\n PF - SF_intermediate             323.0 23.6 710  13.671  &lt;.0001\n PF - SF_advanced                 258.8 26.5 710   9.766  &lt;.0001\n SF_early - SF_intermediate      -105.9 23.6 710  -4.484  &lt;.0001\n SF_early - SF_advanced          -170.1 26.5 710  -6.419  &lt;.0001\n SF_intermediate - SF_advanced    -64.2 26.5 710  -2.421  0.0157\n\nff_area = 80-90:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    441.4 23.6 710  18.680  &lt;.0001\n PF - SF_intermediate             324.8 23.6 710  13.747  &lt;.0001\n PF - SF_advanced                 279.5 26.5 710  10.546  &lt;.0001\n SF_early - SF_intermediate      -116.5 23.6 710  -4.933  &lt;.0001\n SF_early - SF_advanced          -161.9 26.5 710  -6.107  &lt;.0001\n SF_intermediate - SF_advanced    -45.3 26.5 710  -1.710  0.0878\n\nff_area = 90-100:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    327.6 23.6 710  13.865  &lt;.0001\n PF - SF_intermediate             199.9 23.6 710   8.462  &lt;.0001\n PF - SF_advanced                 135.8 26.5 710   5.122  &lt;.0001\n SF_early - SF_intermediate      -127.6 23.6 710  -5.402  &lt;.0001\n SF_early - SF_advanced          -191.8 26.5 710  -7.238  &lt;.0001\n SF_intermediate - SF_advanced    -64.2 26.5 710  -2.422  0.0157\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_SBA &lt;- emmeans(model_SBA_prec_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_SBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    102.7 15.5 710   6.635  &lt;.0001\n PF - SF_intermediate             121.0 15.5 710   7.822  &lt;.0001\n PF - SF_advanced                 159.2 17.4 710   9.172  &lt;.0001\n SF_early - SF_intermediate        18.4 15.5 710   1.186  0.2359\n SF_early - SF_advanced            56.5 17.4 710   3.257  0.0018\n SF_intermediate - SF_advanced     38.2 17.4 710   2.199  0.0338\n\nff_area = 10-20:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    102.0 15.5 710   6.593  &lt;.0001\n PF - SF_intermediate             122.1 15.5 710   7.894  &lt;.0001\n PF - SF_advanced                 173.4 17.4 710   9.988  &lt;.0001\n SF_early - SF_intermediate        20.1 15.5 710   1.302  0.1935\n SF_early - SF_advanced            71.4 17.4 710   4.111  0.0001\n SF_intermediate - SF_advanced     51.2 17.4 710   2.951  0.0039\n\nff_area = 20-30:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    104.2 15.5 710   6.732  &lt;.0001\n PF - SF_intermediate             124.8 15.5 710   8.069  &lt;.0001\n PF - SF_advanced                 174.6 17.4 710  10.062  &lt;.0001\n SF_early - SF_intermediate        20.7 15.5 710   1.337  0.1818\n SF_early - SF_advanced            70.5 17.4 710   4.061  0.0001\n SF_intermediate - SF_advanced     49.8 17.4 710   2.869  0.0051\n\nff_area = 30-40:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    113.7 15.5 710   7.350  &lt;.0001\n PF - SF_intermediate             132.5 15.5 710   8.566  &lt;.0001\n PF - SF_advanced                 180.0 17.4 710  10.372  &lt;.0001\n SF_early - SF_intermediate        18.8 15.5 710   1.215  0.2247\n SF_early - SF_advanced            66.3 17.4 710   3.819  0.0002\n SF_intermediate - SF_advanced     47.5 17.4 710   2.736  0.0077\n\nff_area = 40-50:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                     99.7 15.5 710   6.441  &lt;.0001\n PF - SF_intermediate             127.4 15.5 710   8.232  &lt;.0001\n PF - SF_advanced                 181.6 17.4 710  10.463  &lt;.0001\n SF_early - SF_intermediate        27.7 15.5 710   1.790  0.0738\n SF_early - SF_advanced            81.9 17.4 710   4.720  &lt;.0001\n SF_intermediate - SF_advanced     54.2 17.4 710   3.124  0.0022\n\nff_area = 50-60:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    100.0 15.5 710   6.461  &lt;.0001\n PF - SF_intermediate             118.9 15.5 710   7.683  &lt;.0001\n PF - SF_advanced                 166.5 17.4 710   9.595  &lt;.0001\n SF_early - SF_intermediate        18.9 15.5 710   1.222  0.2219\n SF_early - SF_advanced            66.6 17.4 710   3.836  0.0002\n SF_intermediate - SF_advanced     47.7 17.4 710   2.746  0.0074\n\nff_area = 60-70:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    116.3 15.5 710   7.514  &lt;.0001\n PF - SF_intermediate             156.5 15.5 710  10.113  &lt;.0001\n PF - SF_advanced                 202.8 17.4 710  11.683  &lt;.0001\n SF_early - SF_intermediate        40.2 15.5 710   2.599  0.0095\n SF_early - SF_advanced            86.5 17.4 710   4.984  &lt;.0001\n SF_intermediate - SF_advanced     46.3 17.4 710   2.668  0.0094\n\nff_area = 70-80:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    130.5 15.5 710   8.434  &lt;.0001\n PF - SF_intermediate             168.5 15.5 710  10.890  &lt;.0001\n PF - SF_advanced                 216.1 17.4 710  12.449  &lt;.0001\n SF_early - SF_intermediate        38.0 15.5 710   2.457  0.0143\n SF_early - SF_advanced            85.6 17.4 710   4.931  &lt;.0001\n SF_intermediate - SF_advanced     47.6 17.4 710   2.741  0.0075\n\nff_area = 80-90:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    138.6 15.5 710   8.956  &lt;.0001\n PF - SF_intermediate             175.9 15.5 710  11.370  &lt;.0001\n PF - SF_advanced                 226.7 17.4 710  13.062  &lt;.0001\n SF_early - SF_intermediate        37.4 15.5 710   2.415  0.0160\n SF_early - SF_advanced            88.1 17.4 710   5.078  &lt;.0001\n SF_intermediate - SF_advanced     50.8 17.4 710   2.926  0.0043\n\nff_area = 90-100:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    209.7 15.5 710  13.557  &lt;.0001\n PF - SF_intermediate             263.2 15.5 710  17.014  &lt;.0001\n PF - SF_advanced                 279.9 17.4 710  16.126  &lt;.0001\n SF_early - SF_intermediate        53.5 15.5 710   3.458  0.0007\n SF_early - SF_advanced            70.1 17.4 710   4.041  0.0001\n SF_intermediate - SF_advanced     16.6 17.4 710   0.959  0.3381\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\n\n\nHeterocedasticidade\n\n# Função: resíduos normalizados vs n_obs, com controle de eixos\nplot_resid_hetero &lt;- function(m_lme, dat, region_name,\n                              show_x_lab = TRUE,\n                              show_y_lab = TRUE) {\n  rn &lt;- residuals(m_lme, type = \"response\")\n  ggplot(data.frame(n_obs = dat$n_obs, rnorm = rn),\n         aes(n_obs, rnorm)) +\n    geom_point(alpha = .35) +\n    geom_smooth(method = \"loess\", se = FALSE) +\n    geom_hline(yintercept = 0, lty = 2, col = \"grey40\") +\n    scale_x_log10() +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(hjust = 0.5)  \n    ) +\n    labs(\n      title = region_name,\n      #x = if (show_x_lab) expression(n[obs]~\"(log scale)\") else NULL,  \n      x = if (show_x_lab) \"\" else NULL,\n      y = if (show_y_lab) \"Residuals\" else NULL             \n    )\n}\n\n# Monta cada painel com as regras pedidas:\n# - CBA: só Y\np_het_cba &lt;- plot_resid_hetero(model_CBA_prec_w1, model_cba_prec, \"CBA\",\n                               show_x_lab = FALSE, show_y_lab = TRUE)\n\n# - EBA: só X\np_het_eba &lt;- plot_resid_hetero(model_EBA_prec_w1, model_eba_prec, \"EBA\",\n                               show_x_lab = TRUE, show_y_lab = FALSE)\n\n# - SBA: sem X e sem Y\np_het_sba &lt;- plot_resid_hetero(model_SBA_prec_w1, model_sba_prec, \"SBA\",\n                               show_x_lab = FALSE, show_y_lab = FALSE)\n\n# Painel 1x3\npainel_het_prec &lt;- ggpubr::ggarrange(p_het_cba, p_het_eba, p_het_sba,\n                                     ncol = 3, nrow = 1, align = \"hv\")\n\npainel_het_prec\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/hetero_residuals_lme_prec.png\", width=8, height=6, dpi=400, bg=\"white\")\n\n\n\nQQ Plot\n\nqq_lme &lt;- function(m, region_name, show_y_title = FALSE){\n  rn &lt;- residuals(m, type = \"response\")\n  ggplot(data.frame(rn=rn), aes(sample = rn)) +\n    stat_qq() + stat_qq_line() +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(size = 12, face = \"bold\", hjust = 0.5), # &lt;- aqui\n      axis.title.y = if (show_y_title) element_text() else element_blank()\n    ) +\n    labs(title = region_name, x = \"\", y = if (show_y_title) \"Sample quantiles\" else NULL)\n}\n\n# y apenas no primeiro (CBA)\nqq_cba &lt;- qq_lme(model_CBA_prec_w1, \"CBA\", show_y_title = TRUE)\nqq_eba &lt;- qq_lme(model_EBA_prec_w1, \"EBA\", show_y_title = FALSE)\nqq_sba &lt;- qq_lme(model_SBA_prec_w1, \"SBA\", show_y_title = FALSE)\n\npainel_qq_prec &lt;- ggarrange(qq_cba, qq_eba, qq_sba, ncol = 3, nrow = 1, align = \"hv\")\n\npainel_qq_prec\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/qqplot_prec.png\", bg = \"white\",\n       dpi = 600, width = 8, height = 6)\n\n\n\n\nCCC de Lins\n\n## CBA\n\n# Obter os valores observados e previstos\nobservado_cba_prec &lt;- model_cba_prec$Prec\nprevisto_cba_prec  &lt;- predict(model_CBA_prec_w1)\n\nccc_result_cba_prec  &lt;- CCC(observado_cba_prec , previsto_cba_prec )\nccc_val_cba_prec &lt;- round(ccc_result_cba_prec$rho.c[, \"est\"], 3)\n\n\n## EBA\n\n# Obter os valores observados e previstos\nobservado_eba_prec &lt;- model_eba_prec$Prec\nprevisto_eba_prec  &lt;- predict(model_EBA_prec_w1)\n\nccc_result_eba_prec  &lt;- CCC(observado_eba_prec , previsto_eba_prec )\nccc_val_eba_prec &lt;- round(ccc_result_eba_prec$rho.c[, \"est\"], 3)\n\n## SBA\n\n# Obter os valores observados e previstos\nobservado_sba_prec &lt;- model_sba_prec$Prec\nprevisto_sba_prec  &lt;- predict(model_SBA_prec_w1)\n\nccc_result_sba_prec  &lt;- CCC(observado_sba_prec , previsto_sba_prec )\nccc_val_sba_prec &lt;- round(ccc_result_sba_prec$rho.c[, \"est\"], 3)\n\n\n\nEfeitos para cada ff_area e classe florestal\n\n# Intervalos p/ plot “em_all”\nem_df_cba &lt;- as.data.frame(emm_CBA); em_df_cba$region &lt;- \"CBA\"\nem_df_eba &lt;- as.data.frame(emm_EBA); em_df_eba$region &lt;- \"EBA\"\nem_df_sba &lt;- as.data.frame(emm_SBA); em_df_sba$region &lt;- \"SBA\"\n\nem_all &lt;- bind_rows(em_df_cba, em_df_eba, em_df_sba) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    Tipo    = factor(Tipo,    levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  )\n\n# Comparações dentro de cada faixa (matriz / pwpm)\nem_cba_pw &lt;- emmeans(model_CBA_prec_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_eba_pw &lt;- emmeans(model_EBA_prec_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_sba_pw &lt;- emmeans(model_SBA_prec_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\n\npwpm(em_cba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2363]   &lt;.0001          &lt;.0001      0.0259\nSF_early         134.1   [2229]          0.7641      0.0984\nSF_intermediate  111.3    -22.8          [2252]      0.4786\nSF_advanced       73.7    -60.3           -37.6      [2290]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2396]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         176.0   [2220]          0.6686      0.1331\nSF_intermediate  149.5    -26.5          [2246]      0.6539\nSF_advanced      119.2    -56.8           -30.3      [2277]\n\nff_area = 20-30\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2416]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         198.5   [2218]          0.5621      0.1419\nSF_intermediate  168.1    -30.4          [2248]      0.7619\nSF_advanced      142.4    -56.1           -25.6      [2274]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2428]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         189.6   [2239]          0.7739      0.3572\nSF_intermediate  167.2    -22.4          [2261]      0.8608\nSF_advanced      146.6    -43.0           -20.6      [2282]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2429]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         206.3   [2223]          0.2266      0.0799\nSF_intermediate  161.7    -44.5          [2267]      0.9005\nSF_advanced      143.6    -62.6           -18.1      [2286]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2426]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         199.8   [2226]          0.0582      0.0073\nSF_intermediate  141.0    -58.8          [2285]      0.7623\nSF_advanced      115.4    -84.4           -25.6      [2311]\n\nff_area = 60-70\n                     PF SF_early SF_intermediate SF_advanced\nPF               [2433]   &lt;.0001          0.0001      0.0012\nSF_early         203.35   [2229]          &lt;.0001      0.0003\nSF_intermediate   99.62  -103.73          [2333]      0.9998\nSF_advanced       97.42  -105.93           -2.19      [2335]\n\nff_area = 70-80\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2440]   &lt;.0001          &lt;.0001      0.0110\nSF_early         217.2   [2223]          0.0040      &lt;.0001\nSF_intermediate  137.9    -79.3          [2302]      0.1336\nSF_advanced       81.1   -136.1           -56.8      [2359]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2443]   &lt;.0001          &lt;.0001      0.0011\nSF_early         237.7   [2205]          &lt;.0001      &lt;.0001\nSF_intermediate  110.3   -127.3          [2332]      0.9664\nSF_advanced       98.1   -139.5           -12.2      [2345]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2400]   &lt;.0001          0.3047      0.5253\nSF_early         139.5   [2261]          0.0007      &lt;.0001\nSF_intermediate   40.6    -98.9          [2359]      0.0195\nSF_advanced      -35.6   -175.2           -76.2      [2436]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_eba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2627]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         490.7   [2136]          0.5290      0.0450\nSF_intermediate  458.7    -32.0          [2168]      0.4947\nSF_advanced      421.4    -69.3           -37.3      [2205]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2573]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         493.7   [2079]          0.0412      &lt;.0001\nSF_intermediate  431.1    -62.5          [2141]      0.0131\nSF_advanced      350.6   -143.1           -80.6      [2222]\n\nff_area = 20-30\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2529]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early           496   [2032]          0.0023      &lt;.0001\nSF_intermediate    412      -84          [2116]      0.0002\nSF_advanced        300     -196            -112      [2229]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2461]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         460.3   [2000]          0.0009      &lt;.0001\nSF_intermediate  370.4    -89.9          [2090]      &lt;.0001\nSF_advanced      239.9   -220.4          -130.5      [2221]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2379]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early           397   [1982]          0.0036      &lt;.0001\nSF_intermediate    316      -81          [2063]      &lt;.0001\nSF_advanced        195     -202            -121      [2183]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2325]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         376.3   [1949]          0.0008      &lt;.0001\nSF_intermediate  285.6    -90.7          [2040]      0.0007\nSF_advanced      183.2   -193.1          -102.4      [2142]\n\nff_area = 60-70\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2339]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         392.1   [1947]          0.0008      &lt;.0001\nSF_intermediate  301.8    -90.3          [2037]      0.0401\nSF_advanced      231.4   -160.7           -70.4      [2108]\n\nff_area = 70-80\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2349]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         428.9   [1920]          &lt;.0001      &lt;.0001\nSF_intermediate  323.0   -105.9          [2026]      0.0741\nSF_advanced      258.8   -170.1           -64.2      [2090]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2365]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         441.4   [1924]          &lt;.0001      &lt;.0001\nSF_intermediate  324.8   -116.5          [2041]      0.3194\nSF_advanced      279.5   -161.9           -45.3      [2086]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2263]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         327.6   [1936]          &lt;.0001      &lt;.0001\nSF_intermediate  199.9   -127.6          [2063]      0.0739\nSF_advanced      135.8   -191.8           -64.2      [2127]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_sba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2100]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         102.7   [1998]          0.6357      0.0065\nSF_intermediate  121.0     18.4          [1979]      0.1243\nSF_advanced      159.2     56.5            38.2      [1941]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2104]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         102.0   [2002]          0.5622      0.0003\nSF_intermediate  122.1     20.1          [1981]      0.0172\nSF_advanced      173.4     71.4            51.2      [1930]\n\nff_area = 20-30\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2098]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         104.2   [1994]          0.5398      0.0003\nSF_intermediate  124.8     20.7          [1973]      0.0220\nSF_advanced      174.6     70.5            49.8      [1923]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2099]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         113.7   [1985]          0.6174      0.0008\nSF_intermediate  132.5     18.8          [1966]      0.0323\nSF_advanced      180.0     66.3            47.5      [1919]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2085]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early          99.7   [1985]          0.2787      &lt;.0001\nSF_intermediate  127.4     27.7          [1957]      0.0100\nSF_advanced      181.6     81.9            54.2      [1903]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2080]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         100.0   [1980]          0.6127      0.0008\nSF_intermediate  118.9     18.9          [1961]      0.0314\nSF_advanced      166.5     66.6            47.7      [1913]\n\nff_area = 60-70\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2091]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         116.3   [1975]          0.0470      &lt;.0001\nSF_intermediate  156.5     40.2          [1935]      0.0390\nSF_advanced      202.8     86.5            46.3      [1889]\n\nff_area = 70-80\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2100]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         130.5   [1969]          0.0678      &lt;.0001\nSF_intermediate  168.5     38.0          [1931]      0.0319\nSF_advanced      216.1     85.6            47.6      [1884]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2111]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         138.6   [1973]          0.0752      &lt;.0001\nSF_intermediate  175.9     37.4          [1935]      0.0186\nSF_advanced      226.7     88.1            50.8      [1884]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [2181]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         209.7   [1971]          0.0032      0.0003\nSF_intermediate  263.2     53.5          [1918]      0.7730\nSF_advanced      279.9     70.1            16.6      [1901]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\n# Exportar matriz como data.frame\npw_cba_df &lt;- as.data.frame(pwpm(em_cba_pw, sort = FALSE))\npw_eba_df &lt;- as.data.frame(pwpm(em_eba_pw, sort = FALSE))\npw_sba_df &lt;- as.data.frame(pwpm(em_sba_pw, sort = FALSE))\npw_df &lt;- bind_rows(pw_cba_df, pw_eba_df, pw_sba_df)\n\nopenxlsx::write.xlsx(pw_df, file = \"data_group/matriz_contrastes_pwpm_prec.xlsx\", rowNames = TRUE)\n\n# Tabela final - análises\ntabela_estilo_fig1 &lt;- em_all %&gt;%\n  mutate(\n    Tipo = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  ) %&gt;%\n  rename(\n    Region   = region,\n    Cover    = Tipo,\n    Effect   = emmean,\n    Interval = ff_area,\n    CI_lower = lower.CL,\n    CI_upper = upper.CL\n  ) %&gt;%\n  mutate(\n    Variable = \"PREC\",\n    Cover = factor(Cover, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(Interval, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\n                                           \"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\"))\n  ) %&gt;%\n  arrange(Region, Cover, Interval) %&gt;%\n  dplyr::select(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)\n\nopenxlsx::write.xlsx(\n  tabela_estilo_fig1,\n  file = \"data_group/emmeans_intervalos_prec.xlsx\",\n  rowNames = FALSE\n)\n\n# Tabela final - SI\n\n# Preparar tabela base\nt2 &lt;- em_all %&gt;%\n  mutate(\n    Cover = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                          \"40-50\",\"50-60\",\"60-70\",\"70-80\",\n                                          \"80-90\",\"90-100\"))\n  ) %&gt;%\n  dplyr::select(region, Interval, Cover,\n         Effect = emmean,\n         CI_lower = lower.CL,\n         CI_upper = upper.CL)\n\n# Reorganizar para formato largo (larger table like Figure 2)\ntabela_fig2 &lt;- t2 %&gt;%\n  arrange(Interval, Cover) %&gt;%\n  tidyr::pivot_wider(\n    names_from = region,\n    values_from = c(Effect, CI_lower, CI_upper),\n    names_glue = \"{region}_{.value}\"\n  ) %&gt;%\n  arrange(Interval, Cover)\n\nopenxlsx::write.xlsx(\n  tabela_fig2,\n  file = \"data_group/emmeans_intervalos_prec_table_final.xlsx\",\n  rowNames = FALSE\n)\n\n\n\nConstrastes e significancia\n\nget_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area*Tipo, lmer.df = \"satterthwaite\")\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", by = \"ff_area\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  df\n}\n\ncontrast_CBA_df &lt;- get_contrasts(model_CBA_prec_w1, \"CBA\")\ncontrast_EBA_df &lt;- get_contrasts(model_EBA_prec_w1, \"EBA\")\ncontrast_SBA_df &lt;- get_contrasts(model_SBA_prec_w1, \"SBA\")\n\nall_contrasts &lt;- bind_rows(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) %&gt;%\n  filter(grepl(\"PF\", contrast) & grepl(\"SF_\", contrast)) %&gt;%\n  tidyr::separate(contrast, into = c(\"tipo1\", \"tipo2\"), sep = \" - \") %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")) |\n         (tipo2 == \"PF\" & tipo1 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    tipo_sf = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF − SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nwritexl::write_xlsx(all_contrasts, \"data_group/contrast_PF_SF_prec.xlsx\")\n\n\n\n\nPainel Prec\n\n# Plot de pontos\nplot_point_prec &lt;- function(region_name, show_y = TRUE, show_legend = FALSE, show_y_axes = TRUE) {\n  p &lt;- ggplot(filter(em_all, region == region_name) %&gt;%\n    mutate(\n      Tipo = factor(Tipo) %&gt;%\n        fct_relevel(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\") %&gt;%\n        fct_recode(\n          \"PF\" = \"PF\",\n          \"SF early\" = \"SF_early\",\n          \"SF intermediate\" = \"SF_intermediate\",\n          \"SF advanced\" = \"SF_advanced\"\n        )\n    ),\n    aes(x = ff_area, y = emmean, color = Tipo, group = Tipo)) +\n    geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),\n                  position = position_dodge(width = 0.8), width = 0.6, size = 0.5) +\n    geom_point(position = position_dodge(width = 0.8), size = 1.5) +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_blank(),\n      legend.background = element_rect(fill = \"transparent\"),\n      legend.text = element_text(size = 10),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      axis.text.x = element_blank(),\n      #axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),\n      axis.text.y = if (show_y_axes) element_text(size = 10) else element_blank(),\n      axis.title.y = if (show_y) element_text(size = 14, margin = margin(r = -20)) else element_blank(),\n      axis.title.x = element_blank(),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    scale_color_manual(values = c(\"midnightblue\", \"#87CEFA\", \"#1E90FF\", \"#0000FF\")) +\n    scale_y_continuous(limits = c(1800, 2800), breaks = seq(1800, 2800, by = 200)) +\n    #labs(y = if (show_y) \"Precipitation\\nfixed effects (mm·yr⁻¹)\" else NULL) +\n    labs(y = if (show_y) expression(bold(atop(\"Estimated marginal mean\", \"precipitation (mm·yr\"^{-1}*\")\"))) else NULL) \n  \n  return(p)\n}\n\n# Atualizar ordem dos fatores e renomear os labels\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")),\n    tipo_sf_label = fct_recode(tipo_sf,\n                               \"SF early\" = \"SF_early\",\n                               \"SF intermediate\" = \"SF_intermediate\",\n                               \"SF advanced\" = \"SF_advanced\")\n  )\n\n\n# Criar coluna categórica para estimate\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    estimate_cat = factor(\n      cut(estimate,\n          breaks = c(-Inf, 100, 200, Inf),\n          labels = c(\"&lt;100\", \"100 to 200\", \"&gt;200\")\n      ),\n      levels = c(\"&lt;100\", \"100 to 200\", \"&gt;200\")\n    )\n  )\n\n# Heatmap de contrastes\nplot_heat_prec &lt;- function(region_name, show_legend = FALSE, show_y_labels = TRUE) {\n  ggplot(filter(all_contrasts, region == region_name), \n         aes(x = ff_area, y = tipo_sf_label, fill = estimate_cat)) +\n    geom_tile(color = \"white\", height = 0.7) +\n    geom_text(aes(label = sig_label), size = 3, color = \"black\", family = \"serif\") +\n    scale_fill_manual(values = c(\"&lt;100\" = \"#92C5DE\", \"100 to 200\" = \"#4393C3\", \"&gt;200\" = \"#2166AC\"),\n                      limits = c(\"&lt;100\", \"100 to 200\", \"&gt;200\"),\n                      drop = FALSE,\n                      name = bquote(bold(atop(Delta~\"Prec (PF − SF)\", \"(mm)\")))\n    )+\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text.x = element_blank(),\n      axis.title = element_blank(),\n      axis.text.y = if (show_y_labels) element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\") else element_blank(),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_text(size = 10, face = \"bold\", family = \"serif\"),\n      legend.text = element_text(size = 10),\n      plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\", family = \"serif\"),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    labs(title = region_name)\n}\n\n# Combinar gráficos para cada região\npanel_CBA_prec &lt;- plot_heat_prec(\"CBA\", show_legend = FALSE, show_y_labels = TRUE) /\n             plot_point_prec(\"CBA\", show_y = TRUE, show_legend = FALSE, show_y_axes = TRUE)\npanel_CBA_prec &lt;- panel_CBA_prec + plot_layout(heights = c(0.2, 0.8))\n\npanel_EBA_prec &lt;- plot_heat_prec(\"EBA\", show_legend = FALSE, show_y_labels = FALSE) /\n             plot_point_prec(\"EBA\", show_y = FALSE, show_legend = FALSE, show_y_axes = FALSE)\npanel_EBA_prec &lt;- panel_EBA_prec + plot_layout(heights = c(0.2, 0.8))\n\npanel_SBA_prec &lt;- plot_heat_prec(\"SBA\", show_legend = TRUE, show_y_labels = FALSE) /\n             plot_point_prec(\"SBA\", show_y = FALSE, show_legend = TRUE, show_y_axes = FALSE)\npanel_SBA_prec &lt;- panel_SBA_prec + plot_layout(heights = c(0.2, 0.8))\n\n# Combinar todos os painéis horizontalmente\nfinal_panel_prec &lt;- (panel_CBA_prec | panel_EBA_prec | panel_SBA_prec)\n\n# Exibir painel final\nfinal_panel_prec\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/em_fixed_fixed_prec.png\",\n       plot = final_panel_prec,\n       bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 4372385 233.6    7437491 397.3  7437491 397.3\nVcells 8114259  62.0   14786712 112.9 12255594  93.6\n\n\n\nTodos os constraste entre frações de área\n\n# Lista de modelos\nmodelos &lt;- list(CBA = model_CBA_prec_w1, EBA = model_EBA_prec_w1, SBA = model_SBA_prec_w1)\n\n# Função para gerar todos os contrastes PF - SF\nget_all_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area * Tipo)\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  return(df)\n}\n\n# Aplicar para todas as regiões\nall_contrasts_sup &lt;- purrr::map2_dfr(modelos, names(modelos), get_all_contrasts)\n\nstr(all_contrasts_sup)\n\nClasses 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:\n $ contrast: chr  \"(10-20 PF) - (1-10 PF)\" \"(20-30 PF) - (1-10 PF)\" \"(20-30 PF) - (10-20 PF)\" \"(30-40 PF) - (1-10 PF)\" ...\n $ estimate: num  32.5 52.6 20.1 65 32.5 ...\n $ SE      : num  23.4 23.4 23.4 23.4 23.4 ...\n $ df      : num  702 702 702 702 702 ...\n $ t.ratio : num  1.389 2.251 0.861 2.781 1.392 ...\n $ p.value : num  0.2229 0.0408 0.4673 0.0104 0.2224 ...\n $ region  : chr  \"CBA\" \"CBA\" \"CBA\" \"CBA\" ...\n - attr(*, \"estName\")= chr \"estimate\"\n - attr(*, \"pri.vars\")= chr \"contrast\"\n - attr(*, \"adjust\")= chr \"fdr\"\n - attr(*, \"side\")= num 0\n - attr(*, \"delta\")= num 0\n - attr(*, \"type\")= chr \"link\"\n - attr(*, \"mesg\")= chr [1:2] \"Degrees-of-freedom method: kenward-roger\" \"P value adjustment: fdr method for 780 tests\"\n - attr(*, \"digits\")= int 7\n\n# Extrair contrastes entre PF e SF\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  filter(str_detect(contrast, \"PF\") & str_detect(contrast, \"SF_\"))\n\n# Extrair informações usando regex\n# Regex para capturar (faixa tipo) - (faixa tipo)\nextr &lt;- str_match(all_contrasts_sup$contrast,\n                  \"\\\\(([^ ]+) ([^)]+)\\\\) - \\\\(([^ ]+) ([^)]+)\\\\)\")\n\n# Adicionar colunas extraídas\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa1 = extr[, 2],\n    tipo1 = extr[, 3],\n    faixa2 = extr[, 4],\n    tipo2 = extr[, 5]\n  ) %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% sf_levels) | (tipo2 == \"PF\" & tipo1 %in% sf_levels)) %&gt;%\n  mutate(\n    faixa_PF = if_else(tipo1 == \"PF\", faixa1, faixa2),\n    faixa_SF = if_else(tipo1 == \"PF\", faixa2, faixa1),\n    tipo_SF  = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF - SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\n# Ajustar fatores\nfaixas_niveis &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\",\n                   \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa_PF = factor(faixa_PF, levels = faixas_niveis),\n    faixa_SF = factor(faixa_SF, levels = faixas_niveis),\n    tipo_SF  = factor(tipo_SF,  levels = sf_levels)\n  )\n\n\n# Classificação mantendo sinal\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n   mutate(\n    tipo_SF = fct_recode(tipo_SF,\n                         \"SF early\" = \"SF_early\",\n                         \"SF intermediate\" = \"SF_intermediate\",\n                         \"SF advanced\" = \"SF_advanced\")\n  ) %&gt;% \n  mutate(\n    estimate_class = case_when(\n      estimate &lt; 0 ~ \"&lt;0\",\n      estimate &gt;= 0 & estimate &lt; 100 ~ \"0-100\",\n      estimate &gt;= 100 & estimate &lt; 200 ~ \"100–200\",\n      estimate &gt;= 200 & estimate &lt; 300 ~ \"200–300\",\n      estimate &gt;= 300 ~ \"&gt;300\"\n    ),\n    estimate_class = factor(estimate_class, levels = c(\"&lt;0\", \"0-100\", \"100–200\", \"200–300\", \"&gt;300\"))\n  )\n\n\n# Plot\nheatmap_all_contrasts &lt;- ggplot(all_contrasts_sup, \n                        aes(x = faixa_SF, y = faixa_PF, fill = estimate_class)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = sig_label), color = \"black\", size = 3, family = \"serif\") +\n  scale_fill_manual(values = c(\n    \"&lt;0\" = \"#F4A582\",\n    \"0-100\" = \"#92C5DE\",\n    \"100–200\" = \"#4393C3\",\n    \"200–300\" = \"#2166AC\",\n    \"&gt;300\" = \"#053061\"\n  ), name = expression(bold(atop(Delta~\"Prec (PF - SF)\", \"(mm)\"))))+\n  facet_grid(tipo_SF ~ region) +\n  theme_minimal(base_family = \"serif\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(size = 12, face = \"bold\"),\n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\")\n  ) +\n   labs(x = \"SF fractional cover (%)\",\n        y = \"PF fractional cover (%)\")\n\nheatmap_all_contrasts\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_prec.png\", width = 10, height = 8, dpi = 600, bg = \"white\")\n\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_prec.pdf\", width = 10, height = 8, bg = \"white\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 4391395 234.6    7437491 397.3  7437491 397.3\nVcells 8170906  62.4   14786712 112.9 14786674 112.9\n\n\n\n\n\nRandom effect\n\n# Função para extrair efeitos aleatórios com IC por região\nextract_random_effects &lt;- function(model, region_name) {\n  # Efeitos aleatórios com variância condicional\n  ran &lt;- ranef(model, condVar = TRUE)\n  \n  # Extrair efeitos por ano\n  ran_df &lt;- as.data.frame(ran$Ano)\n  names(ran_df) &lt;- \"effect\"\n  ran_df$ano &lt;- rownames(ran$Ano)\n  \n  # Intervalos de confiança (erro padrão)\n  se &lt;- attr(ran$Ano, \"postVar\")[1, 1, ] |&gt; sqrt()\n  \n  ran_df &lt;- ran_df %&gt;%\n    mutate(\n      se = se,\n      lower = effect - 1.96 * se,\n      upper = effect + 1.96 * se,\n      region = region_name\n    )\n  \n  return(ran_df)\n}\n\n# Aplicar para os três modelos (substitua pelos seus objetos reais)\nrandom_cba &lt;- extract_random_effects(model_CBA_prec_w1, \"CBA\")\nrandom_eba &lt;- extract_random_effects(model_EBA_prec_w1, \"EBA\")\nrandom_sba &lt;- extract_random_effects(model_SBA_prec_w1, \"SBA\")\n\n# Combinar tudo\nrandom_all &lt;- bind_rows(random_cba, random_eba, random_sba)\n\n# Garantir que o ano seja ordenável\nrandom_all$ano &lt;- as.numeric(as.character(random_all$ano))\n\n# Salvar\nwrite_xlsx(random_all, \"data_group/random_effects_prec.xlsx\")\n\n\nPlot\n\n# Plot\np1_rand_prec &lt;- ggplot(random_all, aes(x = ano, y = effect)) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray40\") +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha = 0.8, fill = \"#1E90FF\") +\n  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.5, color = \"black\") +\n  facet_wrap(~region, scales = \"free_x\") +\n  scale_x_continuous(breaks = seq(2001, 2021, by = 2)) + \n  ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      #axis.text.x = element_text(angle = 45, hjust = 1),\n      axis.text.x = element_blank(),\n      axis.title = element_text(size = 14),\n      strip.text = element_text(face = \"bold\", size = 13)) +\n  labs(\n    x = \"\",\n    y = expression(bold(atop(\"Precipitation\", \"random effects (mm·yr\"^{-1}*\")\")))\n  )\n\np1_rand_prec\n\n\n\n\n\n\n\nggsave(\"fig/histogram_random_prec.png\", bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\n\n\n\nPredicted\n\nPlot\n\nmodel_cba_prec$predicted &lt;- predict(model_CBA_prec_w1, model_cba_prec)\nmodel_eba_prec$predicted &lt;- predict(model_EBA_prec_w1, model_eba_prec)\nmodel_sba_prec$predicted &lt;- predict(model_SBA_prec_w1, model_sba_prec)\n\nr2_cba_prec_lab &lt;- r2_lmer_w(model_CBA_prec_w1, model_cba_prec, type = \"cond\")\nr2_eba_prec_lab &lt;- r2_lmer_w(model_EBA_prec_w1, model_eba_prec, type = \"cond\")\nr2_sba_prec_lab &lt;- r2_lmer_w(model_SBA_prec_w1, model_sba_prec, type = \"cond\")\n\n\nall_vals &lt;- c(model_cba_prec$Prec, model_cba_prec$predicted,\n              model_eba_prec$Prec, model_eba_prec$predicted,\n              model_sba_prec$Prec, model_sba_prec$predicted)\n\nrng     &lt;- range(all_vals, na.rm = TRUE)\npad     &lt;- 0.02 * diff(rng)\nlim_min &lt;- floor((rng[1] - pad) / 300) * 300\nlim_max &lt;- ceiling((rng[2] - pad)  / 300) * 300\nbrks    &lt;- seq(lim_min, lim_max, by = 300)\n\n# Função base do gráfico (escala 1:1 e linha 45°)\nmake_plot &lt;- function(dat, titulo, subtitulo){\n  ggplot(dat, aes(Prec, predicted)) +\n    geom_point(size = 2, alpha = .7, na.rm = TRUE) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"orange\", na.rm = TRUE) +\n    geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"grey40\") +\n    scale_x_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +  \n    scale_y_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +\n    theme_minimal() +\n    labs(\n      x = \"Observed\\nprecipitation (mm·yr⁻¹)\",\n      y = \"Predicted\\nprecipitation (mm·yr⁻¹)\",  # mostra o eixo y em TODOS\n      title = titulo,\n      subtitle = subtitulo\n    )\n}\n\n\n\nPainel\n\n# Plots\ncba_pf &lt;- make_plot(model_cba_prec, \"\", paste0(\"R² = \", round(r2_cba_prec_lab, 3), \" | CCC = \", ccc_val_cba_prec))\neba_pf &lt;- make_plot(model_eba_prec, \"\", paste0(\"R² = \", round(r2_eba_prec_lab, 3), \" | CCC = \", ccc_val_eba_prec)) + labs(y = NULL)\nsba_pf &lt;- make_plot(model_sba_prec, \"\", paste0(\"R² = \", round(r2_sba_prec_lab, 3), \" | CCC = \", ccc_val_sba_prec)) + labs(y = NULL)\n\n# Painel\np1_pred_prec &lt;- (cba_pf + eba_pf + sba_pf) +\n  patchwork::plot_layout(ncol = 3, nrow = 1, guides = \"collect\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text  = element_text(size = 10, face = \"plain\", family = \"serif\"),\n    axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, family = \"serif\")\n  )\n\np1_pred_prec\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_observed_prec.png\", bg = \"white\", dpi = 600, width = 9, height = 7.5)\n\n\n\n\nModel plotting\n\nCBA\n\n# Atribuindo os dados\nmodel_cba_all_prec &lt;- model_cba_prec %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_CBA_prec_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_cba_all_prec &lt;- model_cba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\n\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_cba_all_prec[model_cba_all_prec$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_cba_all_prec[model_cba_all_prec$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_cba_all_prec[model_cba_all_prec$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_cba_all_prec[model_cba_all_prec$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_cba_all_prec[model_cba_all_prec$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_cba_all_prec &lt;- model_cba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_prec_cba &lt;- model_cba_all_prec %&gt;%\n  ggplot(aes(x = area * 10, y = Prec, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  scale_y_continuous(breaks = seq(1800, 2700, by = 300)) +\n  ggthemes::theme_few() +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted precipitation (mm·yr⁻¹) - CBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_prec_cba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_prec_CBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nEBA\n\n# Atribuindo os dados\nmodel_eba_all_prec &lt;- model_eba_prec %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_EBA_prec_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_eba_all_prec &lt;- model_eba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_eba_all_prec[model_eba_all_prec$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_eba_all_prec[model_eba_all_prec$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_eba_all_prec[model_eba_all_prec$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_eba_all_prec[model_eba_all_prec$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_eba_all_prec[model_eba_all_prec$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_eba_all_prec &lt;- model_eba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_prec_eba &lt;- model_eba_all_prec %&gt;%\n  ggplot(aes(x = area * 10, y = Prec, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(1700, 2600, by = 300)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted precipitation (mm·yr⁻¹) - EBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_prec_eba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_prec_EBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nSBA\n\n# Atribuindo os dados\nmodel_sba_all_prec &lt;- model_sba_prec %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_SBA_prec_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_sba_all_prec &lt;- model_sba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_sba_all_prec[model_sba_all_prec$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_sba_all_prec[model_sba_all_prec$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_sba_all_prec[model_sba_all_prec$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_sba_all_prec[model_sba_all_prec$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_sba_all_prec[model_sba_all_prec$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_sba_all_prec &lt;- model_sba_all_prec %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\nm1_prec_sba &lt;- model_sba_all_prec %&gt;%\n  ggplot(aes(x = area*10, y = Prec))+\n  theme_bw()+\n  geom_point(aes(x = area*10, y = Prec, color = vegetation)) + \n  geom_line(aes(y = predicted, group = vegetation, color = vegetation), size = 1)+\n    scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n    scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(1600, 2500, by = 300)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted precipitation (mm·yr⁻¹) - SBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  # Tamanho do texto da legenda\n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_prec_sba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_prec_SBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#evapotranspiration-1",
    "href": "code_climate_forest_regeneration.html#evapotranspiration-1",
    "title": "Packages",
    "section": "EVAPOTRANSPIRATION",
    "text": "EVAPOTRANSPIRATION\n\nModel choice\n\n# Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área\nall_pf_sf_evapo_model = read_xlsx(\"data_group/plan_data_group_evapo.xlsx\")\n\n# Definindo a ordem correta das categorias\nord_ff   &lt;- c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")\nlev_tipo &lt;- c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")\n\n# Recodifica como fatores na ordem correta\nrecode_fac &lt;- function(d){\n  d %&gt;%\n    mutate(\n      ff_area = factor(ff_area, levels = ord_ff, ordered = TRUE),\n      Tipo    = factor(Tipo,    levels = lev_tipo)\n    )\n}\n\n# Separa por região e aplica a recodificação\nmodel_cba_evapo &lt;- all_pf_sf_evapo_model %&gt;% filter(region == \"CBA\") %&gt;% recode_fac()\nmodel_eba_evapo &lt;- all_pf_sf_evapo_model %&gt;% filter(region == \"EBA\") %&gt;% recode_fac()\nmodel_sba_evapo &lt;- all_pf_sf_evapo_model %&gt;% filter(region == \"SBA\") %&gt;% recode_fac()\n\n# Cria um identificador para cada estrato\nadd_estrato &lt;- function(d){\n  d$estrato_id &lt;- interaction(d$region, d$ff_area, d$Tipo, drop = TRUE)\n  d\n}\n\nmodel_cba_evapo &lt;- add_estrato(model_cba_evapo)\nmodel_eba_evapo &lt;- add_estrato(model_eba_evapo)\nmodel_sba_evapo &lt;- add_estrato(model_sba_evapo)\n\n\n\nFixed effect\n\n# CBA\nmodel_CBA_evapo_w1 &lt;- lmer(Evapo ~ ff_area*Tipo + (1|Ano),\n                          data = model_cba_evapo)\n\n# EBA\nmodel_EBA_evapo_w1 &lt;- lmer(Evapo ~ ff_area*Tipo + (1|Ano),\n                          data = model_eba_evapo)\n\n\n# SBA\nmodel_SBA_evapo_w1 &lt;- lmer(Evapo ~ ff_area*Tipo + (1|Ano),\n                          data = model_sba_evapo)\n\n\n# Conferir coeficientes fixos rapidamente\nbroom.mixed::tidy(model_CBA_evapo_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term          estimate std.error  statistic    df   p.value\n   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;\n 1 fixed  (Intercept) 1432.           6.42 223.        21.7 5.27e- 38\n 2 fixed  ff_area.L    127.           4.92  25.8      702.  1.51e-103\n 3 fixed  ff_area.Q    -47.0          4.92  -9.56     702.  1.88e- 20\n 4 fixed  ff_area.C     27.9          4.92   5.68     702.  1.96e-  8\n 5 fixed  ff_area^4     -1.26         4.92  -0.255    702.  7.98e-  1\n 6 fixed  ff_area^5      4.85         4.92   0.986    702.  3.24e-  1\n 7 fixed  ff_area^6      1.42         4.92   0.290    702.  7.72e-  1\n 8 fixed  ff_area^7      1.17         4.92   0.238    702.  8.12e-  1\n 9 fixed  ff_area^8      0.00189      4.92   0.000385 702.  1.00e+  0\n10 fixed  ff_area^9      0.763        4.92   0.155    702.  8.77e-  1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_EBA_evapo_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept)  1511.        6.12   247.     21.3 2.83e-38\n 2 fixed  ff_area.L      59.5       3.95    15.1   710.  1.19e-44\n 3 fixed  ff_area.Q     -36.4       3.95    -9.22  710.  3.38e-19\n 4 fixed  ff_area.C      22.0       3.95     5.56  710.  3.84e- 8\n 5 fixed  ff_area^4      -5.25      3.95    -1.33  710.  1.84e- 1\n 6 fixed  ff_area^5      -3.34      3.95    -0.845 710.  3.98e- 1\n 7 fixed  ff_area^6       2.71      3.95     0.686 710.  4.93e- 1\n 8 fixed  ff_area^7       2.99      3.95     0.757 710.  4.49e- 1\n 9 fixed  ff_area^8      -1.90      3.95    -0.481 710.  6.31e- 1\n10 fixed  ff_area^9      -1.71      3.95    -0.432 710.  6.66e- 1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_SBA_evapo_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept)  1396.       12.4    113.     20.6 3.45e-30\n 2 fixed  ff_area.L      95.3       5.52    17.3   710.  5.20e-56\n 3 fixed  ff_area.Q     -10.0       5.52    -1.81  710.  7.01e- 2\n 4 fixed  ff_area.C      19.2       5.52     3.48  710.  5.27e- 4\n 5 fixed  ff_area^4      -5.46      5.52    -0.988 710.  3.23e- 1\n 6 fixed  ff_area^5      -3.44      5.52    -0.623 710.  5.34e- 1\n 7 fixed  ff_area^6       5.12      5.52     0.928 710.  3.54e- 1\n 8 fixed  ff_area^7       3.93      5.52     0.712 710.  4.77e- 1\n 9 fixed  ff_area^8      -3.54      5.52    -0.641 710.  5.21e- 1\n10 fixed  ff_area^9      -2.38      5.52    -0.432 710.  6.66e- 1\n# ℹ 30 more rows\n\n\n\nR-square for Linear Mixed Model (LMM)\n\n# ---- Helpers coerentes com o ajuste ----\nweighted_mean &lt;- function(y, w) sum(w*y)/sum(w)\nr2_w_sse &lt;- function(y, yhat, w) {\n  sst &lt;- sum(w * (y - weighted_mean(y, w))^2)\n  ssr &lt;- sum(w * (y - yhat)^2)\n  1 - ssr/sst\n}\n\n# R² ponderado \"marginal\" (fixos) e \"condicional\" (fixos + RE) \nr2_lmer_w &lt;- function(m, dat, resp = \"Evapo\", type = c(\"marg\",\"cond\")) {\n  type &lt;- match.arg(type)\n  w &lt;- as.numeric(weights(m))            \n  y &lt;- dat[[resp]]\n  yhat &lt;- if (type == \"marg\") predict(m, re.form = ~0) else predict(m, re.form = NULL)\n  r2_w_sse(y, yhat, w)\n}\n\n# Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))\nr2_cba_evapo &lt;- c(\n  R2_marg_w = r2_lmer_w(model_CBA_evapo_w1, model_cba_evapo, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_CBA_evapo_w1, model_cba_evapo, type=\"cond\")\n)\nr2_eba_evapo &lt;- c(\n  R2_marg_w = r2_lmer_w(model_EBA_evapo_w1, model_eba_evapo, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_EBA_evapo_w1, model_eba_evapo, type=\"cond\")\n)\nr2_sba_evapo &lt;- c(\n  R2_marg_w = r2_lmer_w(model_SBA_evapo_w1, model_sba_evapo, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_SBA_evapo_w1, model_sba_evapo, type=\"cond\")\n)\n\nr2_cba_evapo; r2_eba_evapo; r2_sba_evapo\n\nR2_marg_w R2_cond_w \n0.5126236 0.8141419 \n\n\nR2_marg_w R2_cond_w \n0.7185876 0.9187478 \n\n\nR2_marg_w R2_cond_w \n0.3175876 0.8767470 \n\n# Exportar (opcional)\nr2_tbl &lt;- tibble::tibble(\n  region = c(\"CBA\",\"EBA\",\"SBA\"),\n  R2_marg_w = c(r2_cba_evapo[\"R2_marg_w\"], r2_eba_evapo[\"R2_marg_w\"], r2_sba_evapo[\"R2_marg_w\"]),\n  R2_cond_w = c(r2_cba_evapo[\"R2_cond_w\"], r2_eba_evapo[\"R2_cond_w\"], r2_sba_evapo[\"R2_cond_w\"])\n)\nwritexl::write_xlsx(r2_tbl, \"data_group/r2_weighted_evapo.xlsx\")\n\n\n# Ajuste múltiplo BH para comparações por faixa.\nemm_CBA &lt;- emmeans(model_CBA_evapo_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_CBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                 -102.043 6.95 702 -14.676  &lt;.0001\n PF - SF_intermediate          -101.280 6.95 702 -14.566  &lt;.0001\n PF - SF_advanced               -95.824 7.80 702 -12.286  &lt;.0001\n SF_early - SF_intermediate       0.763 6.95 702   0.110  0.9127\n SF_early - SF_advanced           6.219 7.80 702   0.797  0.5814\n SF_intermediate - SF_advanced    5.456 7.80 702   0.700  0.5814\n\nff_area = 10-20:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -72.885 6.95 702 -10.482  &lt;.0001\n PF - SF_intermediate           -68.436 6.95 702  -9.842  &lt;.0001\n PF - SF_advanced               -62.131 7.80 702  -7.966  &lt;.0001\n SF_early - SF_intermediate       4.449 6.95 702   0.640  0.5225\n SF_early - SF_advanced          10.755 7.80 702   1.379  0.2525\n SF_intermediate - SF_advanced    6.306 7.80 702   0.808  0.5029\n\nff_area = 20-30:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -51.241 6.95 702  -7.369  &lt;.0001\n PF - SF_intermediate           -50.415 6.95 702  -7.251  &lt;.0001\n PF - SF_advanced               -47.920 7.80 702  -6.144  &lt;.0001\n SF_early - SF_intermediate       0.826 6.95 702   0.119  0.9055\n SF_early - SF_advanced           3.321 7.80 702   0.426  0.8989\n SF_intermediate - SF_advanced    2.495 7.80 702   0.320  0.8989\n\nff_area = 30-40:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -46.597 6.95 702  -6.701  &lt;.0001\n PF - SF_intermediate           -42.765 6.95 702  -6.150  &lt;.0001\n PF - SF_advanced               -38.897 7.80 702  -4.987  &lt;.0001\n SF_early - SF_intermediate       3.832 6.95 702   0.551  0.6201\n SF_early - SF_advanced           7.700 7.80 702   0.987  0.4858\n SF_intermediate - SF_advanced    3.868 7.80 702   0.496  0.6201\n\nff_area = 40-50:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -41.800 6.95 702  -6.012  &lt;.0001\n PF - SF_intermediate           -43.790 6.95 702  -6.298  &lt;.0001\n PF - SF_advanced               -33.911 7.80 702  -4.348  &lt;.0001\n SF_early - SF_intermediate      -1.990 6.95 702  -0.286  0.7748\n SF_early - SF_advanced           7.889 7.80 702   1.011  0.3746\n SF_intermediate - SF_advanced    9.879 7.80 702   1.267  0.3085\n\nff_area = 50-60:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -37.683 6.95 702  -5.420  &lt;.0001\n PF - SF_intermediate           -34.691 6.95 702  -4.989  &lt;.0001\n PF - SF_advanced               -35.836 7.80 702  -4.595  &lt;.0001\n SF_early - SF_intermediate       2.992 6.95 702   0.430  0.8833\n SF_early - SF_advanced           1.847 7.80 702   0.237  0.8833\n SF_intermediate - SF_advanced   -1.145 7.80 702  -0.147  0.8833\n\nff_area = 60-70:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -42.493 6.95 702  -6.111  &lt;.0001\n PF - SF_intermediate           -27.344 6.95 702  -3.933  0.0002\n PF - SF_advanced               -36.964 7.80 702  -4.739  &lt;.0001\n SF_early - SF_intermediate      15.149 6.95 702   2.179  0.0445\n SF_early - SF_advanced           5.529 7.80 702   0.709  0.4786\n SF_intermediate - SF_advanced   -9.620 7.80 702  -1.233  0.2614\n\nff_area = 70-80:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -32.888 6.95 702  -4.730  &lt;.0001\n PF - SF_intermediate           -46.373 6.95 702  -6.669  &lt;.0001\n PF - SF_advanced               -32.197 7.80 702  -4.128  0.0001\n SF_early - SF_intermediate     -13.485 6.95 702  -1.939  0.0793\n SF_early - SF_advanced           0.691 7.80 702   0.089  0.9294\n SF_intermediate - SF_advanced   14.176 7.80 702   1.818  0.0835\n\nff_area = 80-90:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -38.717 7.14 702  -5.424  &lt;.0001\n PF - SF_intermediate           -28.779 6.95 702  -4.139  0.0001\n PF - SF_advanced               -31.457 7.80 702  -4.033  0.0001\n SF_early - SF_intermediate       9.938 7.14 702   1.392  0.2465\n SF_early - SF_advanced           7.260 7.97 702   0.911  0.4353\n SF_intermediate - SF_advanced   -2.678 7.80 702  -0.343  0.7314\n\nff_area = 90-100:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -36.562 7.63 702  -4.789  &lt;.0001\n PF - SF_intermediate            -7.240 6.95 702  -1.041  0.2981\n PF - SF_advanced                16.156 7.80 702   2.071  0.0464\n SF_early - SF_intermediate      29.322 7.63 702   3.841  0.0003\n SF_early - SF_advanced          52.718 8.43 702   6.252  &lt;.0001\n SF_intermediate - SF_advanced   23.396 7.80 702   3.000  0.0042\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_EBA &lt;- emmeans(model_EBA_evapo_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_EBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -14.2889 5.59 710  -2.556  0.0324\n PF - SF_intermediate           -14.3557 5.59 710  -2.568  0.0324\n PF - SF_advanced                -8.9664 6.27 710  -1.430  0.3065\n SF_early - SF_intermediate      -0.0668 5.59 710  -0.012  0.9905\n SF_early - SF_advanced           5.3224 6.27 710   0.849  0.4756\n SF_intermediate - SF_advanced    5.3892 6.27 710   0.859  0.4756\n\nff_area = 10-20:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -17.6808 5.59 710  -3.162  0.0098\n PF - SF_intermediate           -13.2070 5.59 710  -2.362  0.0553\n PF - SF_advanced                -7.8041 6.27 710  -1.244  0.3207\n SF_early - SF_intermediate       4.4739 5.59 710   0.800  0.4239\n SF_early - SF_advanced           9.8768 6.27 710   1.575  0.2315\n SF_intermediate - SF_advanced    5.4029 6.27 710   0.861  0.4239\n\nff_area = 20-30:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -20.8699 5.59 710  -3.733  0.0012\n PF - SF_intermediate           -17.0657 5.59 710  -3.052  0.0071\n PF - SF_advanced               -13.7665 6.27 710  -2.195  0.0570\n SF_early - SF_intermediate       3.8042 5.59 710   0.680  0.5958\n SF_early - SF_advanced           7.1033 6.27 710   1.133  0.3866\n SF_intermediate - SF_advanced    3.2991 6.27 710   0.526  0.5990\n\nff_area = 30-40:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -29.5766 5.59 710  -5.290  &lt;.0001\n PF - SF_intermediate           -23.4856 5.59 710  -4.201  0.0001\n PF - SF_advanced               -21.2858 6.27 710  -3.394  0.0015\n SF_early - SF_intermediate       6.0910 5.59 710   1.089  0.3316\n SF_early - SF_advanced           8.2907 6.27 710   1.322  0.2799\n SF_intermediate - SF_advanced    2.1998 6.27 710   0.351  0.7259\n\nff_area = 40-50:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -42.0496 5.59 710  -7.521  &lt;.0001\n PF - SF_intermediate           -38.7869 5.59 710  -6.937  &lt;.0001\n PF - SF_advanced               -33.9783 6.27 710  -5.418  &lt;.0001\n SF_early - SF_intermediate       3.2627 5.59 710   0.584  0.5597\n SF_early - SF_advanced           8.0713 6.27 710   1.287  0.2978\n SF_intermediate - SF_advanced    4.8086 6.27 710   0.767  0.5322\n\nff_area = 50-60:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -64.0210 5.59 710 -11.451  &lt;.0001\n PF - SF_intermediate           -58.9236 5.59 710 -10.539  &lt;.0001\n PF - SF_advanced               -55.5342 6.27 710  -8.855  &lt;.0001\n SF_early - SF_intermediate       5.0974 5.59 710   0.912  0.4347\n SF_early - SF_advanced           8.4867 6.27 710   1.353  0.2646\n SF_intermediate - SF_advanced    3.3894 6.27 710   0.540  0.5891\n\nff_area = 60-70:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -79.9467 5.59 710 -14.299  &lt;.0001\n PF - SF_intermediate           -68.8807 5.59 710 -12.320  &lt;.0001\n PF - SF_advanced               -66.8260 6.27 710 -10.656  &lt;.0001\n SF_early - SF_intermediate      11.0660 5.59 710   1.979  0.0578\n SF_early - SF_advanced          13.1206 6.27 710   2.092  0.0552\n SF_intermediate - SF_advanced    2.0547 6.27 710   0.328  0.7433\n\nff_area = 70-80:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -97.5165 5.59 710 -17.442  &lt;.0001\n PF - SF_intermediate           -79.6913 5.59 710 -14.253  &lt;.0001\n PF - SF_advanced               -71.1829 6.27 710 -11.350  &lt;.0001\n SF_early - SF_intermediate      17.8251 5.59 710   3.188  0.0018\n SF_early - SF_advanced          26.3335 6.27 710   4.199  &lt;.0001\n SF_intermediate - SF_advanced    8.5084 6.27 710   1.357  0.1753\n\nff_area = 80-90:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                  -99.3482 5.59 710 -17.769  &lt;.0001\n PF - SF_intermediate           -96.2500 5.59 710 -17.215  &lt;.0001\n PF - SF_advanced               -74.1865 6.27 710 -11.829  &lt;.0001\n SF_early - SF_intermediate       3.0982 5.59 710   0.554  0.5797\n SF_early - SF_advanced          25.1617 6.27 710   4.012  0.0001\n SF_intermediate - SF_advanced   22.0635 6.27 710   3.518  0.0006\n\nff_area = 90-100:\n contrast                       estimate   SE  df t.ratio p.value\n PF - SF_early                 -120.6131 5.59 710 -21.573  &lt;.0001\n PF - SF_intermediate           -97.8259 5.59 710 -17.497  &lt;.0001\n PF - SF_advanced               -79.1335 6.27 710 -12.618  &lt;.0001\n SF_early - SF_intermediate      22.7872 5.59 710   4.076  0.0001\n SF_early - SF_advanced          41.4795 6.27 710   6.614  &lt;.0001\n SF_intermediate - SF_advanced   18.6924 6.27 710   2.981  0.0030\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_SBA &lt;- emmeans(model_SBA_evapo_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_SBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   13.961 7.81 710   1.788  0.1882\n PF - SF_intermediate            14.326 7.81 710   1.835  0.1882\n PF - SF_advanced                14.684 8.76 710   1.676  0.1882\n SF_early - SF_intermediate       0.365 7.81 710   0.047  0.9674\n SF_early - SF_advanced           0.724 8.76 710   0.083  0.9674\n SF_intermediate - SF_advanced    0.359 8.76 710   0.041  0.9674\n\nff_area = 10-20:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   -9.745 7.81 710  -1.248  0.4681\n PF - SF_intermediate            -3.572 7.81 710  -0.457  0.6475\n PF - SF_advanced                 6.861 8.76 710   0.783  0.5205\n SF_early - SF_intermediate       6.173 7.81 710   0.791  0.5205\n SF_early - SF_advanced          16.606 8.76 710   1.896  0.3503\n SF_intermediate - SF_advanced   10.433 8.76 710   1.191  0.4681\n\nff_area = 20-30:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   -9.094 7.81 710  -1.165  0.6729\n PF - SF_intermediate           -13.639 7.81 710  -1.747  0.4868\n PF - SF_advanced                -7.583 8.76 710  -0.866  0.6729\n SF_early - SF_intermediate      -4.545 7.81 710  -0.582  0.6729\n SF_early - SF_advanced           1.511 8.76 710   0.173  0.8631\n SF_intermediate - SF_advanced    6.056 8.76 710   0.691  0.6729\n\nff_area = 30-40:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                   -2.101 7.81 710  -0.269  0.7880\n PF - SF_intermediate           -12.919 7.81 710  -1.654  0.4991\n PF - SF_advanced                -8.812 8.76 710  -1.006  0.6295\n SF_early - SF_intermediate     -10.818 7.81 710  -1.385  0.4991\n SF_early - SF_advanced          -6.711 8.76 710  -0.766  0.6657\n SF_intermediate - SF_advanced    4.107 8.76 710   0.469  0.7672\n\nff_area = 40-50:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -15.183 7.81 710  -1.944  0.1045\n PF - SF_intermediate           -22.151 7.81 710  -2.837  0.0281\n PF - SF_advanced               -19.191 8.76 710  -2.191  0.0863\n SF_early - SF_intermediate      -6.968 7.81 710  -0.892  0.5588\n SF_early - SF_advanced          -4.008 8.76 710  -0.458  0.7355\n SF_intermediate - SF_advanced    2.960 8.76 710   0.338  0.7355\n\nff_area = 50-60:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -19.399 7.81 710  -2.484  0.0198\n PF - SF_intermediate           -42.412 7.81 710  -5.431  &lt;.0001\n PF - SF_advanced               -36.098 8.76 710  -4.121  0.0001\n SF_early - SF_intermediate     -23.013 7.81 710  -2.947  0.0066\n SF_early - SF_advanced         -16.699 8.76 710  -1.906  0.0684\n SF_intermediate - SF_advanced    6.314 8.76 710   0.721  0.4712\n\nff_area = 60-70:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -18.109 7.81 710  -2.319  0.0310\n PF - SF_intermediate           -36.696 7.81 710  -4.699  &lt;.0001\n PF - SF_advanced               -25.248 8.76 710  -2.882  0.0122\n SF_early - SF_intermediate     -18.587 7.81 710  -2.380  0.0310\n SF_early - SF_advanced          -7.138 8.76 710  -0.815  0.4154\n SF_intermediate - SF_advanced   11.448 8.76 710   1.307  0.2300\n\nff_area = 70-80:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -15.933 7.81 710  -2.040  0.0834\n PF - SF_intermediate           -25.989 7.81 710  -3.328  0.0055\n PF - SF_advanced               -22.314 8.76 710  -2.548  0.0332\n SF_early - SF_intermediate     -10.056 7.81 710  -1.288  0.2973\n SF_early - SF_advanced          -6.381 8.76 710  -0.729  0.5598\n SF_intermediate - SF_advanced    3.675 8.76 710   0.420  0.6749\n\nff_area = 80-90:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                  -13.190 7.81 710  -1.689  0.1611\n PF - SF_intermediate           -25.778 7.81 710  -3.301  0.0061\n PF - SF_advanced                -4.639 8.76 710  -0.530  0.5965\n SF_early - SF_intermediate     -12.588 7.81 710  -1.612  0.1611\n SF_early - SF_advanced           8.551 8.76 710   0.976  0.3951\n SF_intermediate - SF_advanced   21.139 8.76 710   2.413  0.0482\n\nff_area = 90-100:\n contrast                      estimate   SE  df t.ratio p.value\n PF - SF_early                    0.225 7.81 710   0.029  0.9771\n PF - SF_intermediate           -31.358 7.81 710  -4.016  0.0002\n PF - SF_advanced                -8.065 8.76 710  -0.921  0.4290\n SF_early - SF_intermediate     -31.583 7.81 710  -4.045  0.0002\n SF_early - SF_advanced          -8.289 8.76 710  -0.946  0.4290\n SF_intermediate - SF_advanced   23.294 8.76 710   2.659  0.0160\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\n\n\nHeterocedasticidade\n\n# Função: resíduos normalizados vs n_obs, com controle de eixos\nplot_resid_hetero &lt;- function(m_lme, dat, region_name,\n                              show_x_lab = TRUE,\n                              show_y_lab = TRUE) {\n  rn &lt;- residuals(m_lme, type = \"response\")\n  ggplot(data.frame(n_obs = dat$n_obs, rnorm = rn),\n         aes(n_obs, rnorm)) +\n    geom_point(alpha = .35) +\n    geom_smooth(method = \"loess\", se = FALSE) +\n    geom_hline(yintercept = 0, lty = 2, col = \"grey40\") +\n    scale_x_log10() +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(hjust = 0.5)  \n    ) +\n    labs(\n      #title = region_name,\n      #x = if (show_x_lab) expression(n[obs]~\"(log scale)\") else NULL,  \n      x = if (show_x_lab) \"\" else NULL,\n      y = if (show_y_lab) \"Residuals\" else NULL             \n    )\n}\n\n# Monta cada painel com as regras pedidas:\n# - CBA: só Y\np_het_cba &lt;- plot_resid_hetero(model_CBA_evapo_w1, model_cba_evapo, \"CBA\",\n                               show_x_lab = FALSE, show_y_lab = TRUE)\n\n# - EBA: só X\np_het_eba &lt;- plot_resid_hetero(model_EBA_evapo_w1, model_eba_evapo, \"EBA\",\n                               show_x_lab = TRUE, show_y_lab = FALSE)\n\n# - SBA: sem X e sem Y\np_het_sba &lt;- plot_resid_hetero(model_SBA_evapo_w1, model_sba_evapo, \"SBA\",\n                               show_x_lab = FALSE, show_y_lab = FALSE)\n\n# Painel 1x3\npainel_het_evapo &lt;- ggpubr::ggarrange(p_het_cba, p_het_eba, p_het_sba,\n                                     ncol = 3, nrow = 1, align = \"hv\")\n\npainel_het_evapo\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/hetero_residuals_lme_evapo.png\", width=8, height=6, dpi=400, bg=\"white\")\n\n\n\nQQ PLOT\n\nqq_lme &lt;- function(m, region_name, show_y_title = FALSE){\n  rn &lt;- residuals(m, type = \"response\")\n  ggplot(data.frame(rn=rn), aes(sample = rn)) +\n    stat_qq() + stat_qq_line() +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(size = 12, face = \"bold\", hjust = 0.5), # &lt;- aqui\n      axis.title.y = if (show_y_title) element_text() else element_blank()\n    ) +\n    labs(title = region_name, x = \"\", y = if (show_y_title) \"Sample quantiles\" else NULL)\n}\n\n# y apenas no primeiro \nqq_cba &lt;- qq_lme(model_CBA_evapo_w1, \"\", show_y_title = TRUE)\nqq_eba &lt;- qq_lme(model_EBA_evapo_w1, \"\", show_y_title = FALSE)\nqq_sba &lt;- qq_lme(model_SBA_evapo_w1, \"\", show_y_title = FALSE)\n\npainel_qq_evapo &lt;- ggarrange(qq_cba, qq_eba, qq_sba, ncol = 3, nrow = 1, align = \"hv\")\n\npainel_qq_evapo\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/qqplot_evapo.png\", bg = \"white\",\n       dpi = 600, width = 8, height = 6)\n\n\n\n\nCCC de Lins\n\n## CBA\n\n# Obter os valores observados e previstos\nobservado_cba_evapo &lt;- model_cba_evapo$Evapo\nprevisto_cba_evapo  &lt;- predict(model_CBA_evapo_w1)\n\nccc_result_cba_evapo  &lt;- CCC(observado_cba_evapo , previsto_cba_evapo )\nccc_val_cba_evapo &lt;- round(ccc_result_cba_evapo$rho.c[, \"est\"], 3)\n\n\n## EBA\n\n# Obter os valores observados e previstos\nobservado_eba_evapo &lt;- model_eba_evapo$Evapo\nprevisto_eba_evapo  &lt;- predict(model_EBA_evapo_w1)\n\nccc_result_eba_evapo  &lt;- CCC(observado_eba_evapo , previsto_eba_evapo )\nccc_val_eba_evapo &lt;- round(ccc_result_eba_evapo$rho.c[, \"est\"], 3)\n\n## SBA\n\n# Obter os valores observados e previstos\nobservado_sba_evapo &lt;- model_sba_evapo$Evapo\nprevisto_sba_evapo  &lt;- predict(model_SBA_evapo_w1)\n\nccc_result_sba_evapo  &lt;- CCC(observado_sba_evapo , previsto_sba_evapo )\nccc_val_sba_evapo &lt;- round(ccc_result_sba_evapo$rho.c[, \"est\"], 3)\n\n\n\nEfeitos para cada ff_area e classe florestal\n\n# Intervalos p/ plot “em_all”\nem_df_cba &lt;- as.data.frame(emm_CBA); em_df_cba$region &lt;- \"CBA\"\nem_df_eba &lt;- as.data.frame(emm_EBA); em_df_eba$region &lt;- \"EBA\"\nem_df_sba &lt;- as.data.frame(emm_SBA); em_df_sba$region &lt;- \"SBA\"\n\nem_all &lt;- bind_rows(em_df_cba, em_df_eba, em_df_sba) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    Tipo    = factor(Tipo,    levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  )\n\n# Comparações dentro de cada faixa (matriz / pwpm)\nem_cba_pw &lt;- emmeans(model_CBA_evapo_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_eba_pw &lt;- emmeans(model_EBA_evapo_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_sba_pw &lt;- emmeans(model_SBA_evapo_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\n\npwpm(em_cba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                      PF SF_early SF_intermediate SF_advanced\nPF                [1331]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -102.043   [1433]          0.9995      0.8557\nSF_intermediate -101.280    0.763          [1432]      0.8973\nSF_advanced      -95.824    6.219           5.456      [1427]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1382]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -72.89   [1455]          0.9191      0.5130\nSF_intermediate -68.44     4.45          [1451]      0.8505\nSF_advanced     -62.13    10.75            6.31      [1444]\n\nff_area = 20-30\n                     PF SF_early SF_intermediate SF_advanced\nPF               [1412]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -51.241   [1463]          0.9994      0.9741\nSF_intermediate -50.415    0.826          [1462]      0.9887\nSF_advanced     -47.920    3.321           2.495      [1460]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1432]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -46.60   [1478]          0.9463      0.7568\nSF_intermediate -42.76     3.83          [1475]      0.9600\nSF_advanced     -38.90     7.70            3.87      [1471]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1443]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -41.80   [1485]          0.9918      0.7428\nSF_intermediate -43.79    -1.99          [1487]      0.5845\nSF_advanced     -33.91     7.89            9.88      [1477]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1452]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -37.68   [1490]          0.9733      0.9953\nSF_intermediate -34.69     2.99          [1487]      0.9989\nSF_advanced     -35.84     1.85           -1.15      [1488]\n\nff_area = 60-70\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1458]   &lt;.0001          0.0005      &lt;.0001\nSF_early        -42.49   [1500]          0.1301      0.8936\nSF_intermediate -27.34    15.15          [1485]      0.6057\nSF_advanced     -36.96     5.53           -9.62      [1495]\n\nff_area = 70-80\n                     PF SF_early SF_intermediate SF_advanced\nPF               [1462]   &lt;.0001          &lt;.0001      0.0002\nSF_early        -32.888   [1495]          0.2125      0.9998\nSF_intermediate -46.373  -13.485          [1509]      0.2658\nSF_advanced     -32.197    0.691          14.176      [1495]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1466]   &lt;.0001          0.0002      0.0004\nSF_early        -38.72   [1504]          0.5047      0.7991\nSF_intermediate -28.78     9.94          [1495]      0.9861\nSF_advanced     -31.46     7.26           -2.68      [1497]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1484]   &lt;.0001          0.7252      0.1635\nSF_early        -36.56   [1520]          0.0008      &lt;.0001\nSF_intermediate  -7.24    29.32          [1491]      0.0148\nSF_advanced      16.16    52.72           23.40      [1468]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_eba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                      PF SF_early SF_intermediate SF_advanced\nPF                [1452]   0.0526          0.0510      0.4811\nSF_early        -14.2889   [1466]          1.0000      0.8311\nSF_intermediate -14.3557  -0.0668          [1466]      0.8258\nSF_advanced      -8.9664   5.3224          5.3892      [1461]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1485]   0.0088          0.0855      0.5988\nSF_early        -17.68   [1503]          0.8543      0.3937\nSF_intermediate -13.21     4.47          [1499]      0.8247\nSF_advanced      -7.80     9.88            5.40      [1493]\n\nff_area = 20-30\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1507]   0.0012          0.0126      0.1255\nSF_early         -20.9   [1528]          0.9045      0.6694\nSF_intermediate  -17.1      3.8          [1524]      0.9528\nSF_advanced      -13.8      7.1             3.3      [1521]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1521]   &lt;.0001          0.0002      0.0040\nSF_early        -29.58   [1550]          0.6961      0.5492\nSF_intermediate -23.49     6.09          [1544]      0.9852\nSF_advanced     -21.29     8.29            2.20      [1542]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1523]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -42.05   [1565]          0.9370      0.5715\nSF_intermediate -38.79     3.26          [1562]      0.8694\nSF_advanced     -33.98     8.07            4.81      [1557]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1518]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -64.02   [1582]          0.7986      0.5293\nSF_intermediate -58.92     5.10          [1577]      0.9491\nSF_advanced     -55.53     8.49            3.39      [1574]\n\nff_area = 60-70\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1523]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -79.95   [1603]          0.1968      0.1566\nSF_intermediate -68.88    11.07          [1592]      0.9879\nSF_advanced     -66.83    13.12            2.05      [1590]\n\nff_area = 70-80\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1525]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -97.52   [1623]          0.0081      0.0002\nSF_intermediate -79.69    17.83          [1605]      0.5271\nSF_advanced     -71.18    26.33            8.51      [1597]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1527]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early         -99.3   [1626]          0.9454      0.0004\nSF_intermediate  -96.3      3.1          [1623]      0.0026\nSF_advanced      -74.2     25.2            22.1      [1601]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1529]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -120.6   [1650]          0.0003      &lt;.0001\nSF_intermediate  -97.8     22.8          [1627]      0.0157\nSF_advanced      -79.1     41.5            18.7      [1609]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_sba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1334]   0.2800          0.2579      0.3369\nSF_early        13.961   [1320]          1.0000      0.9998\nSF_intermediate 14.326    0.365          [1320]      1.0000\nSF_advanced     14.684    0.724           0.359      [1320]\n\nff_area = 10-20\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1360]   0.5964          0.9682      0.8621\nSF_early         -9.75   [1370]          0.8587      0.2307\nSF_intermediate  -3.57     6.17          [1364]      0.6327\nSF_advanced       6.86    16.61           10.43      [1354]\n\nff_area = 20-30\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1379]   0.6494          0.3004      0.8226\nSF_early         -9.09   [1388]          0.9375      0.9982\nSF_intermediate -13.64    -4.55          [1393]      0.9004\nSF_advanced      -7.58     1.51            6.06      [1387]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1394]   0.9932          0.3488      0.7459\nSF_early         -2.10   [1396]          0.5089      0.8697\nSF_intermediate -12.92   -10.82          [1407]      0.9659\nSF_advanced      -8.81    -6.71            4.11      [1402]\n\nff_area = 40-50\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1396]   0.2105          0.0242      0.1267\nSF_early        -15.18   [1411]          0.8088      0.9681\nSF_intermediate -22.15    -6.97          [1418]      0.9867\nSF_advanced     -19.19    -4.01            2.96      [1415]\n\nff_area = 50-60\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1395]   0.0632          &lt;.0001      0.0002\nSF_early        -19.40   [1414]          0.0174      0.2262\nSF_intermediate -42.41   -23.01          [1437]      0.8888\nSF_advanced     -36.10   -16.70            6.31      [1431]\n\nff_area = 60-70\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1409]   0.0946          &lt;.0001      0.0211\nSF_early        -18.11   [1428]          0.0818      0.8474\nSF_intermediate -36.70   -18.59          [1446]      0.5587\nSF_advanced     -25.25    -7.14           11.45      [1435]\n\nff_area = 70-80\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1420]   0.1742          0.0051      0.0537\nSF_early        -15.93   [1436]          0.5710      0.8857\nSF_intermediate -25.99   -10.06          [1446]      0.9751\nSF_advanced     -22.31    -6.38            3.67      [1442]\n\nff_area = 80-90\n                    PF SF_early SF_intermediate SF_advanced\nPF              [1430]   0.3301          0.0056      0.9519\nSF_early        -13.19   [1443]          0.3724      0.7631\nSF_intermediate -25.78   -12.59          [1455]      0.0755\nSF_advanced      -4.64     8.55           21.14      [1434]\n\nff_area = 90-100\n                     PF SF_early SF_intermediate SF_advanced\nPF               [1445]   1.0000          0.0004      0.7938\nSF_early          0.225   [1445]          0.0003      0.7798\nSF_intermediate -31.358  -31.583          [1476]      0.0399\nSF_advanced      -8.065   -8.289          23.294      [1453]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\n# Exportar matriz como data.frame\npw_cba_df &lt;- as.data.frame(pwpm(em_cba_pw, sort = FALSE))\npw_eba_df &lt;- as.data.frame(pwpm(em_eba_pw, sort = FALSE))\npw_sba_df &lt;- as.data.frame(pwpm(em_sba_pw, sort = FALSE))\npw_df &lt;- bind_rows(pw_cba_df, pw_eba_df, pw_sba_df)\n\nopenxlsx::write.xlsx(pw_df, file = \"data_group/matriz_contrastes_pwpm_evapo.xlsx\", rowNames = TRUE)\n\n# Tabela final - análises\ntabela_estilo_fig1 &lt;- em_all %&gt;%\n  mutate(\n    Tipo = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  ) %&gt;%\n  rename(\n    Region   = region,\n    Cover    = Tipo,\n    Effect   = emmean,\n    Interval = ff_area,\n    CI_lower = lower.CL,\n    CI_upper = upper.CL\n  ) %&gt;%\n  mutate(\n    Variable = \"EVAPO\",\n    Cover = factor(Cover, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(Interval, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\n                                           \"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\"))\n  ) %&gt;%\n  arrange(Region, Cover, Interval) %&gt;%\n  dplyr::select(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)\n\nopenxlsx::write.xlsx(\n  tabela_estilo_fig1,\n  file = \"data_group/emmeans_intervalos_evapo.xlsx\",\n  rowNames = FALSE\n)\n\n# Tabela final - SI\n\n# Preparar tabela base\nt2 &lt;- em_all %&gt;%\n  mutate(\n    Cover = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                          \"40-50\",\"50-60\",\"60-70\",\"70-80\",\n                                          \"80-90\",\"90-100\"))\n  ) %&gt;%\n  dplyr::select(region, Interval, Cover,\n         Effect = emmean,\n         CI_lower = lower.CL,\n         CI_upper = upper.CL)\n\n# Reorganizar para formato largo (larger table like Figure 2)\ntabela_fig2 &lt;- t2 %&gt;%\n  arrange(Interval, Cover) %&gt;%\n  tidyr::pivot_wider(\n    names_from = region,\n    values_from = c(Effect, CI_lower, CI_upper),\n    names_glue = \"{region}_{.value}\"\n  ) %&gt;%\n  arrange(Interval, Cover)\n\nopenxlsx::write.xlsx(\n  tabela_fig2,\n  file = \"data_group/emmeans_intervalos_evapo_table_final.xlsx\",\n  rowNames = FALSE\n)\n\n\n\nConstrastes e significancia\n\nget_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area*Tipo, lmer.df = \"satterthwaite\")\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", by = \"ff_area\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  df\n}\n\ncontrast_CBA_df &lt;- get_contrasts(model_CBA_evapo_w1, \"CBA\")\ncontrast_EBA_df &lt;- get_contrasts(model_EBA_evapo_w1, \"EBA\")\ncontrast_SBA_df &lt;- get_contrasts(model_SBA_evapo_w1, \"SBA\")\n\nall_contrasts &lt;- bind_rows(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) %&gt;%\n  filter(grepl(\"PF\", contrast) & grepl(\"SF_\", contrast)) %&gt;%\n  tidyr::separate(contrast, into = c(\"tipo1\", \"tipo2\"), sep = \" - \") %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")) |\n         (tipo2 == \"PF\" & tipo1 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    tipo_sf = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF − SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nwritexl::write_xlsx(all_contrasts, \"data_group/contrast_PF_SF_evapo.xlsx\")\n\n\n\n\nPainel Evapo\n\n# Plot de pontos\nplot_point_evapo &lt;- function(region_name, show_y = TRUE, show_legend = FALSE, show_y_axes = TRUE) {\n  p &lt;- ggplot(filter(em_all, region == region_name) %&gt;%\n    mutate(\n      Tipo = factor(Tipo) %&gt;%\n        fct_relevel(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\") %&gt;%\n        fct_recode(\n          \"PF\" = \"PF\",\n          \"SF early\" = \"SF_early\",\n          \"SF intermediate\" = \"SF_intermediate\",\n          \"SF advanced\" = \"SF_advanced\"\n        )\n    ),\n    aes(x = ff_area, y = emmean, color = Tipo, group = Tipo)) +\n    geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),\n                  position = position_dodge(width = 0.8), width = 0.6, size = 0.5) +\n    geom_point(position = position_dodge(width = 0.8), size = 1.5) +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_blank(),\n      legend.background = element_rect(fill = \"transparent\"),\n      legend.text = element_text(size = 10),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      axis.text.x = element_blank(),\n      #axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),\n      axis.text.y = if (show_y_axes) element_text(size = 10) else element_blank(),\n      axis.title.y = if (show_y) element_text(size = 14, margin = margin(r = -20)) else element_blank(),\n      axis.title.x = element_blank(),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    scale_color_manual(values = c(\"#02401B\", \"lightgreen\", \"green1\", \"green4\")) +\n    scale_y_continuous(limits = c(1200, 1700), breaks = seq(1200, 1700, by = 100)) +\n    #labs(y = if (show_y) \"Evapotranspiration\\nfixed effects (mm·yr⁻¹)\" else NULL) +\n    labs(y = if (show_y) expression(bold(atop(\"Estimated marginal mean\", \"evapotranspiration (mm·yr\"^{-1}*\")\"))) else NULL)\n  \n  return(p)\n}\n\n# Atualizar ordem dos fatores e renomear os labels\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")),\n    tipo_sf_label = fct_recode(tipo_sf,\n                               \"SF early\" = \"SF_early\",\n                               \"SF intermediate\" = \"SF_intermediate\",\n                               \"SF advanced\" = \"SF_advanced\")\n  )\n\n\n# Criar coluna categórica para estimate\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    estimate_cat = factor(\n      cut(estimate,\n          breaks = c(-Inf, -30, 0, Inf),\n          labels = c(\"&lt;−30\", \"−30 to 0\", \"&gt;0\")\n      ),\n      levels = c(\"&lt;−30\", \"−30 to 0\", \"&gt;0\")\n    )\n  )\n\n# Heatmap de contrastes\nplot_heat_evapo &lt;- function(region_name, show_legend = FALSE, show_y_labels = TRUE) {\n  ggplot(filter(all_contrasts, region == region_name), \n         aes(x = ff_area, y = tipo_sf_label, fill = estimate_cat)) +\n    geom_tile(color = \"white\", height = 0.7) +\n    geom_text(aes(label = sig_label), size = 3, color = \"black\", family = \"serif\") +\n    scale_fill_manual(\n      values = c(\"&lt;−30\" = \"#D6604D\", \"−30 to 0\" = \"#F4A582\", \"&gt;0\" = \"#92C5DE\"),\n      limits = c(\"&lt;−30\", \"−30 to 0\", \"&gt;0\"),\n      drop = FALSE,\n      name = bquote(bold(atop(Delta~\"ET (PF − SF)\", \"(mm)\")))\n    )+\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text.x = element_blank(),\n      axis.title = element_blank(),\n      axis.text.y = if (show_y_labels) element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\") else element_blank(),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_text(size = 10, face = \"bold\", family = \"serif\"),\n      legend.text = element_text(size = 10),\n      plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\", family = \"serif\"),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    labs(title = \"\")\n}\n\n# Combinar gráficos para cada região\npanel_CBA_evapo &lt;- plot_heat_evapo(\"CBA\", show_legend = FALSE, show_y_labels = TRUE) /\n             plot_point_evapo(\"CBA\", show_y = TRUE, show_legend = FALSE, show_y_axes = TRUE)\npanel_CBA_evapo &lt;- panel_CBA_evapo + plot_layout(heights = c(0.2, 0.8))\n\npanel_EBA_evapo &lt;- plot_heat_evapo(\"EBA\", show_legend = FALSE, show_y_labels = FALSE) /\n             plot_point_evapo(\"EBA\", show_y = FALSE, show_legend = FALSE, show_y_axes = FALSE)\npanel_EBA_evapo &lt;- panel_EBA_evapo + plot_layout(heights = c(0.2, 0.8))\n\npanel_SBA_evapo &lt;- plot_heat_evapo(\"SBA\", show_legend = TRUE, show_y_labels = FALSE) /\n             plot_point_evapo(\"SBA\", show_y = FALSE, show_legend = TRUE, show_y_axes = FALSE)\npanel_SBA_evapo &lt;- panel_SBA_evapo + plot_layout(heights = c(0.2, 0.8))\n\n# Combinar todos os painéis horizontalmente\nfinal_panel_evapo &lt;- (panel_CBA_evapo | panel_EBA_evapo | panel_SBA_evapo)\n\n# Exibir painel final\nfinal_panel_evapo\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/em_fixed_fixed_evapo.png\",\n       plot = final_panel_evapo,\n       bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 4764923 254.5    7437491 397.3  7437491 397.3\nVcells 9081597  69.3   17824054 136.0 14786674 112.9\n\n\n\nTodos os constraste entre frações de área\n\n# Lista de modelos\nmodelos &lt;- list(CBA = model_CBA_evapo_w1, EBA = model_EBA_evapo_w1, SBA = model_SBA_evapo_w1)\n\n# Função para gerar todos os contrastes PF - SF\nget_all_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area * Tipo)\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  return(df)\n}\n\n# Aplicar para todas as regiões\nall_contrasts_sup &lt;- purrr::map2_dfr(modelos, names(modelos), get_all_contrasts)\n\nstr(all_contrasts_sup)\n\nClasses 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:\n $ contrast: chr  \"(10-20 PF) - (1-10 PF)\" \"(20-30 PF) - (1-10 PF)\" \"(20-30 PF) - (10-20 PF)\" \"(30-40 PF) - (1-10 PF)\" ...\n $ estimate: num  51.3 81.2 29.9 101 49.7 ...\n $ SE      : num  6.95 6.95 6.95 6.95 6.95 ...\n $ df      : num  702 702 702 702 702 ...\n $ t.ratio : num  7.37 11.68 4.31 14.52 7.15 ...\n $ p.value : num  2.12e-12 7.77e-28 4.17e-05 8.72e-41 8.80e-12 ...\n $ region  : chr  \"CBA\" \"CBA\" \"CBA\" \"CBA\" ...\n - attr(*, \"estName\")= chr \"estimate\"\n - attr(*, \"pri.vars\")= chr \"contrast\"\n - attr(*, \"adjust\")= chr \"fdr\"\n - attr(*, \"side\")= num 0\n - attr(*, \"delta\")= num 0\n - attr(*, \"type\")= chr \"link\"\n - attr(*, \"mesg\")= chr [1:2] \"Degrees-of-freedom method: kenward-roger\" \"P value adjustment: fdr method for 780 tests\"\n - attr(*, \"digits\")= int 7\n\n# Extrair contrastes entre PF e SF\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  filter(str_detect(contrast, \"PF\") & str_detect(contrast, \"SF_\"))\n\n# Extrair informações usando regex\n# Regex para capturar (faixa tipo) - (faixa tipo)\nextr &lt;- str_match(all_contrasts_sup$contrast,\n                  \"\\\\(([^ ]+) ([^)]+)\\\\) - \\\\(([^ ]+) ([^)]+)\\\\)\")\n\n# Adicionar colunas extraídas\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa1 = extr[, 2],\n    tipo1 = extr[, 3],\n    faixa2 = extr[, 4],\n    tipo2 = extr[, 5]\n  ) %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% sf_levels) | (tipo2 == \"PF\" & tipo1 %in% sf_levels)) %&gt;%\n  mutate(\n    faixa_PF = if_else(tipo1 == \"PF\", faixa1, faixa2),\n    faixa_SF = if_else(tipo1 == \"PF\", faixa2, faixa1),\n    tipo_SF  = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF - SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\n# Ajustar fatores\nfaixas_niveis &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\",\n                   \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa_PF = factor(faixa_PF, levels = faixas_niveis),\n    faixa_SF = factor(faixa_SF, levels = faixas_niveis),\n    tipo_SF  = factor(tipo_SF,  levels = sf_levels)\n  )\n\n\n# Classificação mantendo sinal\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    tipo_SF = fct_recode(tipo_SF,\n                         \"SF early\" = \"SF_early\",\n                         \"SF intermediate\" = \"SF_intermediate\",\n                         \"SF advanced\" = \"SF_advanced\")\n  ) %&gt;% \n  mutate(\n    estimate_class = case_when(\n      estimate &lt; -100 ~ \"&lt;-100\",\n      estimate &gt;= -100 & estimate &lt; 0 ~ \"-100–0\",\n      estimate &gt;= 0 & estimate &lt; 100 ~ \"0–100\",\n      estimate &gt;= 100 ~ \"&gt;100\"\n    ),\n    estimate_class = factor(estimate_class, levels = c(\"&lt;-100\", \"-100–0\", \"0–100\", \"&gt;100\"))\n  )\n\n\n# Plot\nheatmap_all_contrasts &lt;- ggplot(all_contrasts_sup, \n                        aes(x = faixa_SF, y = faixa_PF, fill = estimate_class)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = sig_label), color = \"black\", size = 3, family = \"serif\") +\n  scale_fill_manual(values = c(\n  \"&lt;-100\" = \"#D6604D\",\n  \"-100–0\" = \"#F4A582\",\n  \"0–100\" = \"#92C5DE\",\n  \"&gt;100\" = \"#4393C3\"\n), name = expression(bold(atop(Delta~\"ET (PF - SF)\", \"(mm·yr\"^{-1}*\")\"))))+\n  facet_grid(tipo_SF ~ region) +\n  theme_minimal(base_family = \"serif\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(size = 12, face = \"bold\"),\n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\")\n  ) +\n   labs(x = \"SF fractional cover (%)\",\n        y = \"PF fractional cover (%)\")\n\nheatmap_all_contrasts\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_evapo.png\", width = 10, height = 8, dpi = 600, bg = \"white\")\n\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_evapo.pdf\", width = 10, height = 8, bg = \"white\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 4746514 253.5    7437491 397.3  7437491 397.3\nVcells 9053017  69.1   17824054 136.0 17824054 136.0\n\n\n\n\n\nRandom effect\n\n# Função para extrair efeitos aleatórios com IC por região\nextract_random_effects &lt;- function(model, region_name) {\n  # Efeitos aleatórios com variância condicional\n  ran &lt;- ranef(model, condVar = TRUE)\n  \n  # Extrair efeitos por ano\n  ran_df &lt;- as.data.frame(ran$Ano)\n  names(ran_df) &lt;- \"effect\"\n  ran_df$ano &lt;- rownames(ran$Ano)\n  \n  # Intervalos de confiança (erro padrão)\n  se &lt;- attr(ran$Ano, \"postVar\")[1, 1, ] |&gt; sqrt()\n  \n  ran_df &lt;- ran_df %&gt;%\n    mutate(\n      se = se,\n      lower = effect - 1.96 * se,\n      upper = effect + 1.96 * se,\n      region = region_name\n    )\n  \n  return(ran_df)\n}\n\n# Aplicar para os três modelos (substitua pelos seus objetos reais)\nrandom_cba &lt;- extract_random_effects(model_CBA_evapo_w1, \"CBA\")\nrandom_eba &lt;- extract_random_effects(model_EBA_evapo_w1, \"EBA\")\nrandom_sba &lt;- extract_random_effects(model_SBA_evapo_w1, \"SBA\")\n\n# Combinar tudo\nrandom_all &lt;- bind_rows(random_cba, random_eba, random_sba)\n\n# Garantir que o ano seja ordenável\nrandom_all$ano &lt;- as.numeric(as.character(random_all$ano))\n\n# Salvar\nwrite_xlsx(random_all, \"data_group/random_effects_evapo.xlsx\")\n\n\nPlot\n\n# Plot\np1_rand_evapo &lt;- ggplot(random_all, aes(x = ano, y = effect)) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray40\") +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha = 0.8, fill = \"green1\") +\n  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.5, color = \"black\") +\n  facet_wrap(~region, scales = \"free_x\") +\n  scale_x_continuous(breaks = seq(2001, 2021, by = 2)) + \n  ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      #axis.text.x = element_text(angle = 45, hjust = 1),\n      axis.text.x = element_blank(),\n      axis.title = element_text(size = 14),\n      #strip.text = element_text(face = \"bold\", size = 13)) +\n      strip.text = element_blank()) +\n  labs(\n    x = \"\",\n    y = expression(bold(atop(\"Evapotranspiration\", \"random effects (mm·yr\"^{-1}*\")\")))\n  )\n\np1_rand_evapo\n\n\n\n\n\n\n\nggsave(\"fig/histogram_random_evapo.png\", bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\n\n\n\nPredicted\n\nPlot\n\nmodel_cba_evapo$predicted &lt;- predict(model_CBA_evapo_w1, model_cba_evapo)\nmodel_eba_evapo$predicted &lt;- predict(model_EBA_evapo_w1, model_eba_evapo)\nmodel_sba_evapo$predicted &lt;- predict(model_SBA_evapo_w1, model_sba_evapo)\n\nr2_cba_evapo_lab &lt;- r2_lmer_w(model_CBA_evapo_w1, model_cba_evapo, type = \"cond\")\nr2_eba_evapo_lab &lt;- r2_lmer_w(model_EBA_evapo_w1, model_eba_evapo, type = \"cond\")\nr2_sba_evapo_lab &lt;- r2_lmer_w(model_SBA_evapo_w1, model_sba_evapo, type = \"cond\")\n\n\nall_vals &lt;- c(model_cba_evapo$Evapo, model_cba_evapo$predicted,\n              model_eba_evapo$Evapo, model_eba_evapo$predicted,\n              model_sba_evapo$Evapo, model_sba_evapo$predicted)\n\nrng     &lt;- range(all_vals, na.rm = TRUE)\npad     &lt;- 0.02 * diff(rng)\nlim_min &lt;- floor((rng[1] - pad)  / 200) * 200\nlim_max &lt;- ceiling((rng[2] - pad)  / 200) * 200\nbrks    &lt;- seq(lim_min, lim_max, by = 200)\n\n# Função base do gráfico (escala 1:1 e linha 45°)\nmake_plot &lt;- function(dat, titulo, subtitulo){\n  ggplot(dat, aes(Evapo, predicted)) +\n    geom_point(size = 2, alpha = .7, na.rm = TRUE) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"orange\", na.rm = TRUE) +\n    geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"grey40\") +\n    scale_x_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +  \n    scale_y_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +\n    theme_minimal() +\n    labs(\n      x = \"Observed ET (mm·yr⁻¹)\",\n      y = \"Predicted ET (mm·yr⁻¹)\",  # mostra o eixo y em TODOS\n      title = titulo,\n      subtitle = subtitulo\n    )\n}\n\n\n\nPainel\n\n# Plots\ncba_pf &lt;- make_plot(model_cba_evapo, \"\", paste0(\"R² = \", round(r2_cba_evapo_lab, 3), \" | CCC = \", ccc_val_cba_evapo))\neba_pf &lt;- make_plot(model_eba_evapo, \"\", paste0(\"R² = \", round(r2_eba_evapo_lab, 3), \" | CCC = \", ccc_val_eba_evapo)) + labs(y = NULL)\nsba_pf &lt;- make_plot(model_sba_evapo, \"\", paste0(\"R² = \", round(r2_sba_evapo_lab, 3), \" | CCC = \", ccc_val_sba_evapo)) + labs(y = NULL)\n\n\n# Painel\np2_pred_evapo &lt;- (cba_pf + eba_pf + sba_pf) +\n  patchwork::plot_layout(ncol = 3, nrow = 1, guides = \"collect\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text  = element_text(size = 10, face = \"plain\", family = \"serif\"),\n    axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, family = \"serif\")\n  )\n\np2_pred_evapo\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_observed_evapo.png\", bg = \"white\", dpi = 600, width = 12, height = 5.5)\n\n\n\n\nModel plotting\n\nCBA\n\n# Atribuindo os dados\nmodel_cba_all_evapo &lt;- model_cba_evapo %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_CBA_evapo_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_cba_all_evapo &lt;- model_cba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\n\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_cba_all_evapo[model_cba_all_evapo$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_cba_all_evapo[model_cba_all_evapo$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_cba_all_evapo[model_cba_all_evapo$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_cba_all_evapo[model_cba_all_evapo$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_cba_all_evapo[model_cba_all_evapo$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_cba_all_evapo &lt;- model_cba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_evapo_cba &lt;- model_cba_all_evapo %&gt;%\n  ggplot(aes(x = area * 10, y = Evapo, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  scale_y_continuous(breaks = seq(1200, 1600, by = 100)) +\n  ggthemes::theme_few() +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted evapotranspiration (mm·yr⁻¹) - CBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_evapo_cba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_evapo_CBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nEBA\n\n# Atribuindo os dados\nmodel_eba_all_evapo &lt;- model_eba_evapo %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_EBA_evapo_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_eba_all_evapo &lt;- model_eba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_eba_all_evapo[model_eba_all_evapo$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_eba_all_evapo[model_eba_all_evapo$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_eba_all_evapo[model_eba_all_evapo$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_eba_all_evapo[model_eba_all_evapo$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_eba_all_evapo[model_eba_all_evapo$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_eba_all_evapo &lt;- model_eba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_evapo_eba &lt;- model_eba_all_evapo %&gt;%\n  ggplot(aes(x = area * 10, y = Evapo, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(1300, 1700, by = 100)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted evapotranspiration (mm·yr⁻¹) - EBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_evapo_eba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_evapo_EBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nSBA\n\n# Atribuindo os dados\nmodel_sba_all_evapo &lt;- model_sba_evapo %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_SBA_evapo_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_sba_all_evapo &lt;- model_sba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_sba_all_evapo[model_sba_all_evapo$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_sba_all_evapo[model_sba_all_evapo$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_sba_all_evapo[model_sba_all_evapo$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_sba_all_evapo[model_sba_all_evapo$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_sba_all_evapo[model_sba_all_evapo$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_sba_all_evapo &lt;- model_sba_all_evapo %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\nm1_evapo_sba &lt;- model_sba_all_evapo %&gt;%\n  ggplot(aes(x = area*10, y = Evapo))+\n  theme_bw()+\n  geom_point(aes(x = area*10, y = Evapo, color = vegetation)) + \n  geom_line(aes(y = predicted, group = vegetation, color = vegetation), size = 1)+\n    scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n    scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(1000, 1600, by = 150)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted evapotranspiration (mm·yr⁻¹) - SBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  # Tamanho do texto da legenda\n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_evapo_sba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_evapo_SBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#temperature",
    "href": "code_climate_forest_regeneration.html#temperature",
    "title": "Packages",
    "section": "TEMPERATURE",
    "text": "TEMPERATURE\n\nModel choice\n\n# Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área\nall_pf_sf_temp_model = read_xlsx(\"data_group/plan_data_group_temp.xlsx\")\n\n# Definindo a ordem correta das categorias\nord_ff   &lt;- c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")\nlev_tipo &lt;- c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")\n\n# Recodifica como fatores na ordem correta\nrecode_fac &lt;- function(d){\n  d %&gt;%\n    mutate(\n      ff_area = factor(ff_area, levels = ord_ff, ordered = TRUE),\n      Tipo    = factor(Tipo,    levels = lev_tipo)\n    )\n}\n\n# Separa por região e aplica a recodificação\nmodel_cba_temp &lt;- all_pf_sf_temp_model %&gt;% filter(region == \"CBA\") %&gt;% recode_fac()\nmodel_eba_temp &lt;- all_pf_sf_temp_model %&gt;% filter(region == \"EBA\") %&gt;% recode_fac()\nmodel_sba_temp &lt;- all_pf_sf_temp_model %&gt;% filter(region == \"SBA\") %&gt;% recode_fac()\n\n# Cria um identificador para cada estrato\nadd_estrato &lt;- function(d){\n  d$estrato_id &lt;- interaction(d$region, d$ff_area, d$Tipo, drop = TRUE)\n  d\n}\n\nmodel_cba_temp &lt;- add_estrato(model_cba_temp)\nmodel_eba_temp &lt;- add_estrato(model_eba_temp)\nmodel_sba_temp &lt;- add_estrato(model_sba_temp)\n\n\n\nFixed effect\n\n# CBA\nmodel_CBA_temp_w1 &lt;- lmer(Temp ~ ff_area*Tipo + (1|Ano),\n                          data = model_cba_temp)\n\n# EBA\nmodel_EBA_temp_w1 &lt;- lmer(Temp ~ ff_area*Tipo + (1|Ano),\n                          data = model_eba_temp)\n\n# SBA\nmodel_SBA_temp_w1 &lt;- lmer(Temp ~ ff_area*Tipo + (1|Ano),\n                          data = model_sba_temp)\n\n\n# Conferir coeficientes fixos rapidamente\nbroom.mixed::tidy(model_CBA_temp_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df   p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;\n 1 fixed  (Intercept) 25.5        0.0722   354.     20.5 2.66e- 40\n 2 fixed  ff_area.L   -0.873      0.0300   -29.1   702.  1.46e-122\n 3 fixed  ff_area.Q   -0.0319     0.0300    -1.06  702.  2.88e-  1\n 4 fixed  ff_area.C   -0.262      0.0300    -8.74  702.  1.76e- 17\n 5 fixed  ff_area^4   -0.0743     0.0300    -2.47  702.  1.36e-  2\n 6 fixed  ff_area^5   -0.0685     0.0300    -2.28  702.  2.29e-  2\n 7 fixed  ff_area^6   -0.0457     0.0300    -1.52  702.  1.29e-  1\n 8 fixed  ff_area^7   -0.0278     0.0300    -0.925 702.  3.55e-  1\n 9 fixed  ff_area^8   -0.00608    0.0300    -0.203 702.  8.40e-  1\n10 fixed  ff_area^9    0.00859    0.0300     0.286 702.  7.75e-  1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_EBA_temp_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df   p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;\n 1 fixed  (Intercept) 25.2        0.0706   357.     20.1 8.94e- 40\n 2 fixed  ff_area.L   -0.734      0.0162   -45.3   710.  1.58e-211\n 3 fixed  ff_area.Q   -0.336      0.0162   -20.7   710.  4.40e- 75\n 4 fixed  ff_area.C   -0.323      0.0162   -19.9   710.  1.47e- 70\n 5 fixed  ff_area^4   -0.0201     0.0162    -1.24  710.  2.16e-  1\n 6 fixed  ff_area^5   -0.0519     0.0162    -3.20  710.  1.45e-  3\n 7 fixed  ff_area^6   -0.0742     0.0162    -4.58  710.  5.60e-  6\n 8 fixed  ff_area^7   -0.0338     0.0162    -2.08  710.  3.75e-  2\n 9 fixed  ff_area^8    0.0179     0.0162     1.10  710.  2.71e-  1\n10 fixed  ff_area^9    0.00798    0.0162     0.492 710.  6.23e-  1\n# ℹ 30 more rows\n\nbroom.mixed::tidy(model_SBA_temp_w1, effects=\"fixed\")\n\n# A tibble: 40 × 7\n   effect term        estimate std.error statistic    df  p.value\n   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 fixed  (Intercept) 25.1        0.0807   311.     20.2 1.28e-38\n 2 fixed  ff_area.L   -0.427      0.0204   -20.9   710.  8.22e-76\n 3 fixed  ff_area.Q   -0.300      0.0204   -14.7   710.  1.17e-42\n 4 fixed  ff_area.C   -0.289      0.0204   -14.1   710.  4.28e-40\n 5 fixed  ff_area^4    0.00969    0.0204     0.474 710.  6.36e- 1\n 6 fixed  ff_area^5    0.0254     0.0204     1.24  710.  2.15e- 1\n 7 fixed  ff_area^6   -0.0931     0.0204    -4.55  710.  6.17e- 6\n 8 fixed  ff_area^7   -0.0538     0.0204    -2.63  710.  8.67e- 3\n 9 fixed  ff_area^8    0.0369     0.0204     1.81  710.  7.13e- 2\n10 fixed  ff_area^9    0.0209     0.0204     1.02  710.  3.07e- 1\n# ℹ 30 more rows\n\n\n\nR-square for Linear Mixed Model (LMM)\n\n# ---- Helpers coerentes com os pesos do ajuste ----\nweighted_mean &lt;- function(y, w) sum(w*y)/sum(w)\nr2_w_sse &lt;- function(y, yhat, w) {\n  sst &lt;- sum(w * (y - weighted_mean(y, w))^2)\n  ssr &lt;- sum(w * (y - yhat)^2)\n  1 - ssr/sst\n}\n\n# R² ponderado \"marginal\" (fixos) e \"condicional\" (fixos + RE)  \nr2_lmer_w &lt;- function(m, dat, resp = \"Temp\", type = c(\"marg\",\"cond\")) {\n  type &lt;- match.arg(type)\n  w &lt;- as.numeric(weights(m))            \n  y &lt;- dat[[resp]]\n  yhat &lt;- if (type == \"marg\") predict(m, re.form = ~0) else predict(m, re.form = NULL)\n  r2_w_sse(y, yhat, w)\n}\n\n# Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))\nr2_cba_temp &lt;- c(\n  R2_marg_w = r2_lmer_w(model_CBA_temp_w1, model_cba_temp, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_CBA_temp_w1, model_cba_temp, type=\"cond\")\n)\nr2_eba_temp &lt;- c(\n  R2_marg_w = r2_lmer_w(model_EBA_temp_w1, model_eba_temp, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_EBA_temp_w1, model_eba_temp, type=\"cond\")\n)\nr2_sba_temp &lt;- c(\n  R2_marg_w = r2_lmer_w(model_SBA_temp_w1, model_sba_temp, type=\"marg\"),\n  R2_cond_w = r2_lmer_w(model_SBA_temp_w1, model_sba_temp, type=\"cond\")\n)\n\nr2_cba_temp; r2_eba_temp; r2_sba_temp\n\nR2_marg_w R2_cond_w \n0.2971607 0.8997172 \n\n\nR2_marg_w R2_cond_w \n0.4254513 0.9714580 \n\n\nR2_marg_w R2_cond_w \n0.4489102 0.9670093 \n\n# Exportar (opcional)\nr2_tbl &lt;- tibble::tibble(\n  region = c(\"CBA\",\"EBA\",\"SBA\"),\n  R2_marg_w = c(r2_cba_temp[\"R2_marg_w\"], r2_eba_temp[\"R2_marg_w\"], r2_sba_temp[\"R2_marg_w\"]),\n  R2_cond_w = c(r2_cba_temp[\"R2_cond_w\"], r2_eba_temp[\"R2_cond_w\"], r2_sba_temp[\"R2_cond_w\"])\n)\nwritexl::write_xlsx(r2_tbl, \"data_group/r2_weighted_temp.xlsx\")\n\n\n# Ajuste múltiplo BH para comparações por faixa.\nemm_CBA &lt;- emmeans(model_CBA_temp_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_CBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.160894 0.0425 702   3.787  0.0005\n PF - SF_intermediate           0.198618 0.0425 702   4.675  &lt;.0001\n PF - SF_advanced               0.166996 0.0477 702   3.504  0.0010\n SF_early - SF_intermediate     0.037724 0.0425 702   0.888  0.5623\n SF_early - SF_advanced         0.006102 0.0477 702   0.128  0.8981\n SF_intermediate - SF_advanced -0.031622 0.0477 702  -0.664  0.6086\n\nff_area = 10-20:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.000911 0.0425 702   0.021  0.9829\n PF - SF_intermediate          -0.043123 0.0425 702  -1.015  0.3725\n PF - SF_advanced              -0.114637 0.0477 702  -2.405  0.0492\n SF_early - SF_intermediate    -0.044034 0.0425 702  -1.037  0.3725\n SF_early - SF_advanced        -0.115547 0.0477 702  -2.425  0.0492\n SF_intermediate - SF_advanced -0.071513 0.0477 702  -1.501  0.2678\n\nff_area = 20-30:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.101295 0.0425 702  -2.384  0.0261\n PF - SF_intermediate          -0.152233 0.0425 702  -3.583  0.0011\n PF - SF_advanced              -0.232581 0.0477 702  -4.880  &lt;.0001\n SF_early - SF_intermediate    -0.050938 0.0425 702  -1.199  0.2309\n SF_early - SF_advanced        -0.131285 0.0477 702  -2.755  0.0120\n SF_intermediate - SF_advanced -0.080347 0.0477 702  -1.686  0.1107\n\nff_area = 30-40:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.087807 0.0425 702  -2.067  0.0391\n PF - SF_intermediate          -0.186264 0.0425 702  -4.384  &lt;.0001\n PF - SF_advanced              -0.294016 0.0477 702  -6.170  &lt;.0001\n SF_early - SF_intermediate    -0.098458 0.0425 702  -2.318  0.0289\n SF_early - SF_advanced        -0.206209 0.0477 702  -4.327  &lt;.0001\n SF_intermediate - SF_advanced -0.107752 0.0477 702  -2.261  0.0289\n\nff_area = 40-50:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.109815 0.0425 702  -2.585  0.0149\n PF - SF_intermediate          -0.208063 0.0425 702  -4.898  &lt;.0001\n PF - SF_advanced              -0.319357 0.0477 702  -6.701  &lt;.0001\n SF_early - SF_intermediate    -0.098248 0.0425 702  -2.313  0.0210\n SF_early - SF_advanced        -0.209542 0.0477 702  -4.397  &lt;.0001\n SF_intermediate - SF_advanced -0.111294 0.0477 702  -2.335  0.0210\n\nff_area = 50-60:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.157313 0.0425 702  -3.703  0.0005\n PF - SF_intermediate          -0.161623 0.0425 702  -3.804  0.0005\n PF - SF_advanced              -0.258221 0.0477 702  -5.418  &lt;.0001\n SF_early - SF_intermediate    -0.004309 0.0425 702  -0.101  0.9192\n SF_early - SF_advanced        -0.100908 0.0477 702  -2.117  0.0516\n SF_intermediate - SF_advanced -0.096599 0.0477 702  -2.027  0.0516\n\nff_area = 60-70:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.194835 0.0425 702  -4.586  &lt;.0001\n PF - SF_intermediate          -0.154515 0.0425 702  -3.637  0.0006\n PF - SF_advanced              -0.258505 0.0477 702  -5.424  &lt;.0001\n SF_early - SF_intermediate     0.040320 0.0425 702   0.949  0.3429\n SF_early - SF_advanced        -0.063670 0.0477 702  -1.336  0.2184\n SF_intermediate - SF_advanced -0.103990 0.0477 702  -2.182  0.0442\n\nff_area = 70-80:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.262889 0.0425 702  -6.188  &lt;.0001\n PF - SF_intermediate          -0.269995 0.0425 702  -6.355  &lt;.0001\n PF - SF_advanced              -0.280583 0.0477 702  -5.888  &lt;.0001\n SF_early - SF_intermediate    -0.007107 0.0425 702  -0.167  0.8672\n SF_early - SF_advanced        -0.017694 0.0477 702  -0.371  0.8672\n SF_intermediate - SF_advanced -0.010587 0.0477 702  -0.222  0.8672\n\nff_area = 80-90:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.024541 0.0436 702  -0.563  0.5738\n PF - SF_intermediate          -0.207631 0.0425 702  -4.887  &lt;.0001\n PF - SF_advanced              -0.268622 0.0477 702  -5.637  &lt;.0001\n SF_early - SF_intermediate    -0.183090 0.0436 702  -4.198  &lt;.0001\n SF_early - SF_advanced        -0.244081 0.0487 702  -5.012  &lt;.0001\n SF_intermediate - SF_advanced -0.060991 0.0477 702  -1.280  0.2412\n\nff_area = 90-100:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.697898 0.0466 702 -14.962  &lt;.0001\n PF - SF_intermediate          -0.498232 0.0425 702 -11.728  &lt;.0001\n PF - SF_advanced              -0.388819 0.0477 702  -8.159  &lt;.0001\n SF_early - SF_intermediate     0.199666 0.0466 702   4.281  &lt;.0001\n SF_early - SF_advanced         0.309079 0.0515 702   5.999  &lt;.0001\n SF_intermediate - SF_advanced  0.109413 0.0477 702   2.296  0.0220\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_EBA &lt;- emmeans(model_EBA_temp_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_EBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.31134 0.0229 710 -13.576  &lt;.0001\n PF - SF_intermediate          -0.30822 0.0229 710 -13.440  &lt;.0001\n PF - SF_advanced              -0.33912 0.0257 710 -13.183  &lt;.0001\n SF_early - SF_intermediate     0.00312 0.0229 710   0.136  0.8917\n SF_early - SF_advanced        -0.02777 0.0257 710  -1.080  0.3368\n SF_intermediate - SF_advanced -0.03090 0.0257 710  -1.201  0.3368\n\nff_area = 10-20:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.37596 0.0229 710 -16.394  &lt;.0001\n PF - SF_intermediate          -0.39664 0.0229 710 -17.296  &lt;.0001\n PF - SF_advanced              -0.40282 0.0257 710 -15.659  &lt;.0001\n SF_early - SF_intermediate    -0.02068 0.0229 710  -0.902  0.4411\n SF_early - SF_advanced        -0.02686 0.0257 710  -1.044  0.4411\n SF_intermediate - SF_advanced -0.00618 0.0257 710  -0.240  0.8101\n\nff_area = 20-30:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.39947 0.0229 710 -17.419  &lt;.0001\n PF - SF_intermediate          -0.41162 0.0229 710 -17.949  &lt;.0001\n PF - SF_advanced              -0.37628 0.0257 710 -14.627  &lt;.0001\n SF_early - SF_intermediate    -0.01216 0.0229 710  -0.530  0.5962\n SF_early - SF_advanced         0.02318 0.0257 710   0.901  0.4413\n SF_intermediate - SF_advanced  0.03534 0.0257 710   1.374  0.2549\n\nff_area = 30-40:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.36963 0.0229 710 -16.118  &lt;.0001\n PF - SF_intermediate          -0.39441 0.0229 710 -17.199  &lt;.0001\n PF - SF_advanced              -0.35405 0.0257 710 -13.763  &lt;.0001\n SF_early - SF_intermediate    -0.02478 0.0229 710  -1.081  0.3363\n SF_early - SF_advanced         0.01558 0.0257 710   0.606  0.5450\n SF_intermediate - SF_advanced  0.04036 0.0257 710   1.569  0.1757\n\nff_area = 40-50:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.26783 0.0229 710 -11.679  &lt;.0001\n PF - SF_intermediate          -0.30692 0.0229 710 -13.384  &lt;.0001\n PF - SF_advanced              -0.27221 0.0257 710 -10.582  &lt;.0001\n SF_early - SF_intermediate    -0.03909 0.0229 710  -1.705  0.1331\n SF_early - SF_advanced        -0.00438 0.0257 710  -0.170  0.8648\n SF_intermediate - SF_advanced  0.03471 0.0257 710   1.349  0.2132\n\nff_area = 50-60:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.23435 0.0229 710 -10.219  &lt;.0001\n PF - SF_intermediate          -0.25669 0.0229 710 -11.193  &lt;.0001\n PF - SF_advanced              -0.23102 0.0257 710  -8.981  &lt;.0001\n SF_early - SF_intermediate    -0.02234 0.0229 710  -0.974  0.3964\n SF_early - SF_advanced         0.00333 0.0257 710   0.129  0.8970\n SF_intermediate - SF_advanced  0.02567 0.0257 710   0.998  0.3964\n\nff_area = 60-70:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.28210 0.0229 710 -12.301  &lt;.0001\n PF - SF_intermediate          -0.30027 0.0229 710 -13.094  &lt;.0001\n PF - SF_advanced              -0.28100 0.0257 710 -10.923  &lt;.0001\n SF_early - SF_intermediate    -0.01817 0.0229 710  -0.793  0.5447\n SF_early - SF_advanced         0.00110 0.0257 710   0.043  0.9659\n SF_intermediate - SF_advanced  0.01928 0.0257 710   0.749  0.5447\n\nff_area = 70-80:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.34644 0.0229 710 -15.107  &lt;.0001\n PF - SF_intermediate          -0.35932 0.0229 710 -15.668  &lt;.0001\n PF - SF_advanced              -0.31589 0.0257 710 -12.280  &lt;.0001\n SF_early - SF_intermediate    -0.01287 0.0229 710  -0.561  0.5747\n SF_early - SF_advanced         0.03055 0.0257 710   1.188  0.2824\n SF_intermediate - SF_advanced  0.04343 0.0257 710   1.688  0.1377\n\nff_area = 80-90:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.41205 0.0229 710 -17.968  &lt;.0001\n PF - SF_intermediate          -0.37377 0.0229 710 -16.298  &lt;.0001\n PF - SF_advanced              -0.33940 0.0257 710 -13.194  &lt;.0001\n SF_early - SF_intermediate     0.03828 0.0229 710   1.669  0.1146\n SF_early - SF_advanced         0.07264 0.0257 710   2.824  0.0073\n SF_intermediate - SF_advanced  0.03436 0.0257 710   1.336  0.1820\n\nff_area = 90-100:\n contrast                      estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.81646 0.0229 710 -35.603  &lt;.0001\n PF - SF_intermediate          -0.76027 0.0229 710 -33.152  &lt;.0001\n PF - SF_advanced              -0.66797 0.0257 710 -25.966  &lt;.0001\n SF_early - SF_intermediate     0.05619 0.0229 710   2.450  0.0145\n SF_early - SF_advanced         0.14849 0.0257 710   5.772  &lt;.0001\n SF_intermediate - SF_advanced  0.09231 0.0257 710   3.588  0.0004\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\nemm_SBA &lt;- emmeans(model_SBA_temp_w1, specs = ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\npairs(emm_SBA, by = \"ff_area\", adjust = \"BH\")\n\nff_area = 1-10:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.587962 0.0289 710 -20.333  &lt;.0001\n PF - SF_intermediate          -0.545589 0.0289 710 -18.868  &lt;.0001\n PF - SF_advanced              -0.507504 0.0324 710 -15.646  &lt;.0001\n SF_early - SF_intermediate     0.042373 0.0289 710   1.465  0.1719\n SF_early - SF_advanced         0.080458 0.0324 710   2.480  0.0200\n SF_intermediate - SF_advanced  0.038085 0.0324 710   1.174  0.2407\n\nff_area = 10-20:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.452717 0.0289 710 -15.656  &lt;.0001\n PF - SF_intermediate          -0.533649 0.0289 710 -18.455  &lt;.0001\n PF - SF_advanced              -0.533435 0.0324 710 -16.445  &lt;.0001\n SF_early - SF_intermediate    -0.080932 0.0289 710  -2.799  0.0079\n SF_early - SF_advanced        -0.080719 0.0324 710  -2.488  0.0157\n SF_intermediate - SF_advanced  0.000214 0.0324 710   0.007  0.9948\n\nff_area = 20-30:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.343787 0.0289 710 -11.889  &lt;.0001\n PF - SF_intermediate          -0.504662 0.0289 710 -17.452  &lt;.0001\n PF - SF_advanced              -0.485148 0.0324 710 -14.956  &lt;.0001\n SF_early - SF_intermediate    -0.160875 0.0289 710  -5.563  &lt;.0001\n SF_early - SF_advanced        -0.141361 0.0324 710  -4.358  &lt;.0001\n SF_intermediate - SF_advanced  0.019514 0.0324 710   0.602  0.5476\n\nff_area = 30-40:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.227962 0.0289 710  -7.883  &lt;.0001\n PF - SF_intermediate          -0.415719 0.0289 710 -14.376  &lt;.0001\n PF - SF_advanced              -0.431674 0.0324 710 -13.308  &lt;.0001\n SF_early - SF_intermediate    -0.187757 0.0289 710  -6.493  &lt;.0001\n SF_early - SF_advanced        -0.203712 0.0324 710  -6.280  &lt;.0001\n SF_intermediate - SF_advanced -0.015955 0.0324 710  -0.492  0.6230\n\nff_area = 40-50:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.038035 0.0289 710  -1.315  0.2266\n PF - SF_intermediate          -0.203761 0.0289 710  -7.046  &lt;.0001\n PF - SF_advanced              -0.229835 0.0324 710  -7.086  &lt;.0001\n SF_early - SF_intermediate    -0.165726 0.0289 710  -5.731  &lt;.0001\n SF_early - SF_advanced        -0.191800 0.0324 710  -5.913  &lt;.0001\n SF_intermediate - SF_advanced -0.026074 0.0324 710  -0.804  0.4218\n\nff_area = 50-60:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.171567 0.0289 710   5.933  &lt;.0001\n PF - SF_intermediate          -0.055042 0.0289 710  -1.903  0.0793\n PF - SF_advanced              -0.059707 0.0324 710  -1.841  0.0793\n SF_early - SF_intermediate    -0.226609 0.0289 710  -7.837  &lt;.0001\n SF_early - SF_advanced        -0.231273 0.0324 710  -7.130  &lt;.0001\n SF_intermediate - SF_advanced -0.004665 0.0324 710  -0.144  0.8857\n\nff_area = 60-70:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.130327 0.0289 710   4.507  &lt;.0001\n PF - SF_intermediate          -0.048096 0.0289 710  -1.663  0.1160\n PF - SF_advanced              -0.071057 0.0324 710  -2.191  0.0432\n SF_early - SF_intermediate    -0.178423 0.0289 710  -6.170  &lt;.0001\n SF_early - SF_advanced        -0.201383 0.0324 710  -6.208  &lt;.0001\n SF_intermediate - SF_advanced -0.022961 0.0324 710  -0.708  0.4793\n\nff_area = 70-80:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.167226 0.0289 710   5.783  &lt;.0001\n PF - SF_intermediate          -0.027999 0.0289 710  -0.968  0.3332\n PF - SF_advanced               0.122546 0.0324 710   3.778  0.0003\n SF_early - SF_intermediate    -0.195225 0.0289 710  -6.751  &lt;.0001\n SF_early - SF_advanced        -0.044680 0.0324 710  -1.377  0.2026\n SF_intermediate - SF_advanced  0.150545 0.0324 710   4.641  &lt;.0001\n\nff_area = 80-90:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                  0.136825 0.0289 710   4.732  &lt;.0001\n PF - SF_intermediate           0.001449 0.0289 710   0.050  0.9600\n PF - SF_advanced               0.026896 0.0324 710   0.829  0.5196\n SF_early - SF_intermediate    -0.135376 0.0289 710  -4.682  &lt;.0001\n SF_early - SF_advanced        -0.109929 0.0324 710  -3.389  0.0015\n SF_intermediate - SF_advanced  0.025447 0.0324 710   0.784  0.5196\n\nff_area = 90-100:\n contrast                       estimate     SE  df t.ratio p.value\n PF - SF_early                 -0.069223 0.0289 710  -2.394  0.0254\n PF - SF_intermediate          -0.202703 0.0289 710  -7.010  &lt;.0001\n PF - SF_advanced              -0.040164 0.0324 710  -1.238  0.2593\n SF_early - SF_intermediate    -0.133480 0.0289 710  -4.616  &lt;.0001\n SF_early - SF_advanced         0.029059 0.0324 710   0.896  0.3706\n SF_intermediate - SF_advanced  0.162538 0.0324 710   5.011  &lt;.0001\n\nDegrees-of-freedom method: satterthwaite \nP value adjustment: BH method for 6 tests \n\n\n\nHeterocedasticidade\n\n# Função: resíduos normalizados vs n_obs, com controle de eixos\nplot_resid_hetero &lt;- function(m_lme, dat, region_name,\n                              show_x_lab = TRUE,\n                              show_y_lab = TRUE) {\n  rn &lt;- residuals(m_lme, type = \"response\")\n  ggplot(data.frame(n_obs = dat$n_obs, rnorm = rn),\n         aes(n_obs, rnorm)) +\n    geom_point(alpha = .35) +\n    geom_smooth(method = \"loess\", se = FALSE) +\n    geom_hline(yintercept = 0, lty = 2, col = \"grey40\") +\n    scale_x_log10() +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(hjust = 0.5)  \n    ) +\n    labs(\n      #title = region_name,\n      x = if (show_x_lab) expression(n[obs]~\"(log scale)\") else NULL,  \n      y = if (show_y_lab) \"Normalized residuals\" else NULL             \n    )\n}\n\n# Monta cada painel com as regras pedidas:\n# - CBA: só Y\np_het_cba &lt;- plot_resid_hetero(model_CBA_temp_w1, model_cba_temp, \"CBA\",\n                               show_x_lab = FALSE, show_y_lab = TRUE)\n\n# - EBA: só X\np_het_eba &lt;- plot_resid_hetero(model_EBA_temp_w1, model_eba_temp, \"EBA\",\n                               show_x_lab = TRUE, show_y_lab = FALSE)\n\n# - SBA: sem X e sem Y\np_het_sba &lt;- plot_resid_hetero(model_SBA_temp_w1, model_sba_temp, \"SBA\",\n                               show_x_lab = FALSE, show_y_lab = FALSE)\n\n# Painel \npainel_het_temp &lt;- ggpubr::ggarrange(p_het_cba, p_het_eba, p_het_sba,\n                                     ncol = 3, nrow = 1, align = \"hv\")\n\npainel_het_temp\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/hetero_residuals_lme_temp.png\", width=8, height=6, dpi=400, bg=\"white\")\n\n\n\nQQ Plot\n\nqq_lme &lt;- function(m, region_name = \"\", show_y_title = FALSE, show_x_title = FALSE){\n  rn &lt;- residuals(m, type = \"response\")\n  ggplot(data.frame(rn = rn), aes(sample = rn)) +\n    stat_qq(distribution = stats::qnorm) +\n    stat_qq_line(distribution = stats::qnorm) +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      plot.title = element_text(size = 12, face = \"bold\", hjust = 0.5),\n      axis.title.y = if (show_y_title) element_text() else element_blank(),\n      axis.title.x = if (show_x_title) element_text() else element_blank()\n    ) +\n    labs(\n      title = region_name,\n      x = \"Theoretical quantiles (N(0,1))\",\n      y = if (show_y_title) \"Sample quantiles\" else NULL\n    )\n}\n\n# y só na 1ª coluna (CBA) e x só na 2ª (EBA)\nqq_cba &lt;- qq_lme(model_CBA_temp_w1, \"\", show_y_title = TRUE,  show_x_title = FALSE)\nqq_eba &lt;- qq_lme(model_EBA_temp_w1, \"\", show_y_title = FALSE, show_x_title = TRUE)\nqq_sba &lt;- qq_lme(model_SBA_temp_w1, \"\", show_y_title = FALSE, show_x_title = FALSE)\n\npainel_qq_temp &lt;- ggpubr::ggarrange(qq_cba, qq_eba, qq_sba, ncol = 3, nrow = 1, align = \"hv\")\npainel_qq_temp\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/qqplot_temp.png\", bg = \"white\",\n       dpi = 600, width = 8, height = 6)\n\n\n\n\nCCC de Lins\n\n## CBA\n\n# Obter os valores observados e previstos\nobservado_cba_temp &lt;- model_cba_temp$Temp\nprevisto_cba_temp  &lt;- predict(model_CBA_temp_w1)\n\nccc_result_cba_temp  &lt;- CCC(observado_cba_temp , previsto_cba_temp )\nccc_val_cba_temp &lt;- round(ccc_result_cba_temp$rho.c[, \"est\"], 3)\n\n\n## EBA\n\n# Obter os valores observados e previstos\nobservado_eba_temp &lt;- model_eba_temp$Temp\nprevisto_eba_temp  &lt;- predict(model_EBA_temp_w1)\n\nccc_result_eba_temp  &lt;- CCC(observado_eba_temp , previsto_eba_temp )\nccc_val_eba_temp &lt;- round(ccc_result_eba_temp$rho.c[, \"est\"], 3)\n\n## SBA\n\n# Obter os valores observados e previstos\nobservado_sba_temp &lt;- model_sba_temp$Temp\nprevisto_sba_temp  &lt;- predict(model_SBA_temp_w1)\n\nccc_result_sba_temp  &lt;- CCC(observado_sba_temp , previsto_sba_temp )\nccc_val_sba_temp &lt;- round(ccc_result_sba_temp$rho.c[, \"est\"], 3)\n\n\n\nEfeitos para cada ff_area e classe florestal\n\n# Intervalos p/ plot “em_all”\nem_df_cba &lt;- as.data.frame(emm_CBA); em_df_cba$region &lt;- \"CBA\"\nem_df_eba &lt;- as.data.frame(emm_EBA); em_df_eba$region &lt;- \"EBA\"\nem_df_sba &lt;- as.data.frame(emm_SBA); em_df_sba$region &lt;- \"SBA\"\n\nem_all &lt;- bind_rows(em_df_cba, em_df_eba, em_df_sba) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    Tipo    = factor(Tipo,    levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  )\n\n# Comparações dentro de cada faixa (matriz / pwpm)\nem_cba_pw &lt;- emmeans(model_CBA_temp_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_eba_pw &lt;- emmeans(model_EBA_temp_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\nem_sba_pw &lt;- emmeans(model_SBA_temp_w1, ~ Tipo | ff_area, lmer.df = \"satterthwaite\")\n\npwpm(em_cba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                     PF SF_early SF_intermediate SF_advanced\nPF               [26.0]   0.0009          &lt;.0001      0.0027\nSF_early         0.1609   [25.9]          0.8111      0.9992\nSF_intermediate  0.1986   0.0377          [25.8]      0.9107\nSF_advanced      0.1670   0.0061         -0.0316      [25.9]\n\nff_area = 10-20\n                       PF  SF_early SF_intermediate SF_advanced\nPF                 [25.8]    1.0000          0.7407      0.0770\nSF_early         0.000911    [25.8]          0.7280      0.0734\nSF_intermediate -0.043123 -0.044034          [25.9]      0.4376\nSF_advanced     -0.114637 -0.115547       -0.071513      [25.9]\n\nff_area = 20-30\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.7]   0.0810          0.0021      &lt;.0001\nSF_early        -0.1013   [25.8]          0.6277      0.0306\nSF_intermediate -0.1522  -0.0509          [25.8]      0.3318\nSF_advanced     -0.2326  -0.1313         -0.0803      [25.9]\n\nff_area = 30-40\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.6]   0.1651          &lt;.0001      &lt;.0001\nSF_early        -0.0878   [25.7]          0.0950      0.0001\nSF_intermediate -0.1863  -0.0985          [25.8]      0.1083\nSF_advanced     -0.2940  -0.2062         -0.1078      [25.9]\n\nff_area = 40-50\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.5]   0.0487          &lt;.0001      &lt;.0001\nSF_early        -0.1098   [25.6]          0.0961      &lt;.0001\nSF_intermediate -0.2081  -0.0982          [25.7]      0.0911\nSF_advanced     -0.3194  -0.2095         -0.1113      [25.9]\n\nff_area = 50-60\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.5]   0.0013          0.0009      &lt;.0001\nSF_early        -0.15731   [25.7]          0.9996      0.1485\nSF_intermediate -0.16162 -0.00431          [25.7]      0.1790\nSF_advanced     -0.25822 -0.10091        -0.09660      [25.8]\n\nff_area = 60-70\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.4]   &lt;.0001          0.0017      &lt;.0001\nSF_early        -0.1948   [25.6]          0.7783      0.5402\nSF_intermediate -0.1545   0.0403          [25.6]      0.1292\nSF_advanced     -0.2585  -0.0637         -0.1040      [25.7]\n\nff_area = 70-80\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.26289   [25.6]          0.9983      0.9825\nSF_intermediate -0.27000 -0.00711          [25.6]      0.9961\nSF_advanced     -0.28058 -0.01769        -0.01059      [25.7]\n\nff_area = 80-90\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.3]   0.9431          &lt;.0001      &lt;.0001\nSF_early        -0.0245   [25.3]          0.0002      &lt;.0001\nSF_intermediate -0.2076  -0.1831          [25.5]      0.5761\nSF_advanced     -0.2686  -0.2441         -0.0610      [25.6]\n\nff_area = 90-100\n                    PF SF_early SF_intermediate SF_advanced\nPF              [24.9]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.698   [25.6]          0.0001      &lt;.0001\nSF_intermediate -0.498    0.200          [25.4]      0.0999\nSF_advanced     -0.389    0.309           0.109      [25.3]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_eba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.5]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.31134   [25.9]          0.9991      0.7021\nSF_intermediate -0.30822  0.00312          [25.9]      0.6264\nSF_advanced     -0.33912 -0.02777        -0.03090      [25.9]\n\nff_area = 10-20\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.37596   [25.8]          0.8040      0.7235\nSF_intermediate -0.39664 -0.02068          [25.8]      0.9951\nSF_advanced     -0.40282 -0.02686        -0.00618      [25.8]\n\nff_area = 20-30\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.3995   [25.7]          0.9518      0.8042\nSF_intermediate -0.4116  -0.0122          [25.7]      0.5162\nSF_advanced     -0.3763   0.0232          0.0353      [25.7]\n\nff_area = 30-40\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.3696   [25.7]          0.7016      0.9303\nSF_intermediate -0.3944  -0.0248          [25.7]      0.3972\nSF_advanced     -0.3541   0.0156          0.0404      [25.7]\n\nff_area = 40-50\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.3]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.26783   [25.6]          0.3220      0.9982\nSF_intermediate -0.30692 -0.03909          [25.7]      0.5318\nSF_advanced     -0.27221 -0.00438         0.03471      [25.6]\n\nff_area = 50-60\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.23435   [25.6]          0.7642      0.9992\nSF_intermediate -0.25669 -0.02234          [25.6]      0.7507\nSF_advanced     -0.23102  0.00333         0.02567      [25.6]\n\nff_area = 60-70\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.2]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.2821   [25.5]          0.8579      1.0000\nSF_intermediate -0.3003  -0.0182          [25.5]      0.8770\nSF_advanced     -0.2810   0.0011          0.0193      [25.5]\n\nff_area = 70-80\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.1]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.3464   [25.5]          0.9434      0.6348\nSF_intermediate -0.3593  -0.0129          [25.5]      0.3306\nSF_advanced     -0.3159   0.0306          0.0434      [25.4]\n\nff_area = 80-90\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.0]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.4120   [25.4]          0.3408      0.0251\nSF_intermediate -0.3738   0.0383          [25.4]      0.5404\nSF_advanced     -0.3394   0.0726          0.0344      [25.3]\n\nff_area = 90-100\n                     PF SF_early SF_intermediate SF_advanced\nPF               [24.5]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.8165   [25.3]          0.0689      &lt;.0001\nSF_intermediate -0.7603   0.0562          [25.3]      0.0020\nSF_advanced     -0.6680   0.1485          0.0923      [25.2]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\npwpm(em_sba_pw, sort = FALSE)\n\n\nff_area = 1-10\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.5880   [25.9]          0.4591      0.0639\nSF_intermediate -0.5456   0.0424          [25.8]      0.6434\nSF_advanced     -0.5075   0.0805          0.0381      [25.8]\n\nff_area = 10-20\n                       PF  SF_early SF_intermediate SF_advanced\nPF                 [25.2]    &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.452717    [25.6]          0.0270      0.0626\nSF_intermediate -0.533649 -0.080932          [25.7]      1.0000\nSF_advanced     -0.533435 -0.080719        0.000213      [25.7]\n\nff_area = 20-30\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.1]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.3438   [25.5]          &lt;.0001      &lt;.0001\nSF_intermediate -0.5047  -0.1609          [25.6]      0.9316\nSF_advanced     -0.4851  -0.1414          0.0195      [25.6]\n\nff_area = 30-40\n                    PF SF_early SF_intermediate SF_advanced\nPF              [25.1]   &lt;.0001          &lt;.0001      &lt;.0001\nSF_early        -0.228   [25.3]          &lt;.0001      &lt;.0001\nSF_intermediate -0.416   -0.188          [25.5]      0.9609\nSF_advanced     -0.432   -0.204          -0.016      [25.5]\n\nff_area = 40-50\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.2]   0.5534          &lt;.0001      &lt;.0001\nSF_early        -0.0380   [25.2]          &lt;.0001      &lt;.0001\nSF_intermediate -0.2038  -0.1657          [25.4]      0.8526\nSF_advanced     -0.2298  -0.1918         -0.0261      [25.4]\n\nff_area = 50-60\n                      PF SF_early SF_intermediate SF_advanced\nPF                [25.3]   &lt;.0001          0.2275      0.2551\nSF_early         0.17157   [25.1]          &lt;.0001      &lt;.0001\nSF_intermediate -0.05504 -0.22661          [25.3]      0.9989\nSF_advanced     -0.05971 -0.23127        -0.00466      [25.3]\n\nff_area = 60-70\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.2]   &lt;.0001          0.3441      0.1268\nSF_early         0.1303   [25.0]          &lt;.0001      &lt;.0001\nSF_intermediate -0.0481  -0.1784          [25.2]      0.8940\nSF_advanced     -0.0711  -0.2014         -0.0230      [25.2]\n\nff_area = 70-80\n                     PF SF_early SF_intermediate SF_advanced\nPF               [25.1]   &lt;.0001          0.7676      0.0010\nSF_early         0.1672   [24.9]          &lt;.0001      0.5139\nSF_intermediate -0.0280  -0.1952          [25.1]      &lt;.0001\nSF_advanced      0.1225  -0.0447          0.1505      [24.9]\n\nff_area = 80-90\n                      PF SF_early SF_intermediate SF_advanced\nPF                [24.9]   &lt;.0001          1.0000      0.8406\nSF_early         0.13683   [24.8]          &lt;.0001      0.0041\nSF_intermediate  0.00145 -0.13538          [24.9]      0.8615\nSF_advanced      0.02690 -0.10993         0.02545      [24.9]\n\nff_area = 90-100\n                     PF SF_early SF_intermediate SF_advanced\nPF               [24.6]   0.0792          &lt;.0001      0.6027\nSF_early        -0.0692   [24.7]          &lt;.0001      0.8070\nSF_intermediate -0.2027  -0.1335          [24.8]      &lt;.0001\nSF_advanced     -0.0402   0.0291          0.1625      [24.6]\n\nRow and column labels: Tipo\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\n# Exportar matriz como data.frame\npw_cba_df &lt;- as.data.frame(pwpm(em_cba_pw, sort = FALSE))\npw_eba_df &lt;- as.data.frame(pwpm(em_eba_pw, sort = FALSE))\npw_sba_df &lt;- as.data.frame(pwpm(em_sba_pw, sort = FALSE))\npw_df &lt;- bind_rows(pw_cba_df, pw_eba_df, pw_sba_df)\n\nopenxlsx::write.xlsx(pw_df, file = \"data_group/matriz_contrastes_pwpm_temp.xlsx\", rowNames = TRUE)\n\n# Tabela final - análises\ntabela_estilo_fig1 &lt;- em_all %&gt;%\n  mutate(\n    Tipo = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))\n  ) %&gt;%\n  rename(\n    Region   = region,\n    Cover    = Tipo,\n    Effect   = emmean,\n    Interval = ff_area,\n    CI_lower = lower.CL,\n    CI_upper = upper.CL\n  ) %&gt;%\n  mutate(\n    Variable = \"TEMP\",\n    Cover = factor(Cover, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(Interval, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\"40-50\",\n                                           \"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\"))\n  ) %&gt;%\n  arrange(Region, Cover, Interval) %&gt;%\n  dplyr::select(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)\n\nopenxlsx::write.xlsx(\n  tabela_estilo_fig1,\n  file = \"data_group/emmeans_intervalos_temp.xlsx\",\n  rowNames = FALSE\n)\n\n# Tabela final - SI\n\n# Preparar tabela base\nt2 &lt;- em_all %&gt;%\n  mutate(\n    Cover = factor(Tipo, levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    Interval = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                          \"40-50\",\"50-60\",\"60-70\",\"70-80\",\n                                          \"80-90\",\"90-100\"))\n  ) %&gt;%\n  dplyr::select(region, Interval, Cover,\n         Effect = emmean,\n         CI_lower = lower.CL,\n         CI_upper = upper.CL)\n\n# Reorganizar para formato largo (larger table like Figure 2)\ntabela_fig2 &lt;- t2 %&gt;%\n  arrange(Interval, Cover) %&gt;%\n  tidyr::pivot_wider(\n    names_from = region,\n    values_from = c(Effect, CI_lower, CI_upper),\n    names_glue = \"{region}_{.value}\"\n  ) %&gt;%\n  arrange(Interval, Cover)\n\nopenxlsx::write.xlsx(\n  tabela_fig2,\n  file = \"data_group/emmeans_intervalos_temp_table_final.xlsx\",\n  rowNames = FALSE\n)\n\n\n\nConstrastes e significancia\n\nget_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area*Tipo, lmer.df = \"satterthwaite\")\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", by = \"ff_area\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  df\n}\n\ncontrast_CBA_df &lt;- get_contrasts(model_CBA_temp_w1, \"CBA\")\ncontrast_EBA_df &lt;- get_contrasts(model_EBA_temp_w1, \"EBA\")\ncontrast_SBA_df &lt;- get_contrasts(model_SBA_temp_w1, \"SBA\")\n\nall_contrasts &lt;- bind_rows(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) %&gt;%\n  filter(grepl(\"PF\", contrast) & grepl(\"SF_\", contrast)) %&gt;%\n  tidyr::separate(contrast, into = c(\"tipo1\", \"tipo2\"), sep = \" - \") %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")) |\n         (tipo2 == \"PF\" & tipo1 %in% c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\"))) %&gt;%\n  mutate(\n    ff_area = factor(ff_area, levels = c(\"1-10\",\"10-20\",\"20-30\",\"30-40\",\n                                         \"40-50\",\"50-60\",\"60-70\",\"70-80\",\"80-90\",\"90-100\")),\n    tipo_sf = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\",\"SF_intermediate\",\"SF_advanced\")),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF − SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\nwritexl::write_xlsx(all_contrasts, \"data_group/contrast_PF_SF_temp.xlsx\")\n\n\n\n\nPainel Temp\n\n# Plot de pontos\nplot_point_temp &lt;- function(region_name, show_y = TRUE, show_x = TRUE, show_legend = FALSE, show_y_axes = TRUE) {\n  p &lt;- ggplot(filter(em_all, region == region_name)%&gt;%\n    mutate(\n      Tipo = factor(Tipo) %&gt;%\n        fct_relevel(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\") %&gt;%\n        fct_recode(\n          \"PF\" = \"PF\",\n          \"SF early\" = \"SF_early\",\n          \"SF intermediate\" = \"SF_intermediate\",\n          \"SF advanced\" = \"SF_advanced\"\n        )\n    ), \n    aes(x = ff_area, y = emmean, color = Tipo, group = Tipo)) +\n    geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),\n                  position = position_dodge(width = 0.8), width = 0.6, size = 0.5) +\n    geom_point(position = position_dodge(width = 0.8), size = 1.5) +\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_blank(),\n      legend.background = element_rect(fill = \"transparent\"),\n      legend.text = element_text(size = 10),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      #axis.text.x = element_blank(),\n      axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),\n      axis.text.y = if (show_y_axes) element_text(size = 10) else element_blank(),\n      axis.title.y = if (show_y) element_text(size = 14, margin = margin(r = -20)) else element_blank(),\n      axis.title.x = if (show_x) element_text(size = 12) else element_blank(),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    scale_color_manual(values = c(\"#7F3B08\", \"#FEE0B6\", \"#FDB863\", \"#E08214\")) +\n    scale_y_continuous(limits = c(24, 26.5), breaks = seq(24, 26.5, by = 0.5)) +\n    #labs(y = if (show_y) \"Temperature\\nfixed effects (°C·yr⁻¹)\" else NULL) +\n    labs(x = \"Fractional cover (%)\",\n         y = if (show_y) expression(bold(atop(\"Estimated marginal mean\", \"temperature (°C·yr\"^{-1}*\")\"))) else NULL) \n  \n  return(p)\n}\n\n\n# Atualizar ordem dos fatores e renomear os labels\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    tipo_sf = factor(tipo_sf, levels = c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")),\n    tipo_sf_label = fct_recode(tipo_sf,\n                               \"SF early\" = \"SF_early\",\n                               \"SF intermediate\" = \"SF_intermediate\",\n                               \"SF advanced\" = \"SF_advanced\")\n  )\n\n\n# Criar coluna categórica para estimate\nall_contrasts &lt;- all_contrasts %&gt;%\n  mutate(\n    estimate_cat = factor(\n      cut(estimate,\n          breaks = c(-Inf, -0.3, 0, Inf),\n          labels = c(\"&lt;−0.3\", \"−0.3 to 0\", \"&gt;0\")\n      ),\n      levels = c(\"&lt;−0.3\", \"−0.3 to 0\", \"&gt;0\")\n    )\n  )\n\n# Heatmap de contrastes\nplot_heat_temp &lt;- function(region_name, show_legend = FALSE, show_y_labels = TRUE) {\n  ggplot(filter(all_contrasts, region == region_name), \n         aes(x = ff_area, y = tipo_sf_label, fill = estimate_cat)) +\n    geom_tile(color = \"white\", height = 0.7) +\n    geom_text(aes(label = sig_label), size = 3, color = \"black\", family = \"serif\") +\n    scale_fill_manual(values = c(\"&lt;−0.3\" = \"#4393C3\", \"−0.3 to 0\" = \"#92C5DE\", \"&gt;0\" = \"#D6604D\"),\n                      limits = c(\"&lt;−0.3\", \"−0.3 to 0\", \"&gt;0\"),\n                      drop = FALSE,\n                      name = bquote(bold(atop(Delta~\"LST (PF − SF)\", \"(°C)\")))\n)+\n    ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text.x = element_blank(),\n      axis.title = element_blank(),\n      axis.text.y = if (show_y_labels) element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\") else element_blank(),\n      legend.position = if (show_legend) \"right\" else \"none\",\n      legend.title = element_text(size = 10, face = \"bold\", family = \"serif\"),\n      legend.text = element_text(size = 10),\n      plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\", family = \"serif\"),\n      strip.text = element_text(size = 14, face = \"bold\", family = \"serif\"),\n      plot.margin = margin(2, 2, 2, 2)\n    ) +\n    labs(title = \"\")\n}\n  \n\n# Combinar gráficos para cada região\npanel_CBA_temp &lt;- plot_heat_temp(\"CBA\", show_legend = FALSE, show_y_labels = TRUE) /\n             plot_point_temp(\"CBA\", show_y = TRUE, show_x = FALSE, show_legend = FALSE, show_y_axes = TRUE)\npanel_CBA_temp &lt;- panel_CBA_temp + plot_layout(heights = c(0.2, 0.8))\n\npanel_EBA_temp &lt;- plot_heat_temp(\"EBA\", show_legend = FALSE, show_y_labels = FALSE) /\n             plot_point_temp(\"EBA\", show_y = FALSE, show_x = TRUE,  show_legend = FALSE, show_y_axes = FALSE)\npanel_EBA_temp &lt;- panel_EBA_temp + plot_layout(heights = c(0.2, 0.8))\n\npanel_SBA_temp &lt;- plot_heat_temp(\"SBA\", show_legend = TRUE, show_y_labels = FALSE) /\n             plot_point_temp(\"SBA\", show_y = FALSE, show_x = FALSE, show_legend = TRUE, show_y_axes = FALSE)\npanel_SBA_temp &lt;- panel_SBA_temp + plot_layout(heights = c(0.2, 0.8))\n\n# Combinar todos os painéis horizontalmente\nfinal_panel_temp &lt;- (panel_CBA_temp | panel_EBA_temp | panel_SBA_temp)\n\n# Exibir painel final\nfinal_panel_temp\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/em_fixed_fixed_temp.png\",\n       plot = final_panel_temp,\n       bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 5095480 272.2    7437491 397.3  7437491 397.3\nVcells 9912773  75.7   17824054 136.0 17824054 136.0\n\n\n\nTodos os constraste entre frações de área\n\n# Lista de modelos\nmodelos &lt;- list(CBA = model_CBA_temp_w1, EBA = model_EBA_temp_w1, SBA = model_SBA_temp_w1)\n\n# Função para gerar todos os contrastes PF - SF\nget_all_contrasts &lt;- function(model, region_name) {\n  em &lt;- emmeans(model, ~ ff_area * Tipo)\n  contrast_res &lt;- contrast(em, method = \"revpairwise\", adjust = \"fdr\")\n  df &lt;- as.data.frame(contrast_res)\n  df$region &lt;- region_name\n  return(df)\n}\n\n# Aplicar para todas as regiões\nall_contrasts_sup &lt;- purrr::map2_dfr(modelos, names(modelos), get_all_contrasts)\n\nstr(all_contrasts_sup)\n\nClasses 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:\n $ contrast: chr  \"(10-20 PF) - (1-10 PF)\" \"(20-30 PF) - (1-10 PF)\" \"(20-30 PF) - (10-20 PF)\" \"(30-40 PF) - (1-10 PF)\" ...\n $ estimate: num  -0.22 -0.358 -0.138 -0.444 -0.224 ...\n $ SE      : num  0.0425 0.0425 0.0425 0.0425 0.0425 ...\n $ df      : num  702 702 702 702 702 ...\n $ t.ratio : num  -5.18 -8.43 -3.25 -10.45 -5.27 ...\n $ p.value : num  6.81e-07 1.04e-15 1.94e-03 5.74e-23 4.35e-07 ...\n $ region  : chr  \"CBA\" \"CBA\" \"CBA\" \"CBA\" ...\n - attr(*, \"estName\")= chr \"estimate\"\n - attr(*, \"pri.vars\")= chr \"contrast\"\n - attr(*, \"adjust\")= chr \"fdr\"\n - attr(*, \"side\")= num 0\n - attr(*, \"delta\")= num 0\n - attr(*, \"type\")= chr \"link\"\n - attr(*, \"mesg\")= chr [1:2] \"Degrees-of-freedom method: kenward-roger\" \"P value adjustment: fdr method for 780 tests\"\n - attr(*, \"digits\")= int 7\n\n# Extrair contrastes entre PF e SF\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  filter(str_detect(contrast, \"PF\") & str_detect(contrast, \"SF_\"))\n\n# Extrair informações usando regex\n# Regex para capturar (faixa tipo) - (faixa tipo)\nextr &lt;- str_match(all_contrasts_sup$contrast,\n                  \"\\\\(([^ ]+) ([^)]+)\\\\) - \\\\(([^ ]+) ([^)]+)\\\\)\")\n\n# Adicionar colunas extraídas\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa1 = extr[, 2],\n    tipo1 = extr[, 3],\n    faixa2 = extr[, 4],\n    tipo2 = extr[, 5]\n  ) %&gt;%\n  filter((tipo1 == \"PF\" & tipo2 %in% sf_levels) | (tipo2 == \"PF\" & tipo1 %in% sf_levels)) %&gt;%\n  mutate(\n    faixa_PF = if_else(tipo1 == \"PF\", faixa1, faixa2),\n    faixa_SF = if_else(tipo1 == \"PF\", faixa2, faixa1),\n    tipo_SF  = if_else(tipo1 == \"PF\", tipo2, tipo1),\n    estimate = if_else(tipo1 == \"PF\", estimate, -estimate),  # garantir PF - SF\n    sig_label = ifelse(p.value &lt; 0.05, \"*\", \"\")\n  )\n\n# Ajustar fatores\nfaixas_niveis &lt;- c(\"1-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\",\n                   \"50-60\", \"60-70\", \"70-80\", \"80-90\", \"90-100\")\n\nsf_levels &lt;- c(\"SF_early\", \"SF_intermediate\", \"SF_advanced\")\n\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n  mutate(\n    faixa_PF = factor(faixa_PF, levels = faixas_niveis),\n    faixa_SF = factor(faixa_SF, levels = faixas_niveis),\n    tipo_SF  = factor(tipo_SF,  levels = sf_levels)\n  )\n\n\n# Classificação mantendo sinal\nall_contrasts_sup &lt;- all_contrasts_sup %&gt;%\n   mutate(\n    tipo_SF = fct_recode(tipo_SF,\n                         \"SF early\" = \"SF_early\",\n                         \"SF intermediate\" = \"SF_intermediate\",\n                         \"SF advanced\" = \"SF_advanced\")\n  ) %&gt;% \n    mutate(\n    estimate_class = case_when(\n      estimate &lt; -0.6 ~ \"&lt;-0.6\",\n      estimate &gt;= -0.6 & estimate &lt; -0.3 ~ \"-0.3 – -0.6\",\n      estimate &gt;= -0.3 & estimate &lt; 0 ~ \"0 – -0.3\",\n      estimate &gt;= 0 ~ \"&gt;0\"\n    ),\n    estimate_class = factor(estimate_class, levels = c(\"&lt;-0.6\", \"-0.3 – -0.6\", \"0 – -0.3\", \"&gt;0\"))\n  )\n\n\n# Plot\nheatmap_all_contrasts &lt;- ggplot(all_contrasts_sup, \n                        aes(x = faixa_SF, y = faixa_PF, fill = estimate_class)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = sig_label), color = \"black\", size = 3, family = \"serif\") +\n  scale_fill_manual(values = c(\n  \"&lt;-0.6\" = \"#2166AC\",\n  \"-0.3 – -0.6\" = \"#4393C3\",\n  \"0 – -0.3\" = \"#92C5DE\",\n  \"&gt;0\" = \"#F4A582\"\n), name = expression(bold(atop(Delta~\"LST (PF - SF)\", \"(°C·yr\"^{-1}*\")\"))))+\n  facet_grid(tipo_SF ~ region) +\n  theme_minimal(base_family = \"serif\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(size = 12, face = \"bold\"),\n    axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\")\n  ) +\n   labs(x = \"SF fractional cover (%)\",\n        y = \"PF fractional cover (%)\")\n\nheatmap_all_contrasts\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_temp.png\", width = 10, height = 8, dpi = 600, bg = \"white\")\n\nggsave(\"fig/supplemental_material/contrastes_fixed_efects_temp.pdf\", width = 10, height = 8, bg = \"white\")\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 5075648 271.1    7437491 397.3  7437491 397.3\nVcells 9880754  75.4   17824054 136.0 17824054 136.0\n\n\n\n\n\nRandom effect\n\n# Função para extrair efeitos aleatórios com IC por região\nextract_random_effects &lt;- function(model, region_name) {\n  # Efeitos aleatórios com variância condicional\n  ran &lt;- ranef(model, condVar = TRUE)\n  \n  # Extrair efeitos por ano\n  ran_df &lt;- as.data.frame(ran$Ano)\n  names(ran_df) &lt;- \"effect\"\n  ran_df$ano &lt;- rownames(ran$Ano)\n  \n  # Intervalos de confiança (erro padrão)\n  se &lt;- attr(ran$Ano, \"postVar\")[1, 1, ] |&gt; sqrt()\n  \n  ran_df &lt;- ran_df %&gt;%\n    mutate(\n      se = se,\n      lower = effect - 1.96 * se,\n      upper = effect + 1.96 * se,\n      region = region_name\n    )\n  \n  return(ran_df)\n}\n\n# Aplicar para os três modelos (substitua pelos seus objetos reais)\nrandom_cba &lt;- extract_random_effects(model_CBA_temp_w1, \"CBA\")\nrandom_eba &lt;- extract_random_effects(model_EBA_temp_w1, \"EBA\")\nrandom_sba &lt;- extract_random_effects(model_SBA_temp_w1, \"SBA\")\n\n# Combinar tudo\nrandom_all &lt;- bind_rows(random_cba, random_eba, random_sba)\n\n# Garantir que o ano seja ordenável\nrandom_all$ano &lt;- as.numeric(as.character(random_all$ano))\n\n# Salvar\nwrite_xlsx(random_all, \"data_group/random_effects_temp.xlsx\")\n\n\nPlot\n\n# Plot\np1_rand_temp &lt;- ggplot(random_all, aes(x = ano, y = effect)) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray40\") +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha = 0.8, fill = \"#E08214\") +\n  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.5, color = \"black\") +\n  facet_wrap(~region, scales = \"free_x\") +\n  scale_x_continuous(breaks = seq(2001, 2021, by = 2)) + \n  ggthemes::theme_few() +\n    theme(\n      text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n      axis.text = element_text(size = 10, face = \"plain\", family = \"serif\", color = \"black\"),\n      axis.text.x = element_text(angle = 45, hjust = 1),\n      axis.title = element_text(size = 14),\n      #strip.text = element_text(face = \"bold\", size = 13)) +\n      strip.text = element_blank()) +\n  labs(\n    x = \"\",\n    y = expression(bold(atop(\"Temperature\", \"random effects (°C·yr\"^{-1}*\")\")))\n  )\n\np1_rand_temp\n\n\n\n\n\n\n\nggsave(\"fig/histogram_random_temp.png\", bg = \"white\", dpi = 600, width = 9, height = 5.5)\n\n\n\n\nPredicted\n\nPlot\n\nmodel_cba_temp$predicted &lt;- predict(model_CBA_temp_w1, model_cba_temp)\nmodel_eba_temp$predicted &lt;- predict(model_EBA_temp_w1, model_eba_temp)\nmodel_sba_temp$predicted &lt;- predict(model_SBA_temp_w1, model_sba_temp)\n\nr2_cba_temp_lab &lt;- r2_lmer_w(model_CBA_temp_w1, model_cba_temp, type = \"cond\")\nr2_eba_temp_lab &lt;- r2_lmer_w(model_EBA_temp_w1, model_eba_temp, type = \"cond\")\nr2_sba_temp_lab &lt;- r2_lmer_w(model_SBA_temp_w1, model_sba_temp, type = \"cond\")\n\n\nall_vals &lt;- c(model_cba_temp$Temp, model_cba_temp$predicted,\n              model_eba_temp$Temp, model_eba_temp$predicted,\n              model_sba_temp$Temp, model_sba_temp$predicted)\n\nrng     &lt;- range(all_vals, na.rm = TRUE)\npad     &lt;- 0.02 * diff(rng)\nlim_min &lt;- floor((rng[1] - pad) / 0.5) * 0.5\nlim_max &lt;- ceiling((rng[2] + pad) / 0.5) * 0.5\nbrks    &lt;- seq(lim_min, lim_max, by = 0.5)\n\n# Função base do gráfico (escala 1:1 e linha 45°)\nmake_plot &lt;- function(dat, titulo, subtitulo){\n  ggplot(dat, aes(Temp, predicted)) +\n    geom_point(size = 2, alpha = .7, na.rm = TRUE) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"orange\", na.rm = TRUE) +\n    geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"grey40\") +\n    scale_x_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +   \n    scale_y_continuous(limits = c(lim_min, lim_max), breaks = brks,\n                       expand = expansion(mult = 0.01)) +\n    theme_minimal() +\n    labs(x = \"Observed LST (°C·yr⁻¹)\", \n         y = \"Predicted LST (°C·yr⁻¹)\",\n         title = titulo, subtitle = subtitulo)\n}\n\n\n\nPainel\n\n# Plots\ncba_pf &lt;- make_plot(model_cba_temp, \"\", paste0(\"R² = \", round(r2_cba_temp_lab, 3), \" | CCC = \", ccc_val_cba_temp))\neba_pf &lt;- make_plot(model_eba_temp, \"\", paste0(\"R² = \", round(r2_eba_temp_lab, 3), \" | CCC = \", ccc_val_eba_temp)) + labs(y = NULL)\nsba_pf &lt;- make_plot(model_sba_temp, \"\", paste0(\"R² = \", round(r2_sba_temp_lab, 3), \" | CCC = \", ccc_val_sba_temp)) + labs(y = NULL)\n\n\n# Painel\np3_pred_temp &lt;- (cba_pf + eba_pf + sba_pf) +\n  patchwork::plot_layout(ncol = 3, nrow = 1, guides = \"collect\") +\n  theme(\n    text = element_text(size = 12, face = \"bold\", family = \"serif\"),\n    axis.text  = element_text(size = 10, face = \"plain\", family = \"serif\"),\n    axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, family = \"serif\")\n  )\n\np3_pred_temp\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_observed_temp.png\", bg = \"white\", dpi = 600, width = 12, height = 5.5)\n\ngc()\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 5134822 274.3    7437491 397.3  7437491 397.3\nVcells 9966281  76.1   17824054 136.0 17824054 136.0\n\n\n\n\n\nModel plotting\n\nCBA\n\n# Atribuindo os dados\nmodel_cba_all_temp &lt;- model_cba_temp %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_CBA_temp_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_cba_all_temp &lt;- model_cba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\n\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_cba_all_temp[model_cba_all_temp$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_cba_all_temp[model_cba_all_temp$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_cba_all_temp[model_cba_all_temp$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_cba_all_temp[model_cba_all_temp$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_cba_all_temp[model_cba_all_temp$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_cba_all_temp &lt;- model_cba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_temp_cba &lt;- model_cba_all_temp %&gt;%\n  ggplot(aes(x = area * 10, y = Temp, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  scale_y_continuous(breaks = seq(24, 27, by = 0.5)) +\n  ggthemes::theme_few() +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted temperature (°C) - CBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_temp_cba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_temp_CBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nEBA\n\n# Atribuindo os dados\nmodel_eba_all_temp &lt;- model_eba_temp %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_EBA_temp_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_eba_all_temp &lt;- model_eba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_eba_all_temp[model_eba_all_temp$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_eba_all_temp[model_eba_all_temp$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_eba_all_temp[model_eba_all_temp$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_eba_all_temp[model_eba_all_temp$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_eba_all_temp[model_eba_all_temp$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_eba_all_temp &lt;- model_eba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\n\nm1_temp_eba &lt;- model_eba_all_temp %&gt;%\n  ggplot(aes(x = area * 10, y = Temp, color = vegetation)) +  # Define 'color' no aes\n  theme_bw() +\n  geom_point(size = 1, alpha = 0.7) +  # Ajusta tamanho e transparência dos pontos\n  geom_line(aes(y = predicted, group = vegetation), size = 1) +  # Mantém cor no grupo\n  scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n  scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(23, 27, by = 0.5)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted temperature (°C) - EBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  \n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_temp_eba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_temp_EBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)\n\n\n\nSBA\n\n# Atribuindo os dados\nmodel_sba_all_temp &lt;- model_sba_temp %&gt;%\n  mutate(\n    area = as.integer(ff_area),             \n    vegetation = as.character(Tipo),         \n    predicted = predict(model_SBA_temp_w1)  \n  )\n\n# Reordenar níveis (se quiser controlar a legenda)\nmodel_sba_all_temp &lt;- model_sba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation,\n                             levels = c(\"PF\",\"SF_early\",\"SF_intermediate\",\"SF_advanced\")))\n\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"1-10\",\n                     c(\"area\")]&lt;-1\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"10-20\",\n                     c(\"area\")]&lt;-2\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"20-30\",\n                     c(\"area\")]&lt;-3\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"30-40\",\n                     c(\"area\")]&lt;-4\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"40-50\",\n                     c(\"area\")]&lt;-5\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"50-60\",\n                     c(\"area\")]&lt;-6\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"60-70\",\n                     c(\"area\")]&lt;-7\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"70-80\",\n                     c(\"area\")]&lt;-8\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"80-90\",\n                     c(\"area\")]&lt;-9\nmodel_sba_all_temp[model_sba_all_temp$ff_area== \"90-100\",\n                     c(\"area\")]&lt;-10\n\nmodel_sba_all_temp[model_sba_all_temp$type== 1,\n                     c(\"vegetation\")]&lt;-\"PF\"\nmodel_sba_all_temp[model_sba_all_temp$type== 2,\n                     c(\"vegetation\")]&lt;-\"SF_early\"\nmodel_sba_all_temp[model_sba_all_temp$type== 3,\n                     c(\"vegetation\")]&lt;-\"SF_intermediate\"\nmodel_sba_all_temp[model_sba_all_temp$type== 4,\n                     c(\"vegetation\")]&lt;-\"SF_advanced\"\n\n\n# Reordenar os níveis de 'Tipo'\nmodel_sba_all_temp &lt;- model_sba_all_temp %&gt;%\n  mutate(vegetation = factor(vegetation, levels = c(\"PF\", \"SF_early\", \"SF_intermediate\", \"SF_advanced\")))\n\nm1_temp_sba &lt;- model_sba_all_temp %&gt;%\n  ggplot(aes(x = area*10, y = Temp))+\n  theme_bw()+\n  geom_point(aes(x = area*10, y = Temp, color = vegetation)) + \n  geom_line(aes(y = predicted, group = vegetation, color = vegetation), size = 1)+\n    scale_color_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                     name = NULL,  \n                     labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +  \n    scale_fill_manual(values = c(\"darkgreen\", \"#ACD39E\", \"#5AAE61\", \"#1B7837\"), \n                    name = NULL,  \n                    labels = c(\"PF\", \"SF early\", \"SF intermediate\", \"SF advanced\")) +\n  scale_y_continuous(breaks = seq(23, 27, by = 0.5)) +\n  ggthemes::theme_few() +\n  facet_wrap(~Ano, nrow = 4, ncol = 6) +\n  labs(x = \"Fractional forest coverage (%)\", \n       y = \"Predicted temperature (°C) - SBA\",\n       color = \"\") +\n  theme(legend.position = \"top\",\n        text = element_text(family = \"serif\"),\n        axis.title = element_text(size = 16, face = \"bold\"),\n        strip.text = element_text(face = \"bold\", size = 12),\n        legend.text = element_text(size = 14, face = \"bold\"),  # Tamanho do texto da legenda\n        legend.title = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),  # Centraliza título\n        axis.text = element_text(size = 12))\n\nm1_temp_sba\n\n\n\n\n\n\n\nggsave(\"fig/supplemental_material/predicted_temp_SBA.png\", bg = \"white\",\n       dpi = 600, width = 10, height = 8)"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#painel-predict-all-variables",
    "href": "code_climate_forest_regeneration.html#painel-predict-all-variables",
    "title": "Packages",
    "section": "Painel Predict all variables",
    "text": "Painel Predict all variables\n\n# Combinar os três painéis em um único layout 3x3\npainel_pred_fixed &lt;- ggarrange(\n  p1_pred_prec, p2_pred_evapo, p3_pred_temp,\n  ncol = 1, nrow = 3,\n  labels = c(\"A\", \"B\", \"C\"),\n  font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n  align = \"v\",\n  heights = c(1, 1, 1)\n)\n\n# Visualizar\npainel_pred_fixed\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/predicted_observed_all_vars.png\",\n       plot = painel_pred_fixed,\n       bg = \"white\", dpi = 600, width = 10, height = 12)\n\n\nHeterocedasticidade\n\n# Combinar os três painéis em um único layout 3x3\npainel_het &lt;- ggarrange(\n  painel_het_prec, painel_het_evapo, painel_het_temp,\n  ncol = 1, nrow = 3,\n  labels = c(\"A\", \"B\", \"C\"),\n  font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n  align = \"v\",\n  heights = c(1, 1, 1)\n)\n\n# Visualizar\npainel_het\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/hetero_residuals_lme_all_vars.png\",\n       plot = painel_het,\n       bg = \"white\", dpi = 600, width = 10, height = 12)\n\n\n\nQQ Plot\n\n# Combinar os três painéis em um único layout 3x3\npainel_qq &lt;- ggarrange(\n  painel_qq_prec, painel_qq_evapo, painel_qq_temp,\n  ncol = 1, nrow = 3,\n  labels = c(\"A\", \"B\", \"C\"),\n  font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n  align = \"v\",\n  heights = c(1, 1, 1)\n)\n\n# Visualizar\npainel_qq\n\n\n\n\n\n\n\n# Salvar\nggsave(\"fig/supplemental_material/qqplot_all_vars.png\",\n       plot = painel_qq,\n       bg = \"white\", dpi = 600, width = 10, height = 12)"
  },
  {
    "objectID": "code_climate_forest_regeneration.html#painel-fixed-and-random-effects",
    "href": "code_climate_forest_regeneration.html#painel-fixed-and-random-effects",
    "title": "Packages",
    "section": "Painel fixed and random effects",
    "text": "Painel fixed and random effects\n\n# Fixed Effects\n\n  # Ajuste das margens\n  p1_point_prec &lt;- final_panel_prec + \n  scale_x_discrete(expand = c(0.05, 0.05)) + \n  theme(plot.margin = margin(t = 10, r = 20, b = 5, l = 30))\n\n  p1_point_evapo &lt;- final_panel_evapo + \n    scale_x_discrete(expand = c(0.05, 0.05)) + \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 30)) \n  \n  p1_point_temp &lt;- final_panel_temp + \n    scale_x_discrete(expand = c(0.05, 0.05)) + \n    theme(plot.margin = margin(t = 5, r = 20, b = 10, l = 30))\n  \n  \n  # Criar painel com espaçamento ajustado\n  painel_fixed &lt;- ggarrange(\n    p1_point_prec, p1_point_evapo, p1_point_temp,\n    ncol = 1, nrow = 3,\n    labels = c(\"A\", \"B\", \"C\"),  # Letras dos subplots\n    font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n    align = \"v\",                # Alinhamento vertical\n    heights = c(1, 1, 1)        # Força os plots a terem alturas iguais\n  )\n  \n  # Salvar figura final\n  ggsave(\"fig/painels/effect_fix_climate_x_fractional_forest.png\", \n         plot = painel_fixed, dpi = 600, width = 10, height = 12, bg = \"white\")\n  \n  ggsave(\"fig/painels/effect_fix_climate_x_fractional_forest.pdf\", \n         plot = painel_fixed, device = cairo_pdf, width = 10, height = 12, bg = \"white\")\n\n  painel_fixed\n\n\n\n\n\n\n\n# Random Effects\n  \n  # Ajuste das margens\n  p1_rand_prec &lt;- p1_rand_prec + \n    scale_x_discrete(expand = c(0.05, 0.05)) + \n    theme(plot.margin = margin(t = 10, r = 10, b = 5, l = 20))\n  \n  p2_rand_evapo &lt;- p1_rand_evapo + \n    scale_x_discrete(expand = c(0.05, 0.05)) + \n    theme(plot.margin = margin(t = 5, r = 10, b = 5, l = 20)) \n  \n  p3_rand_temp &lt;- p1_rand_temp + \n    #scale_x_discrete(expand = c(0.05, 0.05)) + \n    theme(plot.margin = margin(t = 5, r = 10, b = 10, l = 20))\n  \n  \n  # Criar painel com espaçamento ajustado\n  painel_random &lt;- ggarrange(\n    p1_rand_prec, p2_rand_evapo, p3_rand_temp,\n    ncol = 1, nrow = 3,\n    labels = c(\"A\", \"B\", \"C\"),  # Letras dos subplots\n    font.label = list(color = \"black\", face = \"bold\", size = 14, family = \"serif\"),\n    align = \"v\",                # Alinhamento vertical\n    heights = c(1, 1, 1)        # Força os plots a terem alturas iguais\n  )\n  \n  painel_random\n\n\n\n\n\n\n\n  # Salvar figura final\n  ggsave(\"fig/painels/effect_rand_pf_sf.png\",\n         dpi = 600, width = 10, height = 12, bg = \"white\")\n  \n  ggsave(\"fig/painels/effect_rand_pf_sf.pdf\",\n         width = 10, height = 12, bg = \"white\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "About\n\n\n\n\nThis study investigates the influence of fractional forest cover on annual precipitation, evapotranspiration, and land surface temperature, comparing areas of primary forest with those of secondary forest. In addition, we examine how secondary forests at different successional stages contribute to local climate regulation (within 1 km × 1 km grid cells) across three regions of the Brazilian Amazon: central (CBA), eastern (EBA), and southern (SBA)."
  }
]