<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>code_climate_forest_regeneration – Climate and forest regeneration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Climate and forest regeneration</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><i class="bi bi-book-half"></i> About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./code_climate_forest_regeneration.html" aria-current="page"> 
<span class="menu-text"><i class="bi bi-bar-chart-fill"></i> Data Analysis</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/LaisRosaOliveira/paper_climate_forest_regeneration"> 
<span class="menu-text"><i class="bi bi-github"></i> GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/lais-rosa-a68975253/"> 
<span class="menu-text"><i class="bi bi-linkedin"></i> Linkedin</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#leitura-e-pré-processamento" id="toc-leitura-e-pré-processamento" class="nav-link" data-scroll-target="#leitura-e-pré-processamento">Leitura e pré-processamento</a>
  <ul class="collapse">
  <li><a href="#filtragem---pixels-não-puros" id="toc-filtragem---pixels-não-puros" class="nav-link" data-scroll-target="#filtragem---pixels-não-puros">Filtragem - Pixels “não-puros”</a></li>
  <li><a href="#plot---observações" id="toc-plot---observações" class="nav-link" data-scroll-target="#plot---observações">Plot - Observações</a></li>
  </ul></li>
  <li><a href="#boxplots---fraction-area-x-climate-variable" id="toc-boxplots---fraction-area-x-climate-variable" class="nav-link" data-scroll-target="#boxplots---fraction-area-x-climate-variable">Boxplots - Fraction area x climate variable</a>
  <ul class="collapse">
  <li><a href="#precipitation" id="toc-precipitation" class="nav-link" data-scroll-target="#precipitation">PRECIPITATION</a>
  <ul class="collapse">
  <li><a href="#leitura-dos-dados" id="toc-leitura-dos-dados" class="nav-link" data-scroll-target="#leitura-dos-dados">Leitura dos dados</a></li>
  <li><a href="#agrupamento" id="toc-agrupamento" class="nav-link" data-scroll-target="#agrupamento">Agrupamento</a></li>
  <li><a href="#testes-normalidade-homocedasticidade-e-independência" id="toc-testes-normalidade-homocedasticidade-e-independência" class="nav-link" data-scroll-target="#testes-normalidade-homocedasticidade-e-independência">Testes normalidade, homocedasticidade e independência</a></li>
  <li><a href="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf" id="toc-teste-t-entre-os-tipos-de-cobertura---pf-e-sf" class="nav-link" data-scroll-target="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf">Teste t entre os tipos de cobertura - PF e SF</a></li>
  <li><a href="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf" id="toc-teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf" class="nav-link" data-scroll-target="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf">Teste Wilcox entre os tipos de cobertura - PF e SF</a></li>
  </ul></li>
  <li><a href="#evapotranspiration" id="toc-evapotranspiration" class="nav-link" data-scroll-target="#evapotranspiration">EVAPOTRANSPIRATION</a>
  <ul class="collapse">
  <li><a href="#agrupamento-1" id="toc-agrupamento-1" class="nav-link" data-scroll-target="#agrupamento-1">Agrupamento</a></li>
  <li><a href="#testes-normalidade-homocedasticidade-e-independência-1" id="toc-testes-normalidade-homocedasticidade-e-independência-1" class="nav-link" data-scroll-target="#testes-normalidade-homocedasticidade-e-independência-1">Testes normalidade, homocedasticidade e independência</a></li>
  <li><a href="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf-1" id="toc-teste-t-entre-os-tipos-de-cobertura---pf-e-sf-1" class="nav-link" data-scroll-target="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf-1">Teste t entre os tipos de cobertura - PF e SF</a></li>
  <li><a href="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-1" id="toc-teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-1" class="nav-link" data-scroll-target="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-1">Teste Wilcox entre os tipos de cobertura - PF e SF</a></li>
  </ul></li>
  <li><a href="#tempertaure" id="toc-tempertaure" class="nav-link" data-scroll-target="#tempertaure">TEMPERTAURE</a>
  <ul class="collapse">
  <li><a href="#agrupamento-2" id="toc-agrupamento-2" class="nav-link" data-scroll-target="#agrupamento-2">Agrupamento</a></li>
  <li><a href="#testes-normalidade-homocedasticidade-e-independência-2" id="toc-testes-normalidade-homocedasticidade-e-independência-2" class="nav-link" data-scroll-target="#testes-normalidade-homocedasticidade-e-independência-2">Testes normalidade, homocedasticidade e independência</a></li>
  <li><a href="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf-2" id="toc-teste-t-entre-os-tipos-de-cobertura---pf-e-sf-2" class="nav-link" data-scroll-target="#teste-t-entre-os-tipos-de-cobertura---pf-e-sf-2">Teste t entre os tipos de cobertura - PF e SF</a></li>
  <li><a href="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-2" id="toc-teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-2" class="nav-link" data-scroll-target="#teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-2">Teste Wilcox entre os tipos de cobertura - PF e SF</a></li>
  </ul></li>
  <li><a href="#painel-all-variables---observation" id="toc-painel-all-variables---observation" class="nav-link" data-scroll-target="#painel-all-variables---observation">Painel all variables - observation</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a>
  <ul class="collapse">
  <li><a href="#precipitation-1" id="toc-precipitation-1" class="nav-link" data-scroll-target="#precipitation-1">PRECIPITATION</a>
  <ul class="collapse">
  <li><a href="#model-choice" id="toc-model-choice" class="nav-link" data-scroll-target="#model-choice">Model choice</a></li>
  <li><a href="#fixed-effect" id="toc-fixed-effect" class="nav-link" data-scroll-target="#fixed-effect">Fixed effect</a></li>
  <li><a href="#painel-prec" id="toc-painel-prec" class="nav-link" data-scroll-target="#painel-prec">Painel Prec</a></li>
  <li><a href="#random-effect" id="toc-random-effect" class="nav-link" data-scroll-target="#random-effect">Random effect</a></li>
  <li><a href="#predicted" id="toc-predicted" class="nav-link" data-scroll-target="#predicted">Predicted</a></li>
  <li><a href="#model-plotting" id="toc-model-plotting" class="nav-link" data-scroll-target="#model-plotting">Model plotting</a></li>
  </ul></li>
  <li><a href="#evapotranspiration-1" id="toc-evapotranspiration-1" class="nav-link" data-scroll-target="#evapotranspiration-1">EVAPOTRANSPIRATION</a>
  <ul class="collapse">
  <li><a href="#model-choice-1" id="toc-model-choice-1" class="nav-link" data-scroll-target="#model-choice-1">Model choice</a></li>
  <li><a href="#fixed-effect-1" id="toc-fixed-effect-1" class="nav-link" data-scroll-target="#fixed-effect-1">Fixed effect</a></li>
  <li><a href="#painel-evapo" id="toc-painel-evapo" class="nav-link" data-scroll-target="#painel-evapo">Painel Evapo</a></li>
  <li><a href="#random-effect-1" id="toc-random-effect-1" class="nav-link" data-scroll-target="#random-effect-1">Random effect</a></li>
  <li><a href="#predicted-1" id="toc-predicted-1" class="nav-link" data-scroll-target="#predicted-1">Predicted</a></li>
  <li><a href="#model-plotting-1" id="toc-model-plotting-1" class="nav-link" data-scroll-target="#model-plotting-1">Model plotting</a></li>
  </ul></li>
  <li><a href="#temperature" id="toc-temperature" class="nav-link" data-scroll-target="#temperature">TEMPERATURE</a>
  <ul class="collapse">
  <li><a href="#model-choice-2" id="toc-model-choice-2" class="nav-link" data-scroll-target="#model-choice-2">Model choice</a></li>
  <li><a href="#fixed-effect-2" id="toc-fixed-effect-2" class="nav-link" data-scroll-target="#fixed-effect-2">Fixed effect</a></li>
  <li><a href="#painel-temp" id="toc-painel-temp" class="nav-link" data-scroll-target="#painel-temp">Painel Temp</a></li>
  <li><a href="#random-effect-2" id="toc-random-effect-2" class="nav-link" data-scroll-target="#random-effect-2">Random effect</a></li>
  <li><a href="#predicted-2" id="toc-predicted-2" class="nav-link" data-scroll-target="#predicted-2">Predicted</a></li>
  <li><a href="#model-plotting-2" id="toc-model-plotting-2" class="nav-link" data-scroll-target="#model-plotting-2">Model plotting</a></li>
  </ul></li>
  <li><a href="#painel-predict-all-variables" id="toc-painel-predict-all-variables" class="nav-link" data-scroll-target="#painel-predict-all-variables">Painel Predict all variables</a>
  <ul class="collapse">
  <li><a href="#heterocedasticidade-3" id="toc-heterocedasticidade-3" class="nav-link" data-scroll-target="#heterocedasticidade-3">Heterocedasticidade</a></li>
  <li><a href="#qq-plot-3" id="toc-qq-plot-3" class="nav-link" data-scroll-target="#qq-plot-3">QQ Plot</a></li>
  </ul></li>
  <li><a href="#painel-fixed-and-random-effects" id="toc-painel-fixed-and-random-effects" class="nav-link" data-scroll-target="#painel-fixed-and-random-effects">Painel fixed and random effects</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="packages" class="level1">
<h1>Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtable)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunn.test)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="leitura-e-pré-processamento" class="level1">
<h1>Leitura e pré-processamento</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planilha com todos os dados</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>all_PF_SF <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/plans_results/plan_final/all_vars_2001-2021_with_age.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Colunas de all_PF_SF</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lon   Lat   Region   Ano    Tipo    Prec    Evapo    Temp   frac_area   Idade_SF</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de dados por região ANTES da filtragem</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>n_obs_cba_a <span class="ot">&lt;-</span> all_PF_SF <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"CBA"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>n_obs_eba_a <span class="ot">&lt;-</span> all_PF_SF <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"EBA"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>n_obs_sba_a <span class="ot">&lt;-</span> all_PF_SF <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"SBA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colocando em uma única linha as frações de área de todos os usos de uma mesma lat, lon</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>all_lulc <span class="ot">&lt;-</span> <span class="fu">dcast</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  all_PF_SF, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  Lon <span class="sc">+</span> Lat <span class="sc">+</span> Prec <span class="sc">+</span> Evapo <span class="sc">+</span> Temp <span class="sc">+</span> Region <span class="sc">+</span> Ano <span class="sc">+</span> Idade_SF <span class="sc">~</span> Tipo, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">value.var =</span> <span class="st">"frac_area"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun.aggregate =</span> sum, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="dv">0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Para cada pixel foi criado uma coluna de fração de área para cada tipo de uso/cobertura</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Dessa forma, sabemos quanto de cada uso/cobertura tem dentro de cada pixel</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Renomear colunas para manter o padrão desejado</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(all_lulc, <span class="at">old =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF"</span>, <span class="st">"Agriculture"</span>, <span class="st">"Pasture"</span>), </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"frac_area_PF"</span>, <span class="st">"frac_area_SF"</span>, <span class="st">"frac_area_Agriculture"</span>, <span class="st">"frac_area_Pasture"</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Colunas de all_lulc</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Lon    Lat    Prec    Evapo    Temp    Region   Ano   Idade_SF   frac_area_Agriculture   frac_area_Pasture   frac_area_PF   frac_area_SF</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(all_PF_SF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="filtragem---pixels-não-puros" class="level2">
<h2 class="anchored" data-anchor-id="filtragem---pixels-não-puros">Filtragem - Pixels “não-puros”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condicionais</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>all_lulc_fil_50 <span class="ot">&lt;-</span> all_lulc <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PF ausente e SF predominante</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    (frac_area_SF <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> frac_area_PF <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SF baixo sem outros usos dominantes</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    (frac_area_SF <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_SF <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>     (frac_area_PF <span class="sc">+</span> frac_area_Agriculture <span class="sc">+</span> frac_area_Pasture) <span class="sc">&lt;</span> frac_area_SF) <span class="sc">|</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SF ausente e PF predominante</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    (frac_area_SF <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_PF <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">|</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PF baixo sem outros usos dominantes</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    (frac_area_PF <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_PF <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>     (frac_area_Agriculture <span class="sc">+</span> frac_area_Pasture <span class="sc">+</span> frac_area_SF) <span class="sc">&lt;</span> frac_area_PF) <span class="sc">|</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Para avaliar o histórico é importante ter os casos abaixo  </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Florestas ausentes e AG presente</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    (frac_area_SF <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_PF <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_Agriculture <span class="sc">&gt;=</span> <span class="fl">0.1</span>) <span class="sc">|</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Florestas ausentes e Pasture presente</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    (frac_area_SF <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_PF <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> frac_area_Pasture <span class="sc">&gt;=</span> <span class="fl">0.1</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar planilha filtrada</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(all_lulc_fil_50, <span class="at">file =</span> <span class="st">"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_fil_all_lulc.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar colunas de fração de volta para formato original</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>all_lulc_long_50 <span class="ot">&lt;-</span> <span class="fu">melt</span>(all_lulc_fil_50, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"Lon"</span>, <span class="st">"Lat"</span>, <span class="st">"Prec"</span>, <span class="st">"Evapo"</span>, <span class="st">"Temp"</span>, <span class="st">"Region"</span>, <span class="st">"Ano"</span>, <span class="st">"Idade_SF"</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variable.name =</span> <span class="st">"Tipo"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value.name =</span> <span class="st">"frac_area"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter para data.table antes de usar :=</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(all_lulc_long_50)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar nomes de Tipo para corresponder ao original</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>all_lulc_long_50[, Tipo <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">"frac_area_"</span>, <span class="st">""</span>, Tipo)]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Remover pixels onde a fração de área é 1% (~1 ha)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>all_lulc_50_final <span class="ot">&lt;-</span> all_lulc_long_50[frac_area <span class="sc">&gt;</span> <span class="fl">0.01</span>]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Exportar</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(all_lulc_50_final, <span class="at">file =</span> <span class="st">"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(all_lulc)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(all_lulc_fil_50)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(all_lulc_long_50)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(all_lulc_50_final)</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contagem de dados por região DEPOIS da filtragem</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>n_obs_cba_d <span class="ot">&lt;-</span> all_lulc_50_final <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"CBA"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>n_obs_eba_d <span class="ot">&lt;-</span> all_lulc_50_final <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"EBA"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>n_obs_sba_d <span class="ot">&lt;-</span> all_lulc_50_final <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"SBA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot---observações" class="level2">
<h2 class="anchored" data-anchor-id="plot---observações">Plot - Observações</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Obter contagens</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>before <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">CBA =</span> <span class="fu">nrow</span>(n_obs_cba_a),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">EBA =</span> <span class="fu">nrow</span>(n_obs_eba_a),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SBA =</span> <span class="fu">nrow</span>(n_obs_sba_a)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CBA =</span> <span class="fu">nrow</span>(n_obs_cba_d),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">EBA =</span> <span class="fu">nrow</span>(n_obs_eba_d),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">SBA =</span> <span class="fu">nrow</span>(n_obs_sba_d)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>reducoes_percentuais <span class="ot">&lt;-</span> <span class="fu">round</span>((before <span class="sc">-</span> after) <span class="sc">/</span> before <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>regioes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame em formato longo com valores intercalados</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Regiao =</span> <span class="fu">rep</span>(regioes, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Status =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Before"</span>, <span class="st">"After"</span>), <span class="at">times =</span> <span class="dv">3</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Before"</span>, <span class="st">"After"</span>)),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observacoes =</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(before, after))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Posição dos rótulos acima de cada barra correspondente</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>df_text <span class="ot">&lt;-</span> df_plot <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Regiao) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">y_pos =</span> <span class="fu">max</span>(Observacoes) <span class="sc">*</span> <span class="fl">1.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_pos =</span> Regiao,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reducao =</span> <span class="fu">paste0</span>(<span class="st">"-"</span>, reducoes_percentuais, <span class="st">"%"</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Esse gráfio já inclui observações de Agriulture e Pasture</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co"># O gráfico com o número de observações sem esses usos foi gerado antes</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> Regiao, <span class="at">y =</span> Observacoes, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> df_text, <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> y_pos, <span class="at">label =</span> Reducao),</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Before"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, <span class="st">"After"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of observations (pixels)"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.90</span>),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando a figura</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("fig/observatios_before_after.png", dpi = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(n_obs_cba_a, n_obs_eba_a, n_obs_sba_a)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(n_obs_cba_d, n_obs_eba_d, n_obs_sba_d)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_plot, df_text)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="boxplots---fraction-area-x-climate-variable" class="level1">
<h1>Boxplots - Fraction area x climate variable</h1>
<section id="precipitation" class="level2">
<h2 class="anchored" data-anchor-id="precipitation">PRECIPITATION</h2>
<section id="leitura-dos-dados" class="level3">
<h3 class="anchored" data-anchor-id="leitura-dos-dados">Leitura dos dados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo a planilha</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>all_lulc_50_final <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>all_lulc_50_fil <span class="ot">&lt;-</span> all_lulc_50_final <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(Tipo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF"</span>, <span class="st">"PF"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(all_lulc_50_final)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>n_obs_cba_d <span class="ot">&lt;-</span> all_lulc_50_fil <span class="sc">%&gt;%</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"CBA"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>n_obs_eba_d <span class="ot">&lt;-</span> all_lulc_50_fil <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"EBA"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>n_obs_sba_d <span class="ot">&lt;-</span> all_lulc_50_fil <span class="sc">%&gt;%</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Region <span class="sc">==</span> <span class="st">"SBA"</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="agrupamento" class="level3">
<h3 class="anchored" data-anchor-id="agrupamento">Agrupamento</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar intervalos de fração de área </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>all_lulc_prec <span class="ot">&lt;-</span> all_lulc_50_fil <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prec =</span> Prec,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frac =</span> frac_area,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> Tipo,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ano =</span> Ano,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> Region,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Idade =</span> Idade_SF</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">case_when</span>(Frac <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"1-10"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"20-30"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.3</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"30-40"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"40-50"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"50-60"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"60-70"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.7</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"70-80"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">"80-90"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">1.0</span> <span class="sc">~</span> <span class="st">"90-100"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">idade =</span> <span class="fu">case_when</span>(Idade <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"&lt;= 10"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"&gt; 20"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular a precipitação média para cada agrupamento</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Ano, Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span> </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prec =</span> <span class="fu">mean</span>(Prec),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar o novo dataframe com as categorias desejadas</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>all_lulc_prec_stages <span class="ot">&lt;-</span> all_lulc_prec <span class="sc">%&gt;%</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="st">"PF"</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&lt;= 10"</span> <span class="sc">~</span> <span class="st">"SF_early"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"10-20"</span> <span class="sc">~</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&gt; 20"</span> <span class="sc">~</span> <span class="st">"SF_advanced"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Tipo))  </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>all_lulc_prec_final <span class="ot">&lt;-</span> all_lulc_prec_stages <span class="sc">%&gt;%</span> </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="dv">4</span>))</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar o resultado</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#head(all_lulc_prec_final)</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular valores máximos e mínimos</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>max_min_prec <span class="ot">=</span> all_lulc_prec_final <span class="sc">%&gt;%</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_prec =</span> <span class="fu">max</span>(Prec),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_prec =</span> <span class="fu">median</span>(Prec),</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_prec =</span> <span class="fu">min</span>(Prec)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar dados min e max</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(max_min_prec, <span class="st">"data_group/plan_max_and_min_group_prec.xlsx"</span>)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar dados agrupados</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_lulc_prec_final, <span class="st">"data_group/plan_data_group_prec.xlsx"</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(all_lulc_prec, all_lulc_prec_stages)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(max_min_prec)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testes-normalidade-homocedasticidade-e-independência" class="level3">
<h3 class="anchored" data-anchor-id="testes-normalidade-homocedasticidade-e-independência">Testes normalidade, homocedasticidade e independência</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_prec.xlsx"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- NORMALIDADE ----</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar o teste de normalidade Shapiro-Wilk </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>shapiro_test_results_prec <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo, region, ff_area) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">shapiro.test</span>(Prec)<span class="sc">$</span>p.value</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar os resultados do teste Shapiro-Wilk</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_test_results_prec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 4
   Tipo  region ff_area p_value
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;
 1 PF    CBA    1-10      0.214
 2 PF    CBA    10-20     0.226
 3 PF    CBA    20-30     0.225
 4 PF    CBA    30-40     0.234
 5 PF    CBA    40-50     0.254
 6 PF    CBA    50-60     0.277
 7 PF    CBA    60-70     0.264
 8 PF    CBA    70-80     0.269
 9 PF    CBA    80-90     0.276
10 PF    CBA    90-100    0.369
# ℹ 110 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados do teste de normalidade</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(shapiro_test_results_prec, <span class="st">"data_group/shapiro_test_prec_results.xlsx"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- HOMOCEDASTICIDADE ----</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantindo que 'Tipo' seja tratado como fator</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec<span class="sc">$</span>Tipo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(all_pf_sf_prec<span class="sc">$</span>Tipo)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>results_list_prec <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_prec<span class="sc">$</span>region)) {</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_prec<span class="sc">$</span>ff_area)) {</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de homocedasticidade Levene</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>        levene_test_prec <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(Prec <span class="sc">~</span> Tipo, <span class="at">data =</span> data_subset)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> levene_test_prec<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]  </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>      results_list_prec[[<span class="fu">length</span>(results_list_prec) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">region =</span> region, </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">ff_area =</span> ff_area, </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">p_value =</span> p_value)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>levene_test_results_prec <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_list_prec)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir os resultados</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(levene_test_results_prec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   region ff_area    p_value
1     CBA    1-10 0.97612362
2     CBA   10-20 0.96298538
3     CBA   20-30 0.90512857
4     CBA   30-40 0.87575188
5     CBA   40-50 0.89582737
6     CBA   50-60 0.80278687
7     CBA   60-70 0.92194092
8     CBA   70-80 0.87427106
9     CBA   80-90 0.46685617
10    CBA  90-100 0.43278138
11    EBA    1-10 0.90631834
12    EBA   10-20 0.79987035
13    EBA   20-30 0.51196046
14    EBA   30-40 0.30137629
15    EBA   40-50 0.32205969
16    EBA   50-60 0.28913497
17    EBA   60-70 0.21004335
18    EBA   70-80 0.39408038
19    EBA   80-90 0.27698009
20    EBA  90-100 0.59767399
21    SBA    1-10 0.96881838
22    SBA   10-20 0.98244171
23    SBA   20-30 0.95976760
24    SBA   30-40 0.90811530
25    SBA   40-50 0.83891510
26    SBA   50-60 0.71954247
27    SBA   60-70 0.61771648
28    SBA   70-80 0.56330832
29    SBA   80-90 0.25748618
30    SBA  90-100 0.05150868</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(levene_test_results_prec, <span class="st">"data_group/levene_test_prec_results.xlsx"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- INDEPENDÊNCIA ----</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>kendall_results_list_prec <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_prec<span class="sc">$</span>region)) {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_prec<span class="sc">$</span>ff_area)) {</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de correlação de Kendall entre 'Prec' e 'Tipo'</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Prec), <span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Tipo), <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>p.value  </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        cor_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>estimate  </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>      cor_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>      kendall_results_list_prec[[<span class="fu">length</span>(kendall_results_list_prec) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">region =</span> region, </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">ff_area =</span> ff_area, </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">cor_value =</span> cor_value,</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> p_value</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>kendall_test_results_prec <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, kendall_results_list_prec)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(kendall_test_results_prec, <span class="st">"data_group/kendall_test_prec_results.xlsx"</span>)</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1551429 82.9    2951642 157.7  2161542 115.5
Vcells 2791174 21.3    8388608  64.0  3893788  29.8</code></pre>
</div>
</div>
</section>
<section id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf" class="level3">
<h3 class="anchored" data-anchor-id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf">Teste t entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------------------</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - PULAR PARA RODAR O TESTE NÃO PARAMÉTRICO </span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------------------</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista dos intervalos de área</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame para armazenar os resultados</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>significance_results_t_prec <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste t para cada comparação com PF</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Prec, sv_early_data<span class="sc">$</span>Prec, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Prec, sv_intermediate_data<span class="sc">$</span>Prec, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Prec, sv_advanced_data<span class="sc">$</span>Prec, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  significance_results_t_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  significance_results_t_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  significance_results_t_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_t_prec, <span class="st">"data_group/significance_results_prec_testt.xlsx"</span>)</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1554154 83.1    2951642 157.7  2951642 157.7
Vcells 2798794 21.4    8388608  64.0  3982319  30.4</code></pre>
</div>
</div>
</section>
<section id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf" class="level3">
<h3 class="anchored" data-anchor-id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf">Teste Wilcox entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura da planilha com os dados</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_prec.xlsx"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Lista dos intervalos de área</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame para armazenar os resultados</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>significance_results_w_prec <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste de Wilcoxon para cada comparação com PF</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Prec, sv_early_data<span class="sc">$</span>Prec, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Prec, sv_intermediate_data<span class="sc">$</span>Prec, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Prec, sv_advanced_data<span class="sc">$</span>Prec, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  significance_results_w_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  significance_results_w_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  significance_results_w_prec[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_w_prec, <span class="st">"data_group/significance_results_prec_Wilcox_test.xlsx"</span>)</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1558202 83.3    2951642 157.7  2951642 157.7
Vcells 2809009 21.5    8388608  64.0  4125073  31.5</code></pre>
</div>
</div>
<section id="plot-com-significance" class="level4">
<h4 class="anchored" data-anchor-id="plot-com-significance">Plot com significance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um dataframe "long" de significância, onde cada linha tem uma região e o intervalo associado</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>long_significance_results_w_prec <span class="ot">&lt;-</span> significance_results_w_prec <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"Comparison"</span>, <span class="at">value =</span> <span class="st">"P_value"</span>, <span class="sc">-</span>Intervalo) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Comparison, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"region"</span>, <span class="st">"Comparison_Type"</span>), <span class="at">sep =</span> <span class="st">"_PF_vs_"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesclar esses resultados com os dados originais</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_prec, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionando uma coluna indicando se o intervalo foi significativo</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec<span class="sc">$</span>Significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(all_pf_sf_prec<span class="sc">$</span>P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular o valor máximo do bigode</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>get_whisker_max <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">boxplot.stats</span>(x)<span class="sc">$</span>stats</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stats[<span class="dv">5</span>]) <span class="co"># stats[5] normalmente corresponde ao valor máximo do bigode</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular a posição do asterisco</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>significance_positions <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ff_area, region, Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_whisker =</span> <span class="fu">get_whisker_max</span>(Prec), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_prec, </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">asterisk_y =</span> max_whisker <span class="sc">+</span> <span class="dv">15</span>, <span class="co"># Ajuste para posicionar acima do bigode</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_adjust =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="fl">0.3</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_pos =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(ff_area, <span class="at">levels =</span> area_ranges)) <span class="sc">+</span> x_adjust</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="co">#head(significance_positions)</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>p_ast_prec_w <span class="ot">&lt;-</span> all_pf_sf_prec <span class="sc">%&gt;%</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> Prec, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>region) <span class="sc">+</span> </span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.77</span>, <span class="fl">0.84</span>),</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>), </span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>), </span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">20</span>)),</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"midnightblue"</span>, <span class="st">"#87CEFA"</span>, <span class="st">"#1E90FF"</span>, <span class="st">"#0000FF"</span>), <span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(all_pf_sf_prec<span class="sc">$</span>Prec, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average annual accumulated </span><span class="sc">\n</span><span class="st"> precipitation (mm)"</span>,</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">#y = expression(atop("Average annual accumulated", paste("precipitation (mm·", yr^{-1}, ")")))</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando os asteriscos</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> significance_positions, <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> asterisk_y, <span class="at">label =</span> <span class="st">"*"</span>),</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>p_ast_prec_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando a figura</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/area_x_prec_pf_sf_significant_asterisco_wilcoxon.png"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1913012 102.2    2951642 157.7  2951642 157.7
Vcells 3479082  26.6    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="evapotranspiration" class="level2">
<h2 class="anchored" data-anchor-id="evapotranspiration">EVAPOTRANSPIRATION</h2>
<section id="agrupamento-1" class="level3">
<h3 class="anchored" data-anchor-id="agrupamento-1">Agrupamento</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo a planilha</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_lulc_50_final = fread("/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv")</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all_lulc_50_fil &lt;- all_lulc_50_final %&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    filter(Tipo %in% c("SF", "PF"))</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating area ranges to store the averages of each range</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>all_lulc_evapo <span class="ot">=</span> all_lulc_50_fil <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Evapo <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Evapo =</span> Evapo,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frac =</span> frac_area,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> Tipo,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ano =</span> Ano,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> Region,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Idade =</span> Idade_SF</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">case_when</span>(Frac <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"1-10"</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"20-30"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.3</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"30-40"</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"40-50"</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"50-60"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"60-70"</span>,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.7</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"70-80"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">"80-90"</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">1.0</span> <span class="sc">~</span> <span class="st">"90-100"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">idade =</span> <span class="fu">case_when</span>(Idade <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"&lt;= 10"</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"&gt; 20"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculating the average evapotranspiration for each cluster</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Ano, Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span> </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Evapo =</span> <span class="fu">mean</span>(Evapo),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar o novo dataframe com as categorias desejadas</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>all_lulc_evapo_stages <span class="ot">&lt;-</span> all_lulc_evapo <span class="sc">%&gt;%</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="st">"PF"</span>, </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&lt;= 10"</span> <span class="sc">~</span> <span class="st">"SF_early"</span>, </span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"10-20"</span> <span class="sc">~</span> <span class="st">"SF_intermediate"</span>, </span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&gt; 20"</span> <span class="sc">~</span> <span class="st">"SF_advanced"</span>,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Tipo))  </span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>all_lulc_evapo_final <span class="ot">&lt;-</span> all_lulc_evapo_stages <span class="sc">%&gt;%</span> </span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="dv">4</span>))</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar o resultado</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="co">#head(all_lulc_evapo_final)</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>max_min_evapo <span class="ot">=</span> all_lulc_evapo_final <span class="sc">%&gt;%</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_evapo =</span> <span class="fu">max</span>(Evapo),</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_evapo =</span> <span class="fu">median</span>(Evapo),</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_evapo =</span> <span class="fu">min</span>(Evapo)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Export data min and max</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(max_min_evapo, <span class="st">"data_group/plan_max_and_min_group_evapo.xlsx"</span>)</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Export data grouped</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_lulc_evapo_final, <span class="st">"data_group/plan_data_group_evapo.xlsx"</span>)</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(all_lulc_50_final)</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testes-normalidade-homocedasticidade-e-independência-1" class="level3">
<h3 class="anchored" data-anchor-id="testes-normalidade-homocedasticidade-e-independência-1">Testes normalidade, homocedasticidade e independência</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_evapo.xlsx"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- NORMALIDADE ----</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar o teste de normalidade Shapiro-Wilk </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>shapiro_test_results_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo,region, ff_area) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">shapiro.test</span>(Evapo)<span class="sc">$</span>p.value</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar os resultados do teste Shapiro-Wilk</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_test_results_evapo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 4
   Tipo  region ff_area p_value
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;
 1 PF    CBA    1-10     0.0391
 2 PF    CBA    10-20    0.142 
 3 PF    CBA    20-30    0.346 
 4 PF    CBA    30-40    0.477 
 5 PF    CBA    40-50    0.600 
 6 PF    CBA    50-60    0.620 
 7 PF    CBA    60-70    0.580 
 8 PF    CBA    70-80    0.520 
 9 PF    CBA    80-90    0.512 
10 PF    CBA    90-100   0.687 
# ℹ 110 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados do teste de normalidade</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(shapiro_test_results_evapo, <span class="st">"data_group/shapiro_test_evapo_results.xlsx"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- HOMOCEDASTICIDADE ----</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantindo que 'Tipo' seja tratado como fator</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo<span class="sc">$</span>Tipo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(all_pf_sf_evapo<span class="sc">$</span>Tipo)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>results_list_evapo <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_evapo<span class="sc">$</span>region)) {</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_evapo<span class="sc">$</span>ff_area)) {</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de homocedasticidade Levene</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        levene_test_evapo <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(Evapo <span class="sc">~</span> Tipo, <span class="at">data =</span> data_subset)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> levene_test_evapo<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]  </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>      results_list_evapo[[<span class="fu">length</span>(results_list_evapo) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">region =</span> region, </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">ff_area =</span> ff_area, </span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">p_value =</span> p_value)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>levene_test_results_evapo <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_list_evapo)</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir os resultados</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(levene_test_results_evapo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   region ff_area     p_value
1     CBA    1-10 0.027280895
2     CBA   10-20 0.025490815
3     CBA   20-30 0.013992947
4     CBA   30-40 0.021272158
5     CBA   40-50 0.047614392
6     CBA   50-60 0.056851408
7     CBA   60-70 0.084564405
8     CBA   70-80 0.079499258
9     CBA   80-90 0.079682558
10    CBA  90-100 0.216580324
11    EBA    1-10 0.749110155
12    EBA   10-20 0.855139394
13    EBA   20-30 0.833991746
14    EBA   30-40 0.578915819
15    EBA   40-50 0.410490304
16    EBA   50-60 0.088108876
17    EBA   60-70 0.011822389
18    EBA   70-80 0.003527165
19    EBA   80-90 0.001969657
20    EBA  90-100 0.001267824
21    SBA    1-10 0.611671959
22    SBA   10-20 0.515866928
23    SBA   20-30 0.322076300
24    SBA   30-40 0.274488867
25    SBA   40-50 0.292607858
26    SBA   50-60 0.204998550
27    SBA   60-70 0.109533413
28    SBA   70-80 0.045146106
29    SBA   80-90 0.016340569
30    SBA  90-100 0.056639754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(levene_test_results_evapo, <span class="st">"data_group/levene_test_evapo_results.xlsx"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- INDEPENDÊNCIA ----</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>kendall_results_list_evapo <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_evapo<span class="sc">$</span>region)) {</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_evapo<span class="sc">$</span>ff_area)) {</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de correlação de Kendall entre 'Evapo' e 'Tipo'</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Evapo), <span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Tipo), <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>p.value  </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        cor_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>estimate  </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>      cor_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>      kendall_results_list_evapo[[<span class="fu">length</span>(kendall_results_list_evapo) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">region =</span> region, </span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">ff_area =</span> ff_area, </span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">cor_value =</span> cor_value,</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> p_value</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>kendall_test_results_evapo <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, kendall_results_list_evapo)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(kendall_test_results_evapo, <span class="st">"data_group/kendall_test_evapo_results.xlsx"</span>)</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1866247 99.7    2951642 157.7  2951642 157.7
Vcells 3380859 25.8    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
<section id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf-1" class="level3">
<h3 class="anchored" data-anchor-id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf-1">Teste t entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - RODAR O TESTE NÃO PARAMÉTRICO</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista dos intervalos de área</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame vazio para armazenar os resultados</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>significance_results_t_evapo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)  </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados para PF e SF no intervalo atual e região atual</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste t para cada comparação com PF</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Evapo, sv_early_data<span class="sc">$</span>Evapo, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Evapo, sv_intermediate_data<span class="sc">$</span>Evapo, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Evapo, sv_advanced_data<span class="sc">$</span>Evapo, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>  significance_results_t_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>  significance_results_t_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>  significance_results_t_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_t_evapo, <span class="st">"data_group/significance_results_evapo_testt.xlsx"</span>)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1865980 99.7    2951642 157.7  2951642 157.7
Vcells 3380994 25.8    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
<section id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-1" class="level3">
<h3 class="anchored" data-anchor-id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-1">Teste Wilcox entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura da planilha com os dados</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_evapo.xlsx"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista dos intervalos de área</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame para armazenar os resultados</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>significance_results_w_evapo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste de Wilcoxon para cada comparação com PF</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Evapo, sv_early_data<span class="sc">$</span>Evapo, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Evapo, sv_intermediate_data<span class="sc">$</span>Evapo, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Evapo, sv_advanced_data<span class="sc">$</span>Evapo, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  significance_results_w_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  significance_results_w_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>  significance_results_w_evapo[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_w_evapo, <span class="st">"data_group/significance_results_evapo_Wilcox_test.xlsx"</span>)</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1865988 99.7    2951642 157.7  2951642 157.7
Vcells 3382721 25.9    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
<section id="plot-com-significance-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-com-significance-1">Plot com significance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um dataframe "long" de significância, onde cada linha tem uma região e o intervalo associado</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>long_significance_results_w_evapo <span class="ot">&lt;-</span> significance_results_w_evapo <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"Comparison"</span>, <span class="at">value =</span> <span class="st">"P_value"</span>, <span class="sc">-</span>Intervalo) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Comparison, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"region"</span>, <span class="st">"Comparison_Type"</span>), <span class="at">sep =</span> <span class="st">"_PF_vs_"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesclar esses resultados com os dados originais</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_evapo, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionando uma coluna indicando se o intervalo foi significativo</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo<span class="sc">$</span>Significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(all_pf_sf_evapo<span class="sc">$</span>P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular o valor máximo do bigode</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>get_whisker_max <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">boxplot.stats</span>(x)<span class="sc">$</span>stats</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stats[<span class="dv">5</span>]) <span class="co"># stats[5] normalmente corresponde ao valor máximo do bigode</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular a posição do asterisco</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>significance_positions <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ff_area, region, Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_whisker =</span> <span class="fu">get_whisker_max</span>(Evapo), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_evapo, </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">asterisk_y =</span> max_whisker <span class="sc">+</span> <span class="dv">10</span>, <span class="co"># Ajuste para posicionar acima do bigode</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_adjust =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="fl">0.3</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_pos =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(ff_area, <span class="at">levels =</span> area_ranges)) <span class="sc">+</span> x_adjust</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="co">#head(significance_positions)</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot com asteriscos de significância</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>p_ast_evapo_w <span class="ot">&lt;-</span> all_pf_sf_evapo <span class="sc">%&gt;%</span> </span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>ff_area, <span class="at">y=</span>Evapo, <span class="at">fill=</span>Tipo)) <span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>region) <span class="sc">+</span> </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.77</span>, <span class="fl">0.84</span>),</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"transparent"</span>),</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.position = "top",</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">family =</span> <span class="st">"serif"</span>), </span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#text = element_text(size = 7, face = "bold",family = "serif"), </span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axis.text = element_text(size = 6, face = "plain", family = "serif", color = "black"),</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.text = element_text(size = 7),</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),  </span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">20</span>)),</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#02401B"</span>, <span class="st">"lightgreen"</span>, <span class="st">"green1"</span>, <span class="st">"green4"</span>), <span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = c(1,2,3,4,5,6,7,8,9,10), linetype = "dashed", color = "lightgray", size = 0.5) +</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  <span class="co">#labels = c("Primary Vegetation           ", "Secondary Vegetation"))+</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average annual accumulated </span><span class="sc">\n</span><span class="st"> evapotranspiration (mm)"</span>,</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>       <span class="co">#y = expression(atop("Average annual accumulated", paste("evapotranspiration (mm·", yr^{-1}, ")")))</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando os asteriscos</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> significance_positions, </span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> asterisk_y, <span class="at">label =</span> <span class="st">"*"</span>),</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>p_ast_evapo_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando a figura</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/area_x_evapo_pf_sf_significant_asterisco_wilcoxon.png"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1931274 103.2    2951642 157.7  2951642 157.7
Vcells 3531634  27.0    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="tempertaure" class="level2">
<h2 class="anchored" data-anchor-id="tempertaure">TEMPERTAURE</h2>
<section id="agrupamento-2" class="level3">
<h3 class="anchored" data-anchor-id="agrupamento-2">Agrupamento</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo a planilha</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_lulc_50_final = fread("/media/amazonia/hd2/lais/GitHub/paper_climate_forest_regeneration/data_group/plan_all_lulc_final.csv")</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all_lulc_50_fil &lt;- all_lulc_50_final %&gt;% </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    filter(Tipo %in% c("SF", "PF"))</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the average evapotranspiration for each cluster</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>all_lulc_temp <span class="ot">=</span> all_lulc_50_fil <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Temp =</span> Temp,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frac =</span> frac_area,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> Tipo,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ano =</span> Ano,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> Region,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Idade =</span> Idade_SF</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">case_when</span>(Frac <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"1-10"</span>,</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"20-30"</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.3</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"30-40"</span>,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"40-50"</span>,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"50-60"</span>,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"60-70"</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.7</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"70-80"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">"80-90"</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                        Frac <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> Frac <span class="sc">&lt;=</span> <span class="fl">1.0</span> <span class="sc">~</span> <span class="st">"90-100"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">idade =</span> <span class="fu">case_when</span>(Idade <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"&lt;= 10"</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">&amp;</span> Idade <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"10-20"</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                      Idade <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"&gt; 20"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculating the average evapotranspiration for each cluster</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Ano, Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span> </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Temp =</span> <span class="fu">mean</span>(Temp),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar o novo dataframe com as categorias desejadas</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>all_lulc_temp_stages <span class="ot">&lt;-</span> all_lulc_temp <span class="sc">%&gt;%</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="st">"PF"</span>,</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&lt;= 10"</span> <span class="sc">~</span> <span class="st">"SF_early"</span>,</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"10-20"</span> <span class="sc">~</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF"</span> <span class="sc">&amp;</span> idade <span class="sc">==</span> <span class="st">"&gt; 20"</span> <span class="sc">~</span> <span class="st">"SF_advanced"</span>,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Tipo))  </span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>all_lulc_temp_final <span class="ot">&lt;-</span> all_lulc_temp_stages <span class="sc">%&gt;%</span> </span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(Tipo <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>                          Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="dv">4</span>))</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar o resultado</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="co">#head(all_lulc_temp_final)</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>max_min_temp <span class="ot">=</span> all_lulc_temp_final <span class="sc">%&gt;%</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo, region, ff_area, idade) <span class="sc">%&gt;%</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(Temp),</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_temp =</span> <span class="fu">median</span>(Temp),</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(Temp)</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Export data min and max</span></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(max_min_temp, <span class="st">"data_group/plan_max_and_min_group_temp.xlsx"</span>)</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Export data grouped</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_lulc_temp_final, <span class="st">"data_group/plan_data_group_temp.xlsx"</span>)</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(all_lulc_50_final)</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testes-normalidade-homocedasticidade-e-independência-2" class="level3">
<h3 class="anchored" data-anchor-id="testes-normalidade-homocedasticidade-e-independência-2">Testes normalidade, homocedasticidade e independência</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_temp.xlsx"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- NORMALIDADE ----</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar o teste de normalidade Shapiro-Wilk </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>shapiro_test_results_temp <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tipo,region, ff_area) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">shapiro.test</span>(Temp)<span class="sc">$</span>p.value</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar os resultados do teste Shapiro-Wilk</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_test_results_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 4
   Tipo  region ff_area p_value
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;
 1 PF    CBA    1-10      0.193
 2 PF    CBA    10-20     0.138
 3 PF    CBA    20-30     0.148
 4 PF    CBA    30-40     0.178
 5 PF    CBA    40-50     0.202
 6 PF    CBA    50-60     0.218
 7 PF    CBA    60-70     0.236
 8 PF    CBA    70-80     0.241
 9 PF    CBA    80-90     0.244
10 PF    CBA    90-100    0.298
# ℹ 110 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados do teste de normalidade</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(shapiro_test_results_temp, <span class="st">"data_group/shapiro_test_temp_results.xlsx"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- HOMOCEDASTICIDADE ----</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantindo que 'Tipo' seja tratado como fator</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp<span class="sc">$</span>Tipo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(all_pf_sf_temp<span class="sc">$</span>Tipo)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>results_list_temp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_temp<span class="sc">$</span>region)) {</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_temp<span class="sc">$</span>ff_area)) {</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de homocedasticidade Levene</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        levene_test_temp <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(Temp <span class="sc">~</span> Tipo, <span class="at">data =</span> data_subset)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> levene_test_temp<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]  </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>      results_list_temp[[<span class="fu">length</span>(results_list_temp) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">region =</span> region, </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">ff_area =</span> ff_area, </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">p_value =</span> p_value)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>levene_test_results_temp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_list_temp)</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir os resultados</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(levene_test_results_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   region ff_area    p_value
1     CBA    1-10 0.83197458
2     CBA   10-20 0.80000235
3     CBA   20-30 0.81306910
4     CBA   30-40 0.87609097
5     CBA   40-50 0.82129134
6     CBA   50-60 0.84953382
7     CBA   60-70 0.90458652
8     CBA   70-80 0.28428853
9     CBA   80-90 0.33982704
10    CBA  90-100 0.02566782
11    EBA    1-10 0.27483771
12    EBA   10-20 0.36583578
13    EBA   20-30 0.41482398
14    EBA   30-40 0.54406349
15    EBA   40-50 0.60625467
16    EBA   50-60 0.57322143
17    EBA   60-70 0.58940324
18    EBA   70-80 0.47304822
19    EBA   80-90 0.48166457
20    EBA  90-100 0.25405365
21    SBA    1-10 0.43587153
22    SBA   10-20 0.48503728
23    SBA   20-30 0.61530533
24    SBA   30-40 0.67667190
25    SBA   40-50 0.99048509
26    SBA   50-60 0.85842660
27    SBA   60-70 0.33119598
28    SBA   70-80 0.59203270
29    SBA   80-90 0.95642377
30    SBA  90-100 0.76793381</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(levene_test_results_temp, <span class="st">"data_group/levene_test_temp_results.xlsx"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- INDEPENDÊNCIA ----</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para armazenar os resultados</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>kendall_results_list_temp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada combinação de 'region' e 'ff_area'</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_temp<span class="sc">$</span>region)) {</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ff_area <span class="cf">in</span> <span class="fu">unique</span>(all_pf_sf_temp<span class="sc">$</span>ff_area)) {</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar os dados para a combinação atual</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    data_subset <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> <span class="sc">!!</span>ff_area)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se há dados suficientes para realizar o teste </span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(data_subset) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_subset<span class="sc">$</span>Tipo)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>({</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Realizar o teste de correlação de Kendall entre 'Temp' e 'Tipo'</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Temp), <span class="fu">as.numeric</span>(data_subset<span class="sc">$</span>Tipo), <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        p_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>p.value  </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        cor_value <span class="ot">&lt;-</span> cor_test<span class="sc">$</span>estimate  </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>      cor_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o resultado ao vetor de resultados apenas se o p_value não for nulo</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(p_value)) {</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>      kendall_results_list_temp[[<span class="fu">length</span>(kendall_results_list_temp) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">region =</span> region, </span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">ff_area =</span> ff_area, </span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">cor_value =</span> cor_value,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> p_value</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os resultados em um DataFrame</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>kendall_test_results_temp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, kendall_results_list_temp)</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os resultados para um arquivo Excel</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(kendall_test_results_temp, <span class="st">"data_group/kendall_test_temp_results.xlsx"</span>)</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1885046 100.7    2951642 157.7  2951642 157.7
Vcells 3436604  26.3    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
<section id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf-2" class="level3">
<h3 class="anchored" data-anchor-id="teste-t-entre-os-tipos-de-cobertura---pf-e-sf-2">Teste t entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OS PRESSUPOSTOS NÃO FORAM ATENDIDOS - RODAR O TESTE NÃO PARAMÉTRICO</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista dos intervalos de área</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame vazio para armazenar os resultados</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>significance_results_t_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)  </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste t para cada comparação com PF</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Temp, sv_early_data<span class="sc">$</span>Temp, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Temp, sv_intermediate_data<span class="sc">$</span>Temp, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">t.test</span>(pv_data<span class="sc">$</span>Temp, sv_advanced_data<span class="sc">$</span>Temp, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  significance_results_t_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>  significance_results_t_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  significance_results_t_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_t_temp, <span class="st">"data_group/significance_results_temp_testt.xlsx"</span>)</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1884779 100.7    2951642 157.7  2951642 157.7
Vcells 3436739  26.3    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
<section id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-2" class="level3">
<h3 class="anchored" data-anchor-id="teste-wilcox-entre-os-tipos-de-cobertura---pf-e-sf-2">Teste Wilcox entre os tipos de cobertura - PF e SF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura da planilha com os dados</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_temp.xlsx"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista dos intervalos de área</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>area_ranges <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista das regiões</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CBA"</span>, <span class="st">"EBA"</span>, <span class="st">"SBA"</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando um DataFrame vazio para armazenar os resultados</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>significance_results_w_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Intervalo =</span> area_ranges)  </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop por cada região</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (region <span class="cf">in</span> regions) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop por cada intervalo de área</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (range <span class="cf">in</span> area_ranges) {</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrando os dados</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    pv_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"PF"</span>)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    sv_early_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_early"</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    sv_intermediate_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span>)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    sv_advanced_data <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="sc">!!</span>region, ff_area <span class="sc">==</span> range, Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste de Wilcoxon para cada comparação com PF</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_early_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Temp, sv_early_data<span class="sc">$</span>Temp, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_early <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_early, <span class="cn">NA</span>)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_intermediate_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Temp, sv_intermediate_data<span class="sc">$</span>Temp, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_intermediate <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_intermediate, <span class="cn">NA</span>)</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(pv_data) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sv_advanced_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="fu">wilcox.test</span>(pv_data<span class="sc">$</span>Temp, sv_advanced_data<span class="sc">$</span>Temp, <span class="at">paired =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>      p_values_pf_sf_advanced <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values_pf_sf_advanced, <span class="cn">NA</span>)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando ao DataFrame</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>  significance_results_w_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_early"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_early</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  significance_results_w_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_intermediate"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_intermediate</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  significance_results_w_temp[[<span class="fu">paste0</span>(region, <span class="st">"_PF_vs_SF_advanced"</span>)]] <span class="ot">&lt;-</span> p_values_pf_sf_advanced</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os resultados em um arquivo</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(significance_results_w_temp, <span class="st">"data_group/significance_results_temp_Wilcox_test.xlsx"</span>)</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1884787 100.7    2951642 157.7  2951642 157.7
Vcells 3438463  26.3    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
<section id="plot-com-significance-2" class="level4">
<h4 class="anchored" data-anchor-id="plot-com-significance-2">Plot com significance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um dataframe "long" de significância, onde cada linha tem uma região e o intervalo associado</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>long_significance_results_w_temp <span class="ot">&lt;-</span> significance_results_w_temp <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"Comparison"</span>, <span class="at">value =</span> <span class="st">"P_value"</span>, <span class="sc">-</span>Intervalo) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Comparison, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"region"</span>, <span class="st">"Comparison_Type"</span>), <span class="at">sep =</span> <span class="st">"_PF_vs_"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesclar esses resultados com os dados originais</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_temp, </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionando uma coluna indicando se o intervalo foi significativo</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp<span class="sc">$</span>Significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(all_pf_sf_temp<span class="sc">$</span>P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular o valor máximo do bigode</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>get_whisker_max <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">boxplot.stats</span>(x)<span class="sc">$</span>stats</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stats[<span class="dv">5</span>]) <span class="co"># stats[5] normalmente corresponde ao valor máximo do bigode</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular a posição do asterisco</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>significance_positions <span class="ot">&lt;-</span> all_pf_sf_temp <span class="sc">%&gt;%</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ff_area, region, Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_whisker =</span> <span class="fu">get_whisker_max</span>(Temp), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_significance_results_w_temp, </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ff_area"</span> <span class="ot">=</span> <span class="st">"Intervalo"</span>, <span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>, <span class="st">"Tipo"</span> <span class="ot">=</span> <span class="st">"Comparison_Type"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">asterisk_y =</span> max_whisker <span class="sc">+</span> <span class="fl">0.1</span>, <span class="co"># Ajuste para posicionar acima do bigode</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_adjust =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_early"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_intermediate"</span> <span class="sc">~</span> <span class="fl">0.1</span>,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>      Tipo <span class="sc">==</span> <span class="st">"SF_advanced"</span> <span class="sc">~</span> <span class="fl">0.3</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_pos =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(ff_area, <span class="at">levels =</span> area_ranges)) <span class="sc">+</span> x_adjust</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="co">#head(significance_positions)</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot com asteriscos de significância</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>p_ast_temp_w <span class="ot">&lt;-</span>all_pf_sf_temp <span class="sc">%&gt;%</span> </span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>ff_area, <span class="at">y=</span>Temp, <span class="at">fill=</span>Tipo)) <span class="sc">+</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>region) <span class="sc">+</span> </span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.91</span>, <span class="fl">0.84</span>),</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"transparent"</span>),</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">family =</span> <span class="st">"serif"</span>), </span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#text = element_text(size = 7, face = "bold",family = "serif"), </span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axis.text.y = element_text(size = 12, face = "plain", family = "serif", color = "black"),</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.text = element_text(size = 7),</span></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),  </span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">20</span>)),</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7F3B08"</span>, <span class="st">"#FEE0B6"</span>, <span class="st">"#FDB863"</span>, <span class="st">"#E08214"</span>), <span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">23</span><span class="sc">:</span><span class="dv">27</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">27</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>)), </span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">width =</span> <span class="dv">6</span>, <span class="at">zero.print =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> </span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional cover (%)"</span>,</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Average annual mean </span><span class="sc">\n</span><span class="st"> temperature (°C)"</span>,</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">#y = expression(atop("Average annual mean", paste("temperature (", degree, "C·yr"^-1, ")")))</span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionando os asteriscos</span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> significance_positions, </span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x_pos, <span class="at">y =</span> asterisk_y, <span class="at">label =</span> <span class="st">"*"</span>),</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>p_ast_temp_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando a figura</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/area_x_temp_pf_sf_significant_asterisco_wilcoxon.png"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 1949990 104.2    2951642 157.7  2951642 157.7
Vcells 3587452  27.4    8388608  64.0  5680255  43.4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="painel-all-variables---observation" class="level2">
<h2 class="anchored" data-anchor-id="painel-all-variables---observation">Painel all variables - observation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste das margens</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>p_ret_prec_w <span class="ot">&lt;-</span> p_ast_prec_w <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">20</span>))  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>p_ret_evapo_w <span class="ot">&lt;-</span> p_ast_evapo_w <span class="sc">+</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">20</span>))   </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>p_ret_temp_w <span class="ot">&lt;-</span> p_ast_temp_w <span class="sc">+</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">20</span>))  </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar painel com espaçamento ajustado</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>painel_obs <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  p_ret_prec_w, p_ret_evapo_w, p_ret_temp_w,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  <span class="co"># Letras dos subplots</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,                <span class="co"># Alinhamento vertical</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)        <span class="co"># Força os plots a terem alturas iguais</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar figura final</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/painels/painel_fraction_forest_x_prec.png"</span>, </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> painel_obs, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/painels/painel_fraction_forest_x_prec.pdf"</span>, </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> painel_obs, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="modeling" class="level1">
<h1>Modeling</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clubSandwich)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme) </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="fu">font_import</span>()           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importing fonts may take a few minutes, depending on the number of fonts and the speed of the system.
Continue? [y/n] </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model" class="level1">
<h1>Model</h1>
<section id="precipitation-1" class="level2">
<h2 class="anchored" data-anchor-id="precipitation-1">PRECIPITATION</h2>
<section id="model-choice" class="level3">
<h3 class="anchored" data-anchor-id="model-choice">Model choice</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_prec_model <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_prec.xlsx"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a ordem correta das categorias</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>ord_ff   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>lev_tipo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodifica como fatores na ordem correta</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>recode_fac <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> ord_ff, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> lev_tipo)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Separa por região e aplica a recodificação</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>model_cba_prec <span class="ot">&lt;-</span> all_pf_sf_prec_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"CBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>model_eba_prec <span class="ot">&lt;-</span> all_pf_sf_prec_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"EBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>model_sba_prec <span class="ot">&lt;-</span> all_pf_sf_prec_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"SBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria um identificador para cada estrato</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>add_estrato <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>estrato_id <span class="ot">&lt;-</span> <span class="fu">interaction</span>(d<span class="sc">$</span>region, d<span class="sc">$</span>ff_area, d<span class="sc">$</span>Tipo, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  d</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>model_cba_prec <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_cba_prec)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>model_eba_prec <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_eba_prec)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>model_sba_prec <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_sba_prec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="observações---tipo-x-fraction-cover" class="level5">
<h5 class="anchored" data-anchor-id="observações---tipo-x-fraction-cover">Observações - Tipo x Fraction cover</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># labeller "SI" compatível com várias versões de {scales}</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>si_labeller <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>) {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"cut_si"</span> <span class="sc">%in%</span> <span class="fu">getNamespaceExports</span>(<span class="st">"scales"</span>)) {</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_number</span>(<span class="at">accuracy =</span> accuracy, <span class="at">scale_cut =</span> <span class="fu">cut_si</span>(<span class="st">""</span>))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"cut_short_scale"</span> <span class="sc">%in%</span> <span class="fu">getNamespaceExports</span>(<span class="st">"scales"</span>)) {</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_number</span>(<span class="at">accuracy =</span> accuracy, <span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_comma</span>(<span class="at">accuracy =</span> accuracy)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>plot_nobs_heat <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, region_name,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">agg =</span> <span class="fu">c</span>(<span class="st">"sum"</span>),       </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">use_si_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">text_size =</span> <span class="fl">2.5</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill_limits =</span> <span class="cn">NULL</span>,   </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill_breaks =</span> <span class="cn">NULL</span>) {</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  agg <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(agg)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  dat_reg <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(region <span class="sc">==</span> region_name) <span class="sc">%&gt;%</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(region, ff_area, Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_obs =</span> <span class="cf">switch</span>(agg,</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sum    =</span> <span class="fu">sum</span>(n_obs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mean   =</span> <span class="fu">mean</span>(n_obs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">median =</span> <span class="fu">median</span>(n_obs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">logn   =</span> <span class="fu">log10</span>(<span class="fu">pmax</span>(n_obs, <span class="dv">1</span>L)),</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_lab  =</span> <span class="cf">if</span> (use_si_labels) <span class="fu">si_labeller</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)(n_obs) <span class="cf">else</span> scales<span class="sc">::</span><span class="fu">comma</span>(n_obs),</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">txt_col =</span> <span class="fu">ifelse</span>(logn <span class="sc">&gt;=</span> <span class="fu">median</span>(logn, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"black"</span>, <span class="st">"white"</span>)</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat_reg, <span class="fu">aes</span>(ff_area, Tipo, <span class="at">fill =</span> logn)) <span class="sc">+</span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_lab, <span class="at">color =</span> txt_col),</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> text_size, <span class="at">family =</span> family, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_identity</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">name   =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>](n[obs])),</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> fill_limits,               </span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> fill_breaks,               </span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">oob =</span> scales<span class="sc">::</span>squish                </span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">"PF"</span>             <span class="ot">=</span> <span class="st">"PF"</span>,</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">"SF_early"</span>       <span class="ot">=</span> <span class="st">"SF early"</span>,</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">"SF_intermediate"</span><span class="ot">=</span> <span class="st">"SF intermediate"</span>,</span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">"SF_advanced"</span>    <span class="ot">=</span> <span class="st">"SF advanced"</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>)</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(region_name, <span class="st">""</span>),</span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Fractional cover (%)"</span>,</span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesma legenda para todos</span></span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>common_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>)</span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>common_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>p_nobs_cba <span class="ot">&lt;-</span> <span class="fu">plot_nobs_heat</span>(model_cba_prec, <span class="st">"CBA"</span>, <span class="at">agg =</span> <span class="st">"sum"</span>,</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill_limits =</span> common_limits, <span class="at">fill_breaks =</span> common_breaks)</span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>p_nobs_eba <span class="ot">&lt;-</span> <span class="fu">plot_nobs_heat</span>(model_eba_prec, <span class="st">"EBA"</span>, <span class="at">agg =</span> <span class="st">"sum"</span>,</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill_limits =</span> common_limits, <span class="at">fill_breaks =</span> common_breaks)</span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>p_nobs_sba <span class="ot">&lt;-</span> <span class="fu">plot_nobs_heat</span>(model_sba_prec, <span class="st">"SBA"</span>, <span class="at">agg =</span> <span class="st">"sum"</span>,</span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill_limits =</span> common_limits, <span class="at">fill_breaks =</span> common_breaks)</span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a><span class="co"># --- CBA: esconder eixo-x mas manter o espaço; centralizar título; margens iguais</span></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>p_nobs_cba <span class="ot">&lt;-</span> p_nobs_cba <span class="sc">+</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional cover (%)"</span>) <span class="sc">+</span>                      </span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="cn">NA</span>),            </span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),                       </span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title   =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin  =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)                    </span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a><span class="co"># --- EBA: idem ao CBA</span></span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a>p_nobs_eba <span class="ot">&lt;-</span> p_nobs_eba <span class="sc">+</span></span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional cover (%)"</span>) <span class="sc">+</span></span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title   =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin  =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a><span class="co"># --- SBA: eixo-x visível; mesmas margens e título centralizado</span></span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a>p_nobs_sba <span class="ot">&lt;-</span> p_nobs_sba <span class="sc">+</span></span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title  =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Monta o painel com uma legenda comum</span></span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true" tabindex="-1"></a>painel_log <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true" tabindex="-1"></a>  p_nobs_cba, p_nobs_eba, p_nobs_sba,</span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,</span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span></span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true" tabindex="-1"></a>painel_log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/n_obs.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">400</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fixed-effect" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effect">Fixed effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CBA</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>model_CBA_prec_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Prec <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_cba_prec)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># EBA</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>model_EBA_prec_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Prec <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_eba_prec)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SBA</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>model_SBA_prec_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Prec <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_sba_prec)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Coeficientes fixos</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_CBA_prec_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept) 2417.         42.6   56.8     20.4 5.62e-24
 2 fixed  ff_area.L     43.2        16.5    2.61   702.  9.12e- 3
 3 fixed  ff_area.Q    -52.3        16.5   -3.17   702.  1.61e- 3
 4 fixed  ff_area.C     -0.422      16.5   -0.0256 702.  9.80e- 1
 5 fixed  ff_area^4    -23.9        16.5   -1.45   702.  1.48e- 1
 6 fixed  ff_area^5    -13.8        16.5   -0.834  702.  4.04e- 1
 7 fixed  ff_area^6     -1.96       16.5   -0.119  702.  9.06e- 1
 8 fixed  ff_area^7      1.05       16.5    0.0633 702.  9.50e- 1
 9 fixed  ff_area^8     -2.42       16.5   -0.146  702.  8.84e- 1
10 fixed  ff_area^9     -1.34       16.5   -0.0814 702.  9.35e- 1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_EBA_prec_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept)  2421.        41.6    58.2    20.5 3.16e-24
 2 fixed  ff_area.L    -333.        16.7   -19.9   710.  2.03e-70
 3 fixed  ff_area.Q      97.8       16.7     5.86  710.  7.25e- 9
 4 fixed  ff_area.C     -17.9       16.7    -1.07  710.  2.84e- 1
 5 fixed  ff_area^4     -83.5       16.7    -5.00  710.  7.40e- 7
 6 fixed  ff_area^5     -40.1       16.7    -2.40  710.  1.66e- 2
 7 fixed  ff_area^6      11.5       16.7     0.688 710.  4.91e- 1
 8 fixed  ff_area^7      -5.47      16.7    -0.328 710.  7.43e- 1
 9 fixed  ff_area^8     -12.2       16.7    -0.732 710.  4.64e- 1
10 fixed  ff_area^9      -6.63      16.7    -0.397 710.  6.92e- 1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_SBA_prec_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept) 2105.         31.6   66.7     20.4 2.61e-25
 2 fixed  ff_area.L     41.8        10.9    3.82   710.  1.44e- 4
 3 fixed  ff_area.Q     60.2        10.9    5.50   710.  5.20e- 8
 4 fixed  ff_area.C     37.6        10.9    3.44   710.  6.22e- 4
 5 fixed  ff_area^4      9.42       10.9    0.861  710.  3.89e- 1
 6 fixed  ff_area^5      9.75       10.9    0.891  710.  3.73e- 1
 7 fixed  ff_area^6     11.1        10.9    1.02   710.  3.10e- 1
 8 fixed  ff_area^7      6.35       10.9    0.580  710.  5.62e- 1
 9 fixed  ff_area^8     -5.33       10.9   -0.488  710.  6.26e- 1
10 fixed  ff_area^9      0.329      10.9    0.0301 710.  9.76e- 1
# ℹ 30 more rows</code></pre>
</div>
</div>
<section id="r-square-for-linear-mixed-model-lmm" class="level4">
<h4 class="anchored" data-anchor-id="r-square-for-linear-mixed-model-lmm">R-square for Linear Mixed Model (LMM)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Helpers coerentes com o ajuste ----</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>weighted_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(y, w) <span class="fu">sum</span>(w<span class="sc">*</span>y)<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>r2_w_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat, w) {</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  sst <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> <span class="fu">weighted_mean</span>(y, w))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  ssr <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> ssr<span class="sc">/</span>sst</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># R² ponderado "marginal" (fixos) e "condicional" (fixos + RE) </span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>r2_lmer_w <span class="ot">&lt;-</span> <span class="cf">function</span>(m, dat, <span class="at">resp =</span> <span class="st">"Prec"</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"marg"</span>,<span class="st">"cond"</span>)) {</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(type)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">weights</span>(m))           </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dat[[resp]]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"marg"</span>) <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="sc">~</span><span class="dv">0</span>) <span class="cf">else</span> <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="cn">NULL</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2_w_sse</span>(y, yhat, w)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>r2_cba_prec <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_prec_w1, model_cba_prec, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_prec_w1, model_cba_prec, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>r2_eba_prec <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_prec_w1, model_eba_prec, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_prec_w1, model_eba_prec, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>r2_sba_prec <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_prec_w1, model_sba_prec, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_prec_w1, model_sba_prec, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>r2_cba_prec; r2_eba_prec; r2_sba_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.1239456 0.8912121 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.4521194 0.9281785 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.1557173 0.9137644 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar (opcional)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>r2_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">c</span>(<span class="st">"CBA"</span>,<span class="st">"EBA"</span>,<span class="st">"SBA"</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">c</span>(r2_cba_prec[<span class="st">"R2_marg_w"</span>], r2_eba_prec[<span class="st">"R2_marg_w"</span>], r2_sba_prec[<span class="st">"R2_marg_w"</span>]),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">c</span>(r2_cba_prec[<span class="st">"R2_cond_w"</span>], r2_eba_prec[<span class="st">"R2_cond_w"</span>], r2_sba_prec[<span class="st">"R2_cond_w"</span>])</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(r2_tbl, <span class="st">"data_group/r2_weighted_prec.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste múltiplo BH para comparações por faixa.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># specs = ~ Tipo | ff_area --&gt; Dentro de cada faixa de cobertura, PF e SF têm precipitação diferente?</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>emm_CBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_prec_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_CBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   134.10 23.4 702   5.739  &lt;.0001
 PF - SF_intermediate            111.33 23.4 702   4.765  &lt;.0001
 PF - SF_advanced                 73.75 26.2 702   2.814  0.0101
 SF_early - SF_intermediate      -22.77 23.4 702  -0.974  0.3302
 SF_early - SF_advanced          -60.35 26.2 702  -2.302  0.0324
 SF_intermediate - SF_advanced   -37.58 26.2 702  -1.434  0.1825

ff_area = 10-20:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   176.04 23.4 702   7.534  &lt;.0001
 PF - SF_intermediate            149.54 23.4 702   6.400  &lt;.0001
 PF - SF_advanced                119.21 26.2 702   4.548  &lt;.0001
 SF_early - SF_intermediate      -26.50 23.4 702  -1.134  0.2572
 SF_early - SF_advanced          -56.84 26.2 702  -2.168  0.0457
 SF_intermediate - SF_advanced   -30.34 26.2 702  -1.157  0.2572

ff_area = 20-30:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   198.48 23.4 702   8.494  &lt;.0001
 PF - SF_intermediate            168.06 23.4 702   7.193  &lt;.0001
 PF - SF_advanced                142.42 26.2 702   5.433  &lt;.0001
 SF_early - SF_intermediate      -30.42 23.4 702  -1.302  0.2321
 SF_early - SF_advanced          -56.06 26.2 702  -2.139  0.0492
 SF_intermediate - SF_advanced   -25.64 26.2 702  -0.978  0.3282

ff_area = 30-40:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   189.60 23.4 702   8.114  &lt;.0001
 PF - SF_intermediate            167.24 23.4 702   7.157  &lt;.0001
 PF - SF_advanced                146.63 26.2 702   5.594  &lt;.0001
 SF_early - SF_intermediate      -22.36 23.4 702  -0.957  0.4067
 SF_early - SF_advanced          -42.96 26.2 702  -1.639  0.1524
 SF_intermediate - SF_advanced   -20.60 26.2 702  -0.786  0.4321

ff_area = 40-50:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   206.26 23.4 702   8.827  &lt;.0001
 PF - SF_intermediate            161.73 23.4 702   6.922  &lt;.0001
 PF - SF_advanced                143.62 26.2 702   5.479  &lt;.0001
 SF_early - SF_intermediate      -44.52 23.4 702  -1.906  0.0685
 SF_early - SF_advanced          -62.64 26.2 702  -2.390  0.0257
 SF_intermediate - SF_advanced   -18.12 26.2 702  -0.691  0.4896

ff_area = 50-60:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   199.78 23.4 702   8.550  &lt;.0001
 PF - SF_intermediate            140.97 23.4 702   6.033  &lt;.0001
 PF - SF_advanced                115.35 26.2 702   4.401  &lt;.0001
 SF_early - SF_intermediate      -58.81 23.4 702  -2.517  0.0145
 SF_early - SF_advanced          -84.43 26.2 702  -3.221  0.0020
 SF_intermediate - SF_advanced   -25.62 26.2 702  -0.977  0.3287

ff_area = 60-70:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   203.35 23.4 702   8.703  &lt;.0001
 PF - SF_intermediate             99.62 23.4 702   4.263  &lt;.0001
 PF - SF_advanced                 97.42 26.2 702   3.717  0.0003
 SF_early - SF_intermediate     -103.73 23.4 702  -4.439  &lt;.0001
 SF_early - SF_advanced         -105.93 26.2 702  -4.041  0.0001
 SF_intermediate - SF_advanced    -2.19 26.2 702  -0.084  0.9333

ff_area = 70-80:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   217.22 23.4 702   9.297  &lt;.0001
 PF - SF_intermediate            137.88 23.4 702   5.901  &lt;.0001
 PF - SF_advanced                 81.09 26.2 702   3.094  0.0025
 SF_early - SF_intermediate      -79.34 23.4 702  -3.396  0.0011
 SF_early - SF_advanced         -136.13 26.2 702  -5.194  &lt;.0001
 SF_intermediate - SF_advanced   -56.79 26.2 702  -2.167  0.0306

ff_area = 80-90:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   237.66 24.0 702   9.907  &lt;.0001
 PF - SF_intermediate            110.33 23.4 702   4.722  &lt;.0001
 PF - SF_advanced                 98.11 26.2 702   3.743  0.0002
 SF_early - SF_intermediate     -127.32 24.0 702  -5.308  &lt;.0001
 SF_early - SF_advanced         -139.55 26.8 702  -5.210  &lt;.0001
 SF_intermediate - SF_advanced   -12.22 26.2 702  -0.466  0.6411

ff_area = 90-100:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   139.54 25.7 702   5.439  &lt;.0001
 PF - SF_intermediate             40.61 23.4 702   1.738  0.0992
 PF - SF_advanced                -35.64 26.2 702  -1.360  0.1744
 SF_early - SF_intermediate      -98.93 25.7 702  -3.856  0.0003
 SF_early - SF_advanced         -175.18 28.3 702  -6.182  &lt;.0001
 SF_intermediate - SF_advanced   -76.25 26.2 702  -2.909  0.0056

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>emm_EBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_prec_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_EBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    490.7 23.6 710  20.770  &lt;.0001
 PF - SF_intermediate             458.7 23.6 710  19.416  &lt;.0001
 PF - SF_advanced                 421.4 26.5 710  15.901  &lt;.0001
 SF_early - SF_intermediate       -32.0 23.6 710  -1.354  0.1762
 SF_early - SF_advanced           -69.3 26.5 710  -2.615  0.0137
 SF_intermediate - SF_advanced    -37.3 26.5 710  -1.408  0.1762

ff_area = 10-20:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    493.7 23.6 710  20.895  &lt;.0001
 PF - SF_intermediate             431.1 23.6 710  18.248  &lt;.0001
 PF - SF_advanced                 350.6 26.5 710  13.227  &lt;.0001
 SF_early - SF_intermediate       -62.5 23.6 710  -2.647  0.0083
 SF_early - SF_advanced          -143.1 26.5 710  -5.400  &lt;.0001
 SF_intermediate - SF_advanced    -80.6 26.5 710  -3.040  0.0029

ff_area = 20-30:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    496.4 23.6 710  21.011  &lt;.0001
 PF - SF_intermediate             412.4 23.6 710  17.455  &lt;.0001
 PF - SF_advanced                 300.3 26.5 710  11.331  &lt;.0001
 SF_early - SF_intermediate       -84.0 23.6 710  -3.556  0.0004
 SF_early - SF_advanced          -196.1 26.5 710  -7.399  &lt;.0001
 SF_intermediate - SF_advanced   -112.1 26.5 710  -4.229  &lt;.0001

ff_area = 30-40:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    460.3 23.6 710  19.481  &lt;.0001
 PF - SF_intermediate             370.4 23.6 710  15.678  &lt;.0001
 PF - SF_advanced                 239.9 26.5 710   9.052  &lt;.0001
 SF_early - SF_intermediate       -89.9 23.6 710  -3.803  0.0002
 SF_early - SF_advanced          -220.4 26.5 710  -8.315  &lt;.0001
 SF_intermediate - SF_advanced   -130.5 26.5 710  -4.924  &lt;.0001

ff_area = 40-50:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    397.0 23.6 710  16.802  &lt;.0001
 PF - SF_intermediate             316.0 23.6 710  13.375  &lt;.0001
 PF - SF_advanced                 195.1 26.5 710   7.363  &lt;.0001
 SF_early - SF_intermediate       -81.0 23.6 710  -3.427  0.0006
 SF_early - SF_advanced          -201.8 26.5 710  -7.616  &lt;.0001
 SF_intermediate - SF_advanced   -120.9 26.5 710  -4.561  &lt;.0001

ff_area = 50-60:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    376.3 23.6 710  15.926  &lt;.0001
 PF - SF_intermediate             285.6 23.6 710  12.089  &lt;.0001
 PF - SF_advanced                 183.2 26.5 710   6.913  &lt;.0001
 SF_early - SF_intermediate       -90.7 23.6 710  -3.837  0.0001
 SF_early - SF_advanced          -193.1 26.5 710  -7.284  &lt;.0001
 SF_intermediate - SF_advanced   -102.4 26.5 710  -3.864  0.0001

ff_area = 60-70:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    392.1 23.6 710  16.594  &lt;.0001
 PF - SF_intermediate             301.8 23.6 710  12.774  &lt;.0001
 PF - SF_advanced                 231.4 26.5 710   8.729  &lt;.0001
 SF_early - SF_intermediate       -90.3 23.6 710  -3.821  0.0002
 SF_early - SF_advanced          -160.7 26.5 710  -6.064  &lt;.0001
 SF_intermediate - SF_advanced    -70.4 26.5 710  -2.658  0.0080

ff_area = 70-80:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    428.9 23.6 710  18.155  &lt;.0001
 PF - SF_intermediate             323.0 23.6 710  13.671  &lt;.0001
 PF - SF_advanced                 258.8 26.5 710   9.766  &lt;.0001
 SF_early - SF_intermediate      -105.9 23.6 710  -4.484  &lt;.0001
 SF_early - SF_advanced          -170.1 26.5 710  -6.419  &lt;.0001
 SF_intermediate - SF_advanced    -64.2 26.5 710  -2.421  0.0157

ff_area = 80-90:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    441.4 23.6 710  18.680  &lt;.0001
 PF - SF_intermediate             324.8 23.6 710  13.747  &lt;.0001
 PF - SF_advanced                 279.5 26.5 710  10.546  &lt;.0001
 SF_early - SF_intermediate      -116.5 23.6 710  -4.933  &lt;.0001
 SF_early - SF_advanced          -161.9 26.5 710  -6.107  &lt;.0001
 SF_intermediate - SF_advanced    -45.3 26.5 710  -1.710  0.0878

ff_area = 90-100:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    327.6 23.6 710  13.865  &lt;.0001
 PF - SF_intermediate             199.9 23.6 710   8.462  &lt;.0001
 PF - SF_advanced                 135.8 26.5 710   5.122  &lt;.0001
 SF_early - SF_intermediate      -127.6 23.6 710  -5.402  &lt;.0001
 SF_early - SF_advanced          -191.8 26.5 710  -7.238  &lt;.0001
 SF_intermediate - SF_advanced    -64.2 26.5 710  -2.422  0.0157

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>emm_SBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_prec_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_SBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    102.7 15.5 710   6.635  &lt;.0001
 PF - SF_intermediate             121.0 15.5 710   7.822  &lt;.0001
 PF - SF_advanced                 159.2 17.4 710   9.172  &lt;.0001
 SF_early - SF_intermediate        18.4 15.5 710   1.186  0.2359
 SF_early - SF_advanced            56.5 17.4 710   3.257  0.0018
 SF_intermediate - SF_advanced     38.2 17.4 710   2.199  0.0338

ff_area = 10-20:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    102.0 15.5 710   6.593  &lt;.0001
 PF - SF_intermediate             122.1 15.5 710   7.894  &lt;.0001
 PF - SF_advanced                 173.4 17.4 710   9.988  &lt;.0001
 SF_early - SF_intermediate        20.1 15.5 710   1.302  0.1935
 SF_early - SF_advanced            71.4 17.4 710   4.111  0.0001
 SF_intermediate - SF_advanced     51.2 17.4 710   2.951  0.0039

ff_area = 20-30:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    104.2 15.5 710   6.732  &lt;.0001
 PF - SF_intermediate             124.8 15.5 710   8.069  &lt;.0001
 PF - SF_advanced                 174.6 17.4 710  10.062  &lt;.0001
 SF_early - SF_intermediate        20.7 15.5 710   1.337  0.1818
 SF_early - SF_advanced            70.5 17.4 710   4.061  0.0001
 SF_intermediate - SF_advanced     49.8 17.4 710   2.869  0.0051

ff_area = 30-40:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    113.7 15.5 710   7.350  &lt;.0001
 PF - SF_intermediate             132.5 15.5 710   8.566  &lt;.0001
 PF - SF_advanced                 180.0 17.4 710  10.372  &lt;.0001
 SF_early - SF_intermediate        18.8 15.5 710   1.215  0.2247
 SF_early - SF_advanced            66.3 17.4 710   3.819  0.0002
 SF_intermediate - SF_advanced     47.5 17.4 710   2.736  0.0077

ff_area = 40-50:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                     99.7 15.5 710   6.441  &lt;.0001
 PF - SF_intermediate             127.4 15.5 710   8.232  &lt;.0001
 PF - SF_advanced                 181.6 17.4 710  10.463  &lt;.0001
 SF_early - SF_intermediate        27.7 15.5 710   1.790  0.0738
 SF_early - SF_advanced            81.9 17.4 710   4.720  &lt;.0001
 SF_intermediate - SF_advanced     54.2 17.4 710   3.124  0.0022

ff_area = 50-60:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    100.0 15.5 710   6.461  &lt;.0001
 PF - SF_intermediate             118.9 15.5 710   7.683  &lt;.0001
 PF - SF_advanced                 166.5 17.4 710   9.595  &lt;.0001
 SF_early - SF_intermediate        18.9 15.5 710   1.222  0.2219
 SF_early - SF_advanced            66.6 17.4 710   3.836  0.0002
 SF_intermediate - SF_advanced     47.7 17.4 710   2.746  0.0074

ff_area = 60-70:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    116.3 15.5 710   7.514  &lt;.0001
 PF - SF_intermediate             156.5 15.5 710  10.113  &lt;.0001
 PF - SF_advanced                 202.8 17.4 710  11.683  &lt;.0001
 SF_early - SF_intermediate        40.2 15.5 710   2.599  0.0095
 SF_early - SF_advanced            86.5 17.4 710   4.984  &lt;.0001
 SF_intermediate - SF_advanced     46.3 17.4 710   2.668  0.0094

ff_area = 70-80:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    130.5 15.5 710   8.434  &lt;.0001
 PF - SF_intermediate             168.5 15.5 710  10.890  &lt;.0001
 PF - SF_advanced                 216.1 17.4 710  12.449  &lt;.0001
 SF_early - SF_intermediate        38.0 15.5 710   2.457  0.0143
 SF_early - SF_advanced            85.6 17.4 710   4.931  &lt;.0001
 SF_intermediate - SF_advanced     47.6 17.4 710   2.741  0.0075

ff_area = 80-90:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    138.6 15.5 710   8.956  &lt;.0001
 PF - SF_intermediate             175.9 15.5 710  11.370  &lt;.0001
 PF - SF_advanced                 226.7 17.4 710  13.062  &lt;.0001
 SF_early - SF_intermediate        37.4 15.5 710   2.415  0.0160
 SF_early - SF_advanced            88.1 17.4 710   5.078  &lt;.0001
 SF_intermediate - SF_advanced     50.8 17.4 710   2.926  0.0043

ff_area = 90-100:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    209.7 15.5 710  13.557  &lt;.0001
 PF - SF_intermediate             263.2 15.5 710  17.014  &lt;.0001
 PF - SF_advanced                 279.9 17.4 710  16.126  &lt;.0001
 SF_early - SF_intermediate        53.5 15.5 710   3.458  0.0007
 SF_early - SF_advanced            70.1 17.4 710   4.041  0.0001
 SF_intermediate - SF_advanced     16.6 17.4 710   0.959  0.3381

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
</div>
<section id="heterocedasticidade" class="level5">
<h5 class="anchored" data-anchor-id="heterocedasticidade">Heterocedasticidade</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função: resíduos normalizados vs n_obs, com controle de eixos</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>plot_resid_hetero <span class="ot">&lt;-</span> <span class="cf">function</span>(m_lme, dat, region_name,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m_lme, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">n_obs =</span> dat<span class="sc">$</span>n_obs, <span class="at">rnorm =</span> rn),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(n_obs, rnorm)) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)  </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> region_name,</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x = if (show_x_lab) expression(n[obs]~"(log scale)") else NULL,  </span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cf">if</span> (show_x_lab) <span class="st">""</span> <span class="cf">else</span> <span class="cn">NULL</span>,</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="cf">if</span> (show_y_lab) <span class="st">"Residuals"</span> <span class="cf">else</span> <span class="cn">NULL</span>             </span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Monta cada painel com as regras pedidas:</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="co"># - CBA: só Y</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>p_het_cba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_CBA_prec_w1, model_cba_prec, <span class="st">"CBA"</span>,</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a><span class="co"># - EBA: só X</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>p_het_eba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_EBA_prec_w1, model_eba_prec, <span class="st">"EBA"</span>,</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a><span class="co"># - SBA: sem X e sem Y</span></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>p_het_sba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_SBA_prec_w1, model_sba_prec, <span class="st">"SBA"</span>,</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel 1x3</span></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>painel_het_prec <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(p_het_cba, p_het_eba, p_het_sba,</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>painel_het_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/hetero_residuals_lme_prec.png"</span>, <span class="at">width=</span><span class="dv">8</span>, <span class="at">height=</span><span class="dv">6</span>, <span class="at">dpi=</span><span class="dv">400</span>, <span class="at">bg=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="qq-plot" class="level5">
<h5 class="anchored" data-anchor-id="qq-plot">QQ Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>qq_lme <span class="ot">&lt;-</span> <span class="cf">function</span>(m, region_name, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>){</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">rn=</span>rn), <span class="fu">aes</span>(<span class="at">sample =</span> rn)) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># &lt;- aqui</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y_title) <span class="fu">element_text</span>() <span class="cf">else</span> <span class="fu">element_blank</span>()</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> region_name, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="cf">if</span> (show_y_title) <span class="st">"Sample quantiles"</span> <span class="cf">else</span> <span class="cn">NULL</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co"># y apenas no primeiro (CBA)</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>qq_cba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_CBA_prec_w1, <span class="st">"CBA"</span>, <span class="at">show_y_title =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>qq_eba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_EBA_prec_w1, <span class="st">"EBA"</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>qq_sba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_SBA_prec_w1, <span class="st">"SBA"</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>painel_qq_prec <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(qq_cba, qq_eba, qq_sba, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>painel_qq_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/qqplot_prec.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ccc-de-lins" class="level4">
<h4 class="anchored" data-anchor-id="ccc-de-lins">CCC de Lins</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>observado_cba_prec <span class="ot">&lt;-</span> model_cba_prec<span class="sc">$</span>Prec</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>previsto_cba_prec  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_prec_w1)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>ccc_result_cba_prec  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_cba_prec , previsto_cba_prec )</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>ccc_val_cba_prec <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_cba_prec<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>observado_eba_prec <span class="ot">&lt;-</span> model_eba_prec<span class="sc">$</span>Prec</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>previsto_eba_prec  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_prec_w1)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>ccc_result_eba_prec  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_eba_prec , previsto_eba_prec )</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>ccc_val_eba_prec <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_eba_prec<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>observado_sba_prec <span class="ot">&lt;-</span> model_sba_prec<span class="sc">$</span>Prec</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>previsto_sba_prec  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_prec_w1)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>ccc_result_sba_prec  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_sba_prec , previsto_sba_prec )</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>ccc_val_sba_prec <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_sba_prec<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="efeitos-para-cada-ff_area-e-classe-florestal" class="level4">
<h4 class="anchored" data-anchor-id="efeitos-para-cada-ff_area-e-classe-florestal">Efeitos para cada ff_area e classe florestal</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos p/ plot “em_all”</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>em_df_cba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_CBA); em_df_cba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"CBA"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>em_df_eba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_EBA); em_df_eba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"EBA"</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>em_df_sba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_SBA); em_df_sba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"SBA"</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>em_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(em_df_cba, em_df_eba, em_df_sba) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparações dentro de cada faixa (matriz / pwpm)</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>em_cba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_prec_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>em_eba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_prec_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>em_sba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_prec_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                    PF SF_early SF_intermediate SF_advanced
PF              [2363]   &lt;.0001          &lt;.0001      0.0259
SF_early         134.1   [2229]          0.7641      0.0984
SF_intermediate  111.3    -22.8          [2252]      0.4786
SF_advanced       73.7    -60.3           -37.6      [2290]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [2396]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         176.0   [2220]          0.6686      0.1331
SF_intermediate  149.5    -26.5          [2246]      0.6539
SF_advanced      119.2    -56.8           -30.3      [2277]

ff_area = 20-30
                    PF SF_early SF_intermediate SF_advanced
PF              [2416]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         198.5   [2218]          0.5621      0.1419
SF_intermediate  168.1    -30.4          [2248]      0.7619
SF_advanced      142.4    -56.1           -25.6      [2274]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [2428]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         189.6   [2239]          0.7739      0.3572
SF_intermediate  167.2    -22.4          [2261]      0.8608
SF_advanced      146.6    -43.0           -20.6      [2282]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [2429]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         206.3   [2223]          0.2266      0.0799
SF_intermediate  161.7    -44.5          [2267]      0.9005
SF_advanced      143.6    -62.6           -18.1      [2286]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [2426]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         199.8   [2226]          0.0582      0.0073
SF_intermediate  141.0    -58.8          [2285]      0.7623
SF_advanced      115.4    -84.4           -25.6      [2311]

ff_area = 60-70
                     PF SF_early SF_intermediate SF_advanced
PF               [2433]   &lt;.0001          0.0001      0.0012
SF_early         203.35   [2229]          &lt;.0001      0.0003
SF_intermediate   99.62  -103.73          [2333]      0.9998
SF_advanced       97.42  -105.93           -2.19      [2335]

ff_area = 70-80
                    PF SF_early SF_intermediate SF_advanced
PF              [2440]   &lt;.0001          &lt;.0001      0.0110
SF_early         217.2   [2223]          0.0040      &lt;.0001
SF_intermediate  137.9    -79.3          [2302]      0.1336
SF_advanced       81.1   -136.1           -56.8      [2359]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [2443]   &lt;.0001          &lt;.0001      0.0011
SF_early         237.7   [2205]          &lt;.0001      &lt;.0001
SF_intermediate  110.3   -127.3          [2332]      0.9664
SF_advanced       98.1   -139.5           -12.2      [2345]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [2400]   &lt;.0001          0.3047      0.5253
SF_early         139.5   [2261]          0.0007      &lt;.0001
SF_intermediate   40.6    -98.9          [2359]      0.0195
SF_advanced      -35.6   -175.2           -76.2      [2436]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                    PF SF_early SF_intermediate SF_advanced
PF              [2627]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         490.7   [2136]          0.5290      0.0450
SF_intermediate  458.7    -32.0          [2168]      0.4947
SF_advanced      421.4    -69.3           -37.3      [2205]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [2573]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         493.7   [2079]          0.0412      &lt;.0001
SF_intermediate  431.1    -62.5          [2141]      0.0131
SF_advanced      350.6   -143.1           -80.6      [2222]

ff_area = 20-30
                    PF SF_early SF_intermediate SF_advanced
PF              [2529]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early           496   [2032]          0.0023      &lt;.0001
SF_intermediate    412      -84          [2116]      0.0002
SF_advanced        300     -196            -112      [2229]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [2461]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         460.3   [2000]          0.0009      &lt;.0001
SF_intermediate  370.4    -89.9          [2090]      &lt;.0001
SF_advanced      239.9   -220.4          -130.5      [2221]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [2379]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early           397   [1982]          0.0036      &lt;.0001
SF_intermediate    316      -81          [2063]      &lt;.0001
SF_advanced        195     -202            -121      [2183]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [2325]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         376.3   [1949]          0.0008      &lt;.0001
SF_intermediate  285.6    -90.7          [2040]      0.0007
SF_advanced      183.2   -193.1          -102.4      [2142]

ff_area = 60-70
                    PF SF_early SF_intermediate SF_advanced
PF              [2339]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         392.1   [1947]          0.0008      &lt;.0001
SF_intermediate  301.8    -90.3          [2037]      0.0401
SF_advanced      231.4   -160.7           -70.4      [2108]

ff_area = 70-80
                    PF SF_early SF_intermediate SF_advanced
PF              [2349]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         428.9   [1920]          &lt;.0001      &lt;.0001
SF_intermediate  323.0   -105.9          [2026]      0.0741
SF_advanced      258.8   -170.1           -64.2      [2090]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [2365]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         441.4   [1924]          &lt;.0001      &lt;.0001
SF_intermediate  324.8   -116.5          [2041]      0.3194
SF_advanced      279.5   -161.9           -45.3      [2086]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [2263]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         327.6   [1936]          &lt;.0001      &lt;.0001
SF_intermediate  199.9   -127.6          [2063]      0.0739
SF_advanced      135.8   -191.8           -64.2      [2127]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                    PF SF_early SF_intermediate SF_advanced
PF              [2100]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         102.7   [1998]          0.6357      0.0065
SF_intermediate  121.0     18.4          [1979]      0.1243
SF_advanced      159.2     56.5            38.2      [1941]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [2104]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         102.0   [2002]          0.5622      0.0003
SF_intermediate  122.1     20.1          [1981]      0.0172
SF_advanced      173.4     71.4            51.2      [1930]

ff_area = 20-30
                    PF SF_early SF_intermediate SF_advanced
PF              [2098]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         104.2   [1994]          0.5398      0.0003
SF_intermediate  124.8     20.7          [1973]      0.0220
SF_advanced      174.6     70.5            49.8      [1923]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [2099]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         113.7   [1985]          0.6174      0.0008
SF_intermediate  132.5     18.8          [1966]      0.0323
SF_advanced      180.0     66.3            47.5      [1919]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [2085]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early          99.7   [1985]          0.2787      &lt;.0001
SF_intermediate  127.4     27.7          [1957]      0.0100
SF_advanced      181.6     81.9            54.2      [1903]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [2080]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         100.0   [1980]          0.6127      0.0008
SF_intermediate  118.9     18.9          [1961]      0.0314
SF_advanced      166.5     66.6            47.7      [1913]

ff_area = 60-70
                    PF SF_early SF_intermediate SF_advanced
PF              [2091]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         116.3   [1975]          0.0470      &lt;.0001
SF_intermediate  156.5     40.2          [1935]      0.0390
SF_advanced      202.8     86.5            46.3      [1889]

ff_area = 70-80
                    PF SF_early SF_intermediate SF_advanced
PF              [2100]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         130.5   [1969]          0.0678      &lt;.0001
SF_intermediate  168.5     38.0          [1931]      0.0319
SF_advanced      216.1     85.6            47.6      [1884]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [2111]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         138.6   [1973]          0.0752      &lt;.0001
SF_intermediate  175.9     37.4          [1935]      0.0186
SF_advanced      226.7     88.1            50.8      [1884]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [2181]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         209.7   [1971]          0.0032      0.0003
SF_intermediate  263.2     53.5          [1918]      0.7730
SF_advanced      279.9     70.1            16.6      [1901]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar matriz como data.frame</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>pw_cba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>pw_eba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>pw_sba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>pw_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pw_cba_df, pw_eba_df, pw_sba_df)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(pw_df, <span class="at">file =</span> <span class="st">"data_group/matriz_contrastes_pwpm_prec.xlsx"</span>, <span class="at">rowNames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - análises</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>tabela_estilo_fig1 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region   =</span> region,</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover    =</span> Tipo,</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effect   =</span> emmean,</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> ff_area,</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> upper.CL</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"PREC"</span>,</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Cover, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(Interval, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Region, Cover, Interval) <span class="sc">%&gt;%</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  tabela_estilo_fig1,</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_prec.xlsx"</span>,</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - SI</span></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar tabela base</span></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,</span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(region, Interval, Cover,</span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">Effect =</span> emmean,</span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_upper =</span> upper.CL)</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorganizar para formato largo (larger table like Figure 2)</span></span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>tabela_fig2 <span class="ot">&lt;-</span> t2 <span class="sc">%&gt;%</span></span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover) <span class="sc">%&gt;%</span></span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> region,</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(Effect, CI_lower, CI_upper),</span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{region}_{.value}"</span></span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover)</span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a>  tabela_fig2,</span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_prec_table_final.xlsx"</span>,</span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="constrastes-e-significancia" class="level4">
<h4 class="anchored" data-anchor-id="constrastes-e-significancia">Constrastes e significancia</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>get_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>contrast_CBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_CBA_prec_w1, <span class="st">"CBA"</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>contrast_EBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_EBA_prec_w1, <span class="st">"EBA"</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>contrast_SBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_SBA_prec_w1, <span class="st">"SBA"</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) <span class="sc">%&gt;%</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"PF"</span>, contrast) <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"SF_"</span>, contrast)) <span class="sc">%&gt;%</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(contrast, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"tipo1"</span>, <span class="st">"tipo2"</span>), <span class="at">sep =</span> <span class="st">" - "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)) <span class="sc">|</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>         (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF − SF</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(all_contrasts, <span class="st">"data_group/contrast_PF_SF_prec.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="painel-prec" class="level3">
<h3 class="anchored" data-anchor-id="painel-prec">Painel Prec</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot de pontos</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>plot_point_prec <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(em_all, region <span class="sc">==</span> region_name) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_relevel</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_recode</span>(</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"PF"</span> <span class="ot">=</span> <span class="st">"PF"</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> emmean, <span class="at">color =</span> Tipo, <span class="at">group =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL, <span class="at">ymax =</span> upper.CL),</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_axes) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="sc">-</span><span class="dv">20</span>)) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"midnightblue"</span>, <span class="st">"#87CEFA"</span>, <span class="st">"#1E90FF"</span>, <span class="st">"#0000FF"</span>)) <span class="sc">+</span></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1800</span>, <span class="dv">2800</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1800</span>, <span class="dv">2800</span>, <span class="at">by =</span> <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#labs(y = if (show_y) "Precipitation\nfixed effects (mm·yr⁻¹)" else NULL) +</span></span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cf">if</span> (show_y) <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Estimated marginal mean"</span>, <span class="st">"precipitation (mm·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>))) <span class="cf">else</span> <span class="cn">NULL</span>) </span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Atualizar ordem dos fatores e renomear os labels</span></span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)),</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf_label =</span> <span class="fu">fct_recode</span>(tipo_sf,</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar coluna categórica para estimate</span></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_cat =</span> <span class="fu">factor</span>(</span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(estimate,</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="cn">Inf</span>),</span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;100"</span>, <span class="st">"100 to 200"</span>, <span class="st">"&gt;200"</span>)</span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;100"</span>, <span class="st">"100 to 200"</span>, <span class="st">"&gt;200"</span>)</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap de contrastes</span></span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>plot_heat_prec <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">filter</span>(all_contrasts, region <span class="sc">==</span> region_name), </span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> tipo_sf_label, <span class="at">fill =</span> estimate_cat)) <span class="sc">+</span></span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">height =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"&lt;100"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>, <span class="st">"100 to 200"</span> <span class="ot">=</span> <span class="st">"#4393C3"</span>, <span class="st">"&gt;200"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>),</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"&lt;100"</span>, <span class="st">"100 to 200"</span>, <span class="st">"&gt;200"</span>),</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a>                      <span class="at">drop =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"Prec (PF − SF)"</span>, <span class="st">"(mm)"</span>)))</span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_labels) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> region_name)</span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar gráficos para cada região</span></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a>panel_CBA_prec <span class="ot">&lt;-</span> <span class="fu">plot_heat_prec</span>(<span class="st">"CBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_prec</span>(<span class="st">"CBA"</span>, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-95"><a href="#cb90-95" aria-hidden="true" tabindex="-1"></a>panel_CBA_prec <span class="ot">&lt;-</span> panel_CBA_prec <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb90-96"><a href="#cb90-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a>panel_EBA_prec <span class="ot">&lt;-</span> <span class="fu">plot_heat_prec</span>(<span class="st">"EBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_prec</span>(<span class="st">"EBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-99"><a href="#cb90-99" aria-hidden="true" tabindex="-1"></a>panel_EBA_prec <span class="ot">&lt;-</span> panel_EBA_prec <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb90-100"><a href="#cb90-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-101"><a href="#cb90-101" aria-hidden="true" tabindex="-1"></a>panel_SBA_prec <span class="ot">&lt;-</span> <span class="fu">plot_heat_prec</span>(<span class="st">"SBA"</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb90-102"><a href="#cb90-102" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_prec</span>(<span class="st">"SBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-103"><a href="#cb90-103" aria-hidden="true" tabindex="-1"></a>panel_SBA_prec <span class="ot">&lt;-</span> panel_SBA_prec <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb90-104"><a href="#cb90-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-105"><a href="#cb90-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os painéis horizontalmente</span></span>
<span id="cb90-106"><a href="#cb90-106" aria-hidden="true" tabindex="-1"></a>final_panel_prec <span class="ot">&lt;-</span> (panel_CBA_prec <span class="sc">|</span> panel_EBA_prec <span class="sc">|</span> panel_SBA_prec)</span>
<span id="cb90-107"><a href="#cb90-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-108"><a href="#cb90-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir painel final</span></span>
<span id="cb90-109"><a href="#cb90-109" aria-hidden="true" tabindex="-1"></a>final_panel_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/em_fixed_fixed_prec.png"</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> final_panel_prec,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 4372400 233.6    7437494 397.3  7437494 397.3
Vcells 8113787  62.0   14786712 112.9 12255593  93.6</code></pre>
</div>
</div>
<section id="todos-os-constraste-entre-frações-de-área" class="level4">
<h4 class="anchored" data-anchor-id="todos-os-constraste-entre-frações-de-área">Todos os constraste entre frações de área</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de modelos</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>modelos <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">CBA =</span> model_CBA_prec_w1, <span class="at">EBA =</span> model_EBA_prec_w1, <span class="at">SBA =</span> model_SBA_prec_w1)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar todos os contrastes PF - SF</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>get_all_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area <span class="sc">*</span> Tipo)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para todas as regiões</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(modelos, <span class="fu">names</span>(modelos), get_all_contrasts)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(all_contrasts_sup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:
 $ contrast: chr  "(10-20 PF) - (1-10 PF)" "(20-30 PF) - (1-10 PF)" "(20-30 PF) - (10-20 PF)" "(30-40 PF) - (1-10 PF)" ...
 $ estimate: num  32.5 52.6 20.1 65 32.5 ...
 $ SE      : num  23.4 23.4 23.4 23.4 23.4 ...
 $ df      : num  702 702 702 702 702 ...
 $ t.ratio : num  1.389 2.251 0.861 2.781 1.392 ...
 $ p.value : num  0.2229 0.0408 0.4673 0.0104 0.2224 ...
 $ region  : chr  "CBA" "CBA" "CBA" "CBA" ...
 - attr(*, "estName")= chr "estimate"
 - attr(*, "pri.vars")= chr "contrast"
 - attr(*, "adjust")= chr "fdr"
 - attr(*, "side")= num 0
 - attr(*, "delta")= num 0
 - attr(*, "type")= chr "link"
 - attr(*, "mesg")= chr [1:2] "Degrees-of-freedom method: kenward-roger" "P value adjustment: fdr method for 780 tests"
 - attr(*, "digits")= int 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair contrastes entre PF e SF</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(contrast, <span class="st">"PF"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(contrast, <span class="st">"SF_"</span>))</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair informações usando regex</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Regex para capturar (faixa tipo) - (faixa tipo)</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>extr <span class="ot">&lt;-</span> <span class="fu">str_match</span>(all_contrasts_sup<span class="sc">$</span>contrast,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"</span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">) - </span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar colunas extraídas</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa1 =</span> extr[, <span class="dv">2</span>],</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo1 =</span> extr[, <span class="dv">3</span>],</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa2 =</span> extr[, <span class="dv">4</span>],</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo2 =</span> extr[, <span class="dv">5</span>]</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> sf_levels) <span class="sc">|</span> (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> sf_levels)) <span class="sc">%&gt;%</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa1, faixa2),</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa2, faixa1),</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF - SF</span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar fatores</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>faixas_niveis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>,</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">factor</span>(faixa_PF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">factor</span>(faixa_SF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">factor</span>(tipo_SF,  <span class="at">levels =</span> sf_levels)</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação mantendo sinal</span></span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF =</span> <span class="fu">fct_recode</span>(tipo_SF,</span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"&lt;0"</span>,</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"0-100"</span>,</span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"100–200"</span>,</span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">300</span> <span class="sc">~</span> <span class="st">"200–300"</span>,</span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">300</span> <span class="sc">~</span> <span class="st">"&gt;300"</span></span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">factor</span>(estimate_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;0"</span>, <span class="st">"0-100"</span>, <span class="st">"100–200"</span>, <span class="st">"200–300"</span>, <span class="st">"&gt;300"</span>))</span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_contrasts_sup, </span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> faixa_SF, <span class="at">y =</span> faixa_PF, <span class="at">fill =</span> estimate_class)) <span class="sc">+</span></span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;0"</span> <span class="ot">=</span> <span class="st">"#F4A582"</span>,</span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0-100"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>,</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">"100–200"</span> <span class="ot">=</span> <span class="st">"#4393C3"</span>,</span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"200–300"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>,</span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&gt;300"</span> <span class="ot">=</span> <span class="st">"#053061"</span></span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"Prec (PF - SF)"</span>, <span class="st">"(mm)"</span>))))<span class="sc">+</span></span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(tipo_SF <span class="sc">~</span> region) <span class="sc">+</span></span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"SF fractional cover (%)"</span>,</span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"PF fractional cover (%)"</span>)</span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_prec.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_prec.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 4391410 234.6    7437494 397.3  7437494 397.3
Vcells 8170434  62.4   14786712 112.9 14786712 112.9</code></pre>
</div>
</div>
</section>
</section>
<section id="random-effect" class="level3">
<h3 class="anchored" data-anchor-id="random-effect">Random effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para extrair efeitos aleatórios com IC por região</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>extract_random_effects <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Efeitos aleatórios com variância condicional</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  ran <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model, <span class="at">condVar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extrair efeitos por ano</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(ran_df) <span class="ot">&lt;-</span> <span class="st">"effect"</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  ran_df<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">rownames</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intervalos de confiança (erro padrão)</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">attr</span>(ran<span class="sc">$</span>Ano, <span class="st">"postVar"</span>)[<span class="dv">1</span>, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> ran_df <span class="sc">%&gt;%</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> se,</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> effect <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper =</span> effect <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">region =</span> region_name</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ran_df)</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para os três modelos (substitua pelos seus objetos reais)</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>random_cba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_CBA_prec_w1, <span class="st">"CBA"</span>)</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>random_eba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_EBA_prec_w1, <span class="st">"EBA"</span>)</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>random_sba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_SBA_prec_w1, <span class="st">"SBA"</span>)</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar tudo</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>random_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(random_cba, random_eba, random_sba)</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir que o ano seja ordenável</span></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>random_all<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(random_all<span class="sc">$</span>ano))</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(random_all, <span class="st">"data_group/random_effects_prec.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot" class="level5">
<h5 class="anchored" data-anchor-id="plot">Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>p1_rand_prec <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(random_all, <span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> effect)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="st">"#1E90FF"</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2001</span>, <span class="dv">2021</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">#axis.text.x = element_text(angle = 45, hjust = 1),</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Precipitation"</span>, <span class="st">"random effects (mm·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>)))</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>p1_rand_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/histogram_random_prec.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="predicted" class="level3">
<h3 class="anchored" data-anchor-id="predicted">Predicted</h3>
<section id="plot-1" class="level5">
<h5 class="anchored" data-anchor-id="plot-1">Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model_cba_prec<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_prec_w1, model_cba_prec)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>model_eba_prec<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_prec_w1, model_eba_prec)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>model_sba_prec<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_prec_w1, model_sba_prec)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>r2_cba_prec_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_CBA_prec_w1, model_cba_prec, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>r2_eba_prec_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_EBA_prec_w1, model_eba_prec, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>r2_sba_prec_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_SBA_prec_w1, model_sba_prec, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>all_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(model_cba_prec<span class="sc">$</span>Prec, model_cba_prec<span class="sc">$</span>predicted,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>              model_eba_prec<span class="sc">$</span>Prec, model_eba_prec<span class="sc">$</span>predicted,</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>              model_sba_prec<span class="sc">$</span>Prec, model_sba_prec<span class="sc">$</span>predicted)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>rng     <span class="ot">&lt;-</span> <span class="fu">range</span>(all_vals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>pad     <span class="ot">&lt;-</span> <span class="fl">0.02</span> <span class="sc">*</span> <span class="fu">diff</span>(rng)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>((rng[<span class="dv">1</span>] <span class="sc">-</span> pad) <span class="sc">/</span> <span class="dv">300</span>) <span class="sc">*</span> <span class="dv">300</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((rng[<span class="dv">2</span>] <span class="sc">-</span> pad)  <span class="sc">/</span> <span class="dv">300</span>) <span class="sc">*</span> <span class="dv">300</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>brks    <span class="ot">&lt;-</span> <span class="fu">seq</span>(lim_min, lim_max, <span class="at">by =</span> <span class="dv">300</span>)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Função base do gráfico (escala 1:1 e linha 45°)</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, titulo, subtitulo){</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Prec, predicted)) <span class="sc">+</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span>  </span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Observed</span><span class="sc">\n</span><span class="st">precipitation (mm·yr⁻¹)"</span>,</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Predicted</span><span class="sc">\n</span><span class="st">precipitation (mm·yr⁻¹)"</span>,  <span class="co"># mostra o eixo y em TODOS</span></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> titulo,</span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitulo</span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="painel" class="level5">
<h5 class="anchored" data-anchor-id="painel">Painel</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>cba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_cba_prec, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_cba_prec_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_cba_prec))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>eba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_eba_prec, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_eba_prec_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_eba_prec)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>sba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_sba_prec, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_sba_prec_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_sba_prec)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>p1_pred_prec <span class="ot">&lt;-</span> (cba_pf <span class="sc">+</span> eba_pf <span class="sc">+</span> sba_pf) <span class="sc">+</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>p1_pred_prec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_observed_prec.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">7.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-plotting" class="level3">
<h3 class="anchored" data-anchor-id="model-plotting">Model plotting</h3>
<section id="cba" class="level4">
<h4 class="anchored" data-anchor-id="cba">CBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec <span class="ot">&lt;-</span> model_cba_prec <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_CBA_prec_w1)  </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec <span class="ot">&lt;-</span> model_cba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec[model_cba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_prec <span class="ot">&lt;-</span> model_cba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>m1_prec_cba <span class="ot">&lt;-</span> model_cba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Prec, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1800</span>, <span class="dv">2700</span>, <span class="at">by =</span> <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted precipitation (mm·yr⁻¹) - CBA"</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>m1_prec_cba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_prec_CBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eba" class="level4">
<h4 class="anchored" data-anchor-id="eba">EBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec <span class="ot">&lt;-</span> model_eba_prec <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_EBA_prec_w1)  </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec <span class="ot">&lt;-</span> model_eba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec[model_eba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_prec <span class="ot">&lt;-</span> model_eba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>m1_prec_eba <span class="ot">&lt;-</span> model_eba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Prec, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1700</span>, <span class="dv">2600</span>, <span class="at">by =</span> <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted precipitation (mm·yr⁻¹) - EBA"</span>,</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>m1_prec_eba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_prec_EBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sba" class="level4">
<h4 class="anchored" data-anchor-id="sba">SBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec <span class="ot">&lt;-</span> model_sba_prec <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_SBA_prec_w1)  </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec <span class="ot">&lt;-</span> model_sba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec[model_sba_all_prec<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_prec <span class="ot">&lt;-</span> model_sba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>m1_prec_sba <span class="ot">&lt;-</span> model_sba_all_prec <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Prec))<span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Prec, <span class="at">color =</span> vegetation)) <span class="sc">+</span> </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation, <span class="at">color =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1600</span>, <span class="dv">2500</span>, <span class="at">by =</span> <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted precipitation (mm·yr⁻¹) - SBA"</span>,</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Tamanho do texto da legenda</span></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>m1_prec_sba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_prec_SBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="evapotranspiration-1" class="level2">
<h2 class="anchored" data-anchor-id="evapotranspiration-1">EVAPOTRANSPIRATION</h2>
<section id="model-choice-1" class="level3">
<h3 class="anchored" data-anchor-id="model-choice-1">Model choice</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_evapo_model <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_evapo.xlsx"</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a ordem correta das categorias</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>ord_ff   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>lev_tipo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodifica como fatores na ordem correta</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>recode_fac <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> ord_ff, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> lev_tipo)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Separa por região e aplica a recodificação</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>model_cba_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"CBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>model_eba_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"EBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>model_sba_evapo <span class="ot">&lt;-</span> all_pf_sf_evapo_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"SBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria um identificador para cada estrato</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>add_estrato <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>estrato_id <span class="ot">&lt;-</span> <span class="fu">interaction</span>(d<span class="sc">$</span>region, d<span class="sc">$</span>ff_area, d<span class="sc">$</span>Tipo, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>  d</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>model_cba_evapo <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_cba_evapo)</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>model_eba_evapo <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_eba_evapo)</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>model_sba_evapo <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_sba_evapo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fixed-effect-1" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effect-1">Fixed effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CBA</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>model_CBA_evapo_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Evapo <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_cba_evapo)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># EBA</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>model_EBA_evapo_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Evapo <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_eba_evapo)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SBA</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>model_SBA_evapo_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Evapo <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_sba_evapo)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Conferir coeficientes fixos rapidamente</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_CBA_evapo_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term          estimate std.error  statistic    df   p.value
   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 fixed  (Intercept) 1432.           6.42 223.        21.7 5.27e- 38
 2 fixed  ff_area.L    127.           4.92  25.8      702.  1.51e-103
 3 fixed  ff_area.Q    -47.0          4.92  -9.56     702.  1.88e- 20
 4 fixed  ff_area.C     27.9          4.92   5.68     702.  1.96e-  8
 5 fixed  ff_area^4     -1.26         4.92  -0.255    702.  7.98e-  1
 6 fixed  ff_area^5      4.85         4.92   0.986    702.  3.24e-  1
 7 fixed  ff_area^6      1.42         4.92   0.290    702.  7.72e-  1
 8 fixed  ff_area^7      1.17         4.92   0.238    702.  8.12e-  1
 9 fixed  ff_area^8      0.00189      4.92   0.000385 702.  1.00e+  0
10 fixed  ff_area^9      0.763        4.92   0.155    702.  8.77e-  1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_EBA_evapo_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept)  1511.        6.12   247.     21.3 2.83e-38
 2 fixed  ff_area.L      59.5       3.95    15.1   710.  1.19e-44
 3 fixed  ff_area.Q     -36.4       3.95    -9.22  710.  3.38e-19
 4 fixed  ff_area.C      22.0       3.95     5.56  710.  3.84e- 8
 5 fixed  ff_area^4      -5.25      3.95    -1.33  710.  1.84e- 1
 6 fixed  ff_area^5      -3.34      3.95    -0.845 710.  3.98e- 1
 7 fixed  ff_area^6       2.71      3.95     0.686 710.  4.93e- 1
 8 fixed  ff_area^7       2.99      3.95     0.757 710.  4.49e- 1
 9 fixed  ff_area^8      -1.90      3.95    -0.481 710.  6.31e- 1
10 fixed  ff_area^9      -1.71      3.95    -0.432 710.  6.66e- 1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_SBA_evapo_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept)  1396.       12.4    113.     20.6 3.45e-30
 2 fixed  ff_area.L      95.3       5.52    17.3   710.  5.20e-56
 3 fixed  ff_area.Q     -10.0       5.52    -1.81  710.  7.01e- 2
 4 fixed  ff_area.C      19.2       5.52     3.48  710.  5.27e- 4
 5 fixed  ff_area^4      -5.46      5.52    -0.988 710.  3.23e- 1
 6 fixed  ff_area^5      -3.44      5.52    -0.623 710.  5.34e- 1
 7 fixed  ff_area^6       5.12      5.52     0.928 710.  3.54e- 1
 8 fixed  ff_area^7       3.93      5.52     0.712 710.  4.77e- 1
 9 fixed  ff_area^8      -3.54      5.52    -0.641 710.  5.21e- 1
10 fixed  ff_area^9      -2.38      5.52    -0.432 710.  6.66e- 1
# ℹ 30 more rows</code></pre>
</div>
</div>
<section id="r-square-for-linear-mixed-model-lmm-1" class="level4">
<h4 class="anchored" data-anchor-id="r-square-for-linear-mixed-model-lmm-1">R-square for Linear Mixed Model (LMM)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Helpers coerentes com o ajuste ----</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>weighted_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(y, w) <span class="fu">sum</span>(w<span class="sc">*</span>y)<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>r2_w_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat, w) {</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  sst <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> <span class="fu">weighted_mean</span>(y, w))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  ssr <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> ssr<span class="sc">/</span>sst</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co"># R² ponderado "marginal" (fixos) e "condicional" (fixos + RE) </span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>r2_lmer_w <span class="ot">&lt;-</span> <span class="cf">function</span>(m, dat, <span class="at">resp =</span> <span class="st">"Evapo"</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"marg"</span>,<span class="st">"cond"</span>)) {</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(type)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">weights</span>(m))            </span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dat[[resp]]</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"marg"</span>) <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="sc">~</span><span class="dv">0</span>) <span class="cf">else</span> <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="cn">NULL</span>)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2_w_sse</span>(y, yhat, w)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>r2_cba_evapo <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_evapo_w1, model_cba_evapo, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_evapo_w1, model_cba_evapo, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>r2_eba_evapo <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_evapo_w1, model_eba_evapo, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_evapo_w1, model_eba_evapo, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>r2_sba_evapo <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_evapo_w1, model_sba_evapo, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_evapo_w1, model_sba_evapo, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>r2_cba_evapo; r2_eba_evapo; r2_sba_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.5126236 0.8141419 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.7185876 0.9187478 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.3175876 0.8767470 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar (opcional)</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>r2_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">c</span>(<span class="st">"CBA"</span>,<span class="st">"EBA"</span>,<span class="st">"SBA"</span>),</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">c</span>(r2_cba_evapo[<span class="st">"R2_marg_w"</span>], r2_eba_evapo[<span class="st">"R2_marg_w"</span>], r2_sba_evapo[<span class="st">"R2_marg_w"</span>]),</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">c</span>(r2_cba_evapo[<span class="st">"R2_cond_w"</span>], r2_eba_evapo[<span class="st">"R2_cond_w"</span>], r2_sba_evapo[<span class="st">"R2_cond_w"</span>])</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(r2_tbl, <span class="st">"data_group/r2_weighted_evapo.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste múltiplo BH para comparações por faixa.</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>emm_CBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_evapo_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_CBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                 -102.043 6.95 702 -14.676  &lt;.0001
 PF - SF_intermediate          -101.280 6.95 702 -14.566  &lt;.0001
 PF - SF_advanced               -95.824 7.80 702 -12.286  &lt;.0001
 SF_early - SF_intermediate       0.763 6.95 702   0.110  0.9127
 SF_early - SF_advanced           6.219 7.80 702   0.797  0.5814
 SF_intermediate - SF_advanced    5.456 7.80 702   0.700  0.5814

ff_area = 10-20:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -72.885 6.95 702 -10.482  &lt;.0001
 PF - SF_intermediate           -68.436 6.95 702  -9.842  &lt;.0001
 PF - SF_advanced               -62.131 7.80 702  -7.966  &lt;.0001
 SF_early - SF_intermediate       4.449 6.95 702   0.640  0.5225
 SF_early - SF_advanced          10.755 7.80 702   1.379  0.2525
 SF_intermediate - SF_advanced    6.306 7.80 702   0.808  0.5029

ff_area = 20-30:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -51.241 6.95 702  -7.369  &lt;.0001
 PF - SF_intermediate           -50.415 6.95 702  -7.251  &lt;.0001
 PF - SF_advanced               -47.920 7.80 702  -6.144  &lt;.0001
 SF_early - SF_intermediate       0.826 6.95 702   0.119  0.9055
 SF_early - SF_advanced           3.321 7.80 702   0.426  0.8989
 SF_intermediate - SF_advanced    2.495 7.80 702   0.320  0.8989

ff_area = 30-40:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -46.597 6.95 702  -6.701  &lt;.0001
 PF - SF_intermediate           -42.765 6.95 702  -6.150  &lt;.0001
 PF - SF_advanced               -38.897 7.80 702  -4.987  &lt;.0001
 SF_early - SF_intermediate       3.832 6.95 702   0.551  0.6201
 SF_early - SF_advanced           7.700 7.80 702   0.987  0.4858
 SF_intermediate - SF_advanced    3.868 7.80 702   0.496  0.6201

ff_area = 40-50:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -41.800 6.95 702  -6.012  &lt;.0001
 PF - SF_intermediate           -43.790 6.95 702  -6.298  &lt;.0001
 PF - SF_advanced               -33.911 7.80 702  -4.348  &lt;.0001
 SF_early - SF_intermediate      -1.990 6.95 702  -0.286  0.7748
 SF_early - SF_advanced           7.889 7.80 702   1.011  0.3746
 SF_intermediate - SF_advanced    9.879 7.80 702   1.267  0.3085

ff_area = 50-60:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -37.683 6.95 702  -5.420  &lt;.0001
 PF - SF_intermediate           -34.691 6.95 702  -4.989  &lt;.0001
 PF - SF_advanced               -35.836 7.80 702  -4.595  &lt;.0001
 SF_early - SF_intermediate       2.992 6.95 702   0.430  0.8833
 SF_early - SF_advanced           1.847 7.80 702   0.237  0.8833
 SF_intermediate - SF_advanced   -1.145 7.80 702  -0.147  0.8833

ff_area = 60-70:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -42.493 6.95 702  -6.111  &lt;.0001
 PF - SF_intermediate           -27.344 6.95 702  -3.933  0.0002
 PF - SF_advanced               -36.964 7.80 702  -4.739  &lt;.0001
 SF_early - SF_intermediate      15.149 6.95 702   2.179  0.0445
 SF_early - SF_advanced           5.529 7.80 702   0.709  0.4786
 SF_intermediate - SF_advanced   -9.620 7.80 702  -1.233  0.2614

ff_area = 70-80:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -32.888 6.95 702  -4.730  &lt;.0001
 PF - SF_intermediate           -46.373 6.95 702  -6.669  &lt;.0001
 PF - SF_advanced               -32.197 7.80 702  -4.128  0.0001
 SF_early - SF_intermediate     -13.485 6.95 702  -1.939  0.0793
 SF_early - SF_advanced           0.691 7.80 702   0.089  0.9294
 SF_intermediate - SF_advanced   14.176 7.80 702   1.818  0.0835

ff_area = 80-90:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -38.717 7.14 702  -5.424  &lt;.0001
 PF - SF_intermediate           -28.779 6.95 702  -4.139  0.0001
 PF - SF_advanced               -31.457 7.80 702  -4.033  0.0001
 SF_early - SF_intermediate       9.938 7.14 702   1.392  0.2465
 SF_early - SF_advanced           7.260 7.97 702   0.911  0.4353
 SF_intermediate - SF_advanced   -2.678 7.80 702  -0.343  0.7314

ff_area = 90-100:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -36.562 7.63 702  -4.789  &lt;.0001
 PF - SF_intermediate            -7.240 6.95 702  -1.041  0.2981
 PF - SF_advanced                16.156 7.80 702   2.071  0.0464
 SF_early - SF_intermediate      29.322 7.63 702   3.841  0.0003
 SF_early - SF_advanced          52.718 8.43 702   6.252  &lt;.0001
 SF_intermediate - SF_advanced   23.396 7.80 702   3.000  0.0042

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>emm_EBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_evapo_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_EBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -14.2889 5.59 710  -2.556  0.0324
 PF - SF_intermediate           -14.3557 5.59 710  -2.568  0.0324
 PF - SF_advanced                -8.9664 6.27 710  -1.430  0.3065
 SF_early - SF_intermediate      -0.0668 5.59 710  -0.012  0.9905
 SF_early - SF_advanced           5.3224 6.27 710   0.849  0.4756
 SF_intermediate - SF_advanced    5.3892 6.27 710   0.859  0.4756

ff_area = 10-20:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -17.6808 5.59 710  -3.162  0.0098
 PF - SF_intermediate           -13.2070 5.59 710  -2.362  0.0553
 PF - SF_advanced                -7.8041 6.27 710  -1.244  0.3207
 SF_early - SF_intermediate       4.4739 5.59 710   0.800  0.4239
 SF_early - SF_advanced           9.8768 6.27 710   1.575  0.2315
 SF_intermediate - SF_advanced    5.4029 6.27 710   0.861  0.4239

ff_area = 20-30:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -20.8699 5.59 710  -3.733  0.0012
 PF - SF_intermediate           -17.0657 5.59 710  -3.052  0.0071
 PF - SF_advanced               -13.7665 6.27 710  -2.195  0.0570
 SF_early - SF_intermediate       3.8042 5.59 710   0.680  0.5958
 SF_early - SF_advanced           7.1033 6.27 710   1.133  0.3866
 SF_intermediate - SF_advanced    3.2991 6.27 710   0.526  0.5990

ff_area = 30-40:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -29.5766 5.59 710  -5.290  &lt;.0001
 PF - SF_intermediate           -23.4856 5.59 710  -4.201  0.0001
 PF - SF_advanced               -21.2858 6.27 710  -3.394  0.0015
 SF_early - SF_intermediate       6.0910 5.59 710   1.089  0.3316
 SF_early - SF_advanced           8.2907 6.27 710   1.322  0.2799
 SF_intermediate - SF_advanced    2.1998 6.27 710   0.351  0.7259

ff_area = 40-50:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -42.0496 5.59 710  -7.521  &lt;.0001
 PF - SF_intermediate           -38.7869 5.59 710  -6.937  &lt;.0001
 PF - SF_advanced               -33.9783 6.27 710  -5.418  &lt;.0001
 SF_early - SF_intermediate       3.2627 5.59 710   0.584  0.5597
 SF_early - SF_advanced           8.0713 6.27 710   1.287  0.2978
 SF_intermediate - SF_advanced    4.8086 6.27 710   0.767  0.5322

ff_area = 50-60:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -64.0210 5.59 710 -11.451  &lt;.0001
 PF - SF_intermediate           -58.9236 5.59 710 -10.539  &lt;.0001
 PF - SF_advanced               -55.5342 6.27 710  -8.855  &lt;.0001
 SF_early - SF_intermediate       5.0974 5.59 710   0.912  0.4347
 SF_early - SF_advanced           8.4867 6.27 710   1.353  0.2646
 SF_intermediate - SF_advanced    3.3894 6.27 710   0.540  0.5891

ff_area = 60-70:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -79.9467 5.59 710 -14.299  &lt;.0001
 PF - SF_intermediate           -68.8807 5.59 710 -12.320  &lt;.0001
 PF - SF_advanced               -66.8260 6.27 710 -10.656  &lt;.0001
 SF_early - SF_intermediate      11.0660 5.59 710   1.979  0.0578
 SF_early - SF_advanced          13.1206 6.27 710   2.092  0.0552
 SF_intermediate - SF_advanced    2.0547 6.27 710   0.328  0.7433

ff_area = 70-80:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -97.5165 5.59 710 -17.442  &lt;.0001
 PF - SF_intermediate           -79.6913 5.59 710 -14.253  &lt;.0001
 PF - SF_advanced               -71.1829 6.27 710 -11.350  &lt;.0001
 SF_early - SF_intermediate      17.8251 5.59 710   3.188  0.0018
 SF_early - SF_advanced          26.3335 6.27 710   4.199  &lt;.0001
 SF_intermediate - SF_advanced    8.5084 6.27 710   1.357  0.1753

ff_area = 80-90:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                  -99.3482 5.59 710 -17.769  &lt;.0001
 PF - SF_intermediate           -96.2500 5.59 710 -17.215  &lt;.0001
 PF - SF_advanced               -74.1865 6.27 710 -11.829  &lt;.0001
 SF_early - SF_intermediate       3.0982 5.59 710   0.554  0.5797
 SF_early - SF_advanced          25.1617 6.27 710   4.012  0.0001
 SF_intermediate - SF_advanced   22.0635 6.27 710   3.518  0.0006

ff_area = 90-100:
 contrast                       estimate   SE  df t.ratio p.value
 PF - SF_early                 -120.6131 5.59 710 -21.573  &lt;.0001
 PF - SF_intermediate           -97.8259 5.59 710 -17.497  &lt;.0001
 PF - SF_advanced               -79.1335 6.27 710 -12.618  &lt;.0001
 SF_early - SF_intermediate      22.7872 5.59 710   4.076  0.0001
 SF_early - SF_advanced          41.4795 6.27 710   6.614  &lt;.0001
 SF_intermediate - SF_advanced   18.6924 6.27 710   2.981  0.0030

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>emm_SBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_evapo_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_SBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   13.961 7.81 710   1.788  0.1882
 PF - SF_intermediate            14.326 7.81 710   1.835  0.1882
 PF - SF_advanced                14.684 8.76 710   1.676  0.1882
 SF_early - SF_intermediate       0.365 7.81 710   0.047  0.9674
 SF_early - SF_advanced           0.724 8.76 710   0.083  0.9674
 SF_intermediate - SF_advanced    0.359 8.76 710   0.041  0.9674

ff_area = 10-20:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   -9.745 7.81 710  -1.248  0.4681
 PF - SF_intermediate            -3.572 7.81 710  -0.457  0.6475
 PF - SF_advanced                 6.861 8.76 710   0.783  0.5205
 SF_early - SF_intermediate       6.173 7.81 710   0.791  0.5205
 SF_early - SF_advanced          16.606 8.76 710   1.896  0.3503
 SF_intermediate - SF_advanced   10.433 8.76 710   1.191  0.4681

ff_area = 20-30:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   -9.094 7.81 710  -1.165  0.6729
 PF - SF_intermediate           -13.639 7.81 710  -1.747  0.4868
 PF - SF_advanced                -7.583 8.76 710  -0.866  0.6729
 SF_early - SF_intermediate      -4.545 7.81 710  -0.582  0.6729
 SF_early - SF_advanced           1.511 8.76 710   0.173  0.8631
 SF_intermediate - SF_advanced    6.056 8.76 710   0.691  0.6729

ff_area = 30-40:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                   -2.101 7.81 710  -0.269  0.7880
 PF - SF_intermediate           -12.919 7.81 710  -1.654  0.4991
 PF - SF_advanced                -8.812 8.76 710  -1.006  0.6295
 SF_early - SF_intermediate     -10.818 7.81 710  -1.385  0.4991
 SF_early - SF_advanced          -6.711 8.76 710  -0.766  0.6657
 SF_intermediate - SF_advanced    4.107 8.76 710   0.469  0.7672

ff_area = 40-50:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -15.183 7.81 710  -1.944  0.1045
 PF - SF_intermediate           -22.151 7.81 710  -2.837  0.0281
 PF - SF_advanced               -19.191 8.76 710  -2.191  0.0863
 SF_early - SF_intermediate      -6.968 7.81 710  -0.892  0.5588
 SF_early - SF_advanced          -4.008 8.76 710  -0.458  0.7355
 SF_intermediate - SF_advanced    2.960 8.76 710   0.338  0.7355

ff_area = 50-60:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -19.399 7.81 710  -2.484  0.0198
 PF - SF_intermediate           -42.412 7.81 710  -5.431  &lt;.0001
 PF - SF_advanced               -36.098 8.76 710  -4.121  0.0001
 SF_early - SF_intermediate     -23.013 7.81 710  -2.947  0.0066
 SF_early - SF_advanced         -16.699 8.76 710  -1.906  0.0684
 SF_intermediate - SF_advanced    6.314 8.76 710   0.721  0.4712

ff_area = 60-70:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -18.109 7.81 710  -2.319  0.0310
 PF - SF_intermediate           -36.696 7.81 710  -4.699  &lt;.0001
 PF - SF_advanced               -25.248 8.76 710  -2.882  0.0122
 SF_early - SF_intermediate     -18.587 7.81 710  -2.380  0.0310
 SF_early - SF_advanced          -7.138 8.76 710  -0.815  0.4154
 SF_intermediate - SF_advanced   11.448 8.76 710   1.307  0.2300

ff_area = 70-80:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -15.933 7.81 710  -2.040  0.0834
 PF - SF_intermediate           -25.989 7.81 710  -3.328  0.0055
 PF - SF_advanced               -22.314 8.76 710  -2.548  0.0332
 SF_early - SF_intermediate     -10.056 7.81 710  -1.288  0.2973
 SF_early - SF_advanced          -6.381 8.76 710  -0.729  0.5598
 SF_intermediate - SF_advanced    3.675 8.76 710   0.420  0.6749

ff_area = 80-90:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                  -13.190 7.81 710  -1.689  0.1611
 PF - SF_intermediate           -25.778 7.81 710  -3.301  0.0061
 PF - SF_advanced                -4.639 8.76 710  -0.530  0.5965
 SF_early - SF_intermediate     -12.588 7.81 710  -1.612  0.1611
 SF_early - SF_advanced           8.551 8.76 710   0.976  0.3951
 SF_intermediate - SF_advanced   21.139 8.76 710   2.413  0.0482

ff_area = 90-100:
 contrast                      estimate   SE  df t.ratio p.value
 PF - SF_early                    0.225 7.81 710   0.029  0.9771
 PF - SF_intermediate           -31.358 7.81 710  -4.016  0.0002
 PF - SF_advanced                -8.065 8.76 710  -0.921  0.4290
 SF_early - SF_intermediate     -31.583 7.81 710  -4.045  0.0002
 SF_early - SF_advanced          -8.289 8.76 710  -0.946  0.4290
 SF_intermediate - SF_advanced   23.294 8.76 710   2.659  0.0160

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
</div>
<section id="heterocedasticidade-1" class="level5">
<h5 class="anchored" data-anchor-id="heterocedasticidade-1">Heterocedasticidade</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função: resíduos normalizados vs n_obs, com controle de eixos</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>plot_resid_hetero <span class="ot">&lt;-</span> <span class="cf">function</span>(m_lme, dat, region_name,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m_lme, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">n_obs =</span> dat<span class="sc">$</span>n_obs, <span class="at">rnorm =</span> rn),</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(n_obs, rnorm)) <span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)  </span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#title = region_name,</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x = if (show_x_lab) expression(n[obs]~"(log scale)") else NULL,  </span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cf">if</span> (show_x_lab) <span class="st">""</span> <span class="cf">else</span> <span class="cn">NULL</span>,</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="cf">if</span> (show_y_lab) <span class="st">"Residuals"</span> <span class="cf">else</span> <span class="cn">NULL</span>             </span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Monta cada painel com as regras pedidas:</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co"># - CBA: só Y</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>p_het_cba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_CBA_evapo_w1, model_cba_evapo, <span class="st">"CBA"</span>,</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a><span class="co"># - EBA: só X</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>p_het_eba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_EBA_evapo_w1, model_eba_evapo, <span class="st">"EBA"</span>,</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="co"># - SBA: sem X e sem Y</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>p_het_sba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_SBA_evapo_w1, model_sba_evapo, <span class="st">"SBA"</span>,</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel 1x3</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>painel_het_evapo <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(p_het_cba, p_het_eba, p_het_sba,</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>painel_het_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/hetero_residuals_lme_evapo.png"</span>, <span class="at">width=</span><span class="dv">8</span>, <span class="at">height=</span><span class="dv">6</span>, <span class="at">dpi=</span><span class="dv">400</span>, <span class="at">bg=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="qq-plot-1" class="level5">
<h5 class="anchored" data-anchor-id="qq-plot-1">QQ PLOT</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>qq_lme <span class="ot">&lt;-</span> <span class="cf">function</span>(m, region_name, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>){</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">rn=</span>rn), <span class="fu">aes</span>(<span class="at">sample =</span> rn)) <span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># &lt;- aqui</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y_title) <span class="fu">element_text</span>() <span class="cf">else</span> <span class="fu">element_blank</span>()</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> region_name, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="cf">if</span> (show_y_title) <span class="st">"Sample quantiles"</span> <span class="cf">else</span> <span class="cn">NULL</span>)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="co"># y apenas no primeiro </span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>qq_cba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_CBA_evapo_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>qq_eba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_EBA_evapo_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>qq_sba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_SBA_evapo_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>painel_qq_evapo <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(qq_cba, qq_eba, qq_sba, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>painel_qq_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/qqplot_evapo.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ccc-de-lins-1" class="level4">
<h4 class="anchored" data-anchor-id="ccc-de-lins-1">CCC de Lins</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>observado_cba_evapo <span class="ot">&lt;-</span> model_cba_evapo<span class="sc">$</span>Evapo</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>previsto_cba_evapo  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_evapo_w1)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>ccc_result_cba_evapo  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_cba_evapo , previsto_cba_evapo )</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>ccc_val_cba_evapo <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_cba_evapo<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>observado_eba_evapo <span class="ot">&lt;-</span> model_eba_evapo<span class="sc">$</span>Evapo</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>previsto_eba_evapo  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_evapo_w1)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>ccc_result_eba_evapo  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_eba_evapo , previsto_eba_evapo )</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>ccc_val_eba_evapo <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_eba_evapo<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>observado_sba_evapo <span class="ot">&lt;-</span> model_sba_evapo<span class="sc">$</span>Evapo</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>previsto_sba_evapo  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_evapo_w1)</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>ccc_result_sba_evapo  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_sba_evapo , previsto_sba_evapo )</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>ccc_val_sba_evapo <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_sba_evapo<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="efeitos-para-cada-ff_area-e-classe-florestal-1" class="level4">
<h4 class="anchored" data-anchor-id="efeitos-para-cada-ff_area-e-classe-florestal-1">Efeitos para cada ff_area e classe florestal</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos p/ plot “em_all”</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>em_df_cba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_CBA); em_df_cba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"CBA"</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>em_df_eba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_EBA); em_df_eba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"EBA"</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>em_df_sba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_SBA); em_df_sba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"SBA"</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>em_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(em_df_cba, em_df_eba, em_df_sba) <span class="sc">%&gt;%</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparações dentro de cada faixa (matriz / pwpm)</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>em_cba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_evapo_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>em_eba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_evapo_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>em_sba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_evapo_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                      PF SF_early SF_intermediate SF_advanced
PF                [1331]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -102.043   [1433]          0.9995      0.8557
SF_intermediate -101.280    0.763          [1432]      0.8973
SF_advanced      -95.824    6.219           5.456      [1427]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [1382]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -72.89   [1455]          0.9191      0.5130
SF_intermediate -68.44     4.45          [1451]      0.8505
SF_advanced     -62.13    10.75            6.31      [1444]

ff_area = 20-30
                     PF SF_early SF_intermediate SF_advanced
PF               [1412]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -51.241   [1463]          0.9994      0.9741
SF_intermediate -50.415    0.826          [1462]      0.9887
SF_advanced     -47.920    3.321           2.495      [1460]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [1432]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -46.60   [1478]          0.9463      0.7568
SF_intermediate -42.76     3.83          [1475]      0.9600
SF_advanced     -38.90     7.70            3.87      [1471]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [1443]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -41.80   [1485]          0.9918      0.7428
SF_intermediate -43.79    -1.99          [1487]      0.5845
SF_advanced     -33.91     7.89            9.88      [1477]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [1452]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -37.68   [1490]          0.9733      0.9953
SF_intermediate -34.69     2.99          [1487]      0.9989
SF_advanced     -35.84     1.85           -1.15      [1488]

ff_area = 60-70
                    PF SF_early SF_intermediate SF_advanced
PF              [1458]   &lt;.0001          0.0005      &lt;.0001
SF_early        -42.49   [1500]          0.1301      0.8936
SF_intermediate -27.34    15.15          [1485]      0.6057
SF_advanced     -36.96     5.53           -9.62      [1495]

ff_area = 70-80
                     PF SF_early SF_intermediate SF_advanced
PF               [1462]   &lt;.0001          &lt;.0001      0.0002
SF_early        -32.888   [1495]          0.2125      0.9998
SF_intermediate -46.373  -13.485          [1509]      0.2658
SF_advanced     -32.197    0.691          14.176      [1495]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [1466]   &lt;.0001          0.0002      0.0004
SF_early        -38.72   [1504]          0.5047      0.7991
SF_intermediate -28.78     9.94          [1495]      0.9861
SF_advanced     -31.46     7.26           -2.68      [1497]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [1484]   &lt;.0001          0.7252      0.1635
SF_early        -36.56   [1520]          0.0008      &lt;.0001
SF_intermediate  -7.24    29.32          [1491]      0.0148
SF_advanced      16.16    52.72           23.40      [1468]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                      PF SF_early SF_intermediate SF_advanced
PF                [1452]   0.0526          0.0510      0.4811
SF_early        -14.2889   [1466]          1.0000      0.8311
SF_intermediate -14.3557  -0.0668          [1466]      0.8258
SF_advanced      -8.9664   5.3224          5.3892      [1461]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [1485]   0.0088          0.0855      0.5988
SF_early        -17.68   [1503]          0.8543      0.3937
SF_intermediate -13.21     4.47          [1499]      0.8247
SF_advanced      -7.80     9.88            5.40      [1493]

ff_area = 20-30
                    PF SF_early SF_intermediate SF_advanced
PF              [1507]   0.0012          0.0126      0.1255
SF_early         -20.9   [1528]          0.9045      0.6694
SF_intermediate  -17.1      3.8          [1524]      0.9528
SF_advanced      -13.8      7.1             3.3      [1521]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [1521]   &lt;.0001          0.0002      0.0040
SF_early        -29.58   [1550]          0.6961      0.5492
SF_intermediate -23.49     6.09          [1544]      0.9852
SF_advanced     -21.29     8.29            2.20      [1542]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [1523]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -42.05   [1565]          0.9370      0.5715
SF_intermediate -38.79     3.26          [1562]      0.8694
SF_advanced     -33.98     8.07            4.81      [1557]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [1518]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -64.02   [1582]          0.7986      0.5293
SF_intermediate -58.92     5.10          [1577]      0.9491
SF_advanced     -55.53     8.49            3.39      [1574]

ff_area = 60-70
                    PF SF_early SF_intermediate SF_advanced
PF              [1523]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -79.95   [1603]          0.1968      0.1566
SF_intermediate -68.88    11.07          [1592]      0.9879
SF_advanced     -66.83    13.12            2.05      [1590]

ff_area = 70-80
                    PF SF_early SF_intermediate SF_advanced
PF              [1525]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -97.52   [1623]          0.0081      0.0002
SF_intermediate -79.69    17.83          [1605]      0.5271
SF_advanced     -71.18    26.33            8.51      [1597]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [1527]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early         -99.3   [1626]          0.9454      0.0004
SF_intermediate  -96.3      3.1          [1623]      0.0026
SF_advanced      -74.2     25.2            22.1      [1601]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [1529]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -120.6   [1650]          0.0003      &lt;.0001
SF_intermediate  -97.8     22.8          [1627]      0.0157
SF_advanced      -79.1     41.5            18.7      [1609]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                    PF SF_early SF_intermediate SF_advanced
PF              [1334]   0.2800          0.2579      0.3369
SF_early        13.961   [1320]          1.0000      0.9998
SF_intermediate 14.326    0.365          [1320]      1.0000
SF_advanced     14.684    0.724           0.359      [1320]

ff_area = 10-20
                    PF SF_early SF_intermediate SF_advanced
PF              [1360]   0.5964          0.9682      0.8621
SF_early         -9.75   [1370]          0.8587      0.2307
SF_intermediate  -3.57     6.17          [1364]      0.6327
SF_advanced       6.86    16.61           10.43      [1354]

ff_area = 20-30
                    PF SF_early SF_intermediate SF_advanced
PF              [1379]   0.6494          0.3004      0.8226
SF_early         -9.09   [1388]          0.9375      0.9982
SF_intermediate -13.64    -4.55          [1393]      0.9004
SF_advanced      -7.58     1.51            6.06      [1387]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [1394]   0.9932          0.3488      0.7459
SF_early         -2.10   [1396]          0.5089      0.8697
SF_intermediate -12.92   -10.82          [1407]      0.9659
SF_advanced      -8.81    -6.71            4.11      [1402]

ff_area = 40-50
                    PF SF_early SF_intermediate SF_advanced
PF              [1396]   0.2105          0.0242      0.1267
SF_early        -15.18   [1411]          0.8088      0.9681
SF_intermediate -22.15    -6.97          [1418]      0.9867
SF_advanced     -19.19    -4.01            2.96      [1415]

ff_area = 50-60
                    PF SF_early SF_intermediate SF_advanced
PF              [1395]   0.0632          &lt;.0001      0.0002
SF_early        -19.40   [1414]          0.0174      0.2262
SF_intermediate -42.41   -23.01          [1437]      0.8888
SF_advanced     -36.10   -16.70            6.31      [1431]

ff_area = 60-70
                    PF SF_early SF_intermediate SF_advanced
PF              [1409]   0.0946          &lt;.0001      0.0211
SF_early        -18.11   [1428]          0.0818      0.8474
SF_intermediate -36.70   -18.59          [1446]      0.5587
SF_advanced     -25.25    -7.14           11.45      [1435]

ff_area = 70-80
                    PF SF_early SF_intermediate SF_advanced
PF              [1420]   0.1742          0.0051      0.0537
SF_early        -15.93   [1436]          0.5710      0.8857
SF_intermediate -25.99   -10.06          [1446]      0.9751
SF_advanced     -22.31    -6.38            3.67      [1442]

ff_area = 80-90
                    PF SF_early SF_intermediate SF_advanced
PF              [1430]   0.3301          0.0056      0.9519
SF_early        -13.19   [1443]          0.3724      0.7631
SF_intermediate -25.78   -12.59          [1455]      0.0755
SF_advanced      -4.64     8.55           21.14      [1434]

ff_area = 90-100
                     PF SF_early SF_intermediate SF_advanced
PF               [1445]   1.0000          0.0004      0.7938
SF_early          0.225   [1445]          0.0003      0.7798
SF_intermediate -31.358  -31.583          [1476]      0.0399
SF_advanced      -8.065   -8.289          23.294      [1453]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar matriz como data.frame</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>pw_cba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>pw_eba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>pw_sba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>pw_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pw_cba_df, pw_eba_df, pw_sba_df)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(pw_df, <span class="at">file =</span> <span class="st">"data_group/matriz_contrastes_pwpm_evapo.xlsx"</span>, <span class="at">rowNames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - análises</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>tabela_estilo_fig1 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region   =</span> region,</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover    =</span> Tipo,</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effect   =</span> emmean,</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> ff_area,</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> upper.CL</span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"EVAPO"</span>,</span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Cover, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(Interval, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,</span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Region, Cover, Interval) <span class="sc">%&gt;%</span></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)</span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>  tabela_estilo_fig1,</span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_evapo.xlsx"</span>,</span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - SI</span></span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar tabela base</span></span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,</span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(region, Interval, Cover,</span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">Effect =</span> emmean,</span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_upper =</span> upper.CL)</span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorganizar para formato largo (larger table like Figure 2)</span></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a>tabela_fig2 <span class="ot">&lt;-</span> t2 <span class="sc">%&gt;%</span></span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover) <span class="sc">%&gt;%</span></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> region,</span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(Effect, CI_lower, CI_upper),</span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{region}_{.value}"</span></span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover)</span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a>  tabela_fig2,</span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_evapo_table_final.xlsx"</span>,</span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="constrastes-e-significancia-1" class="level4">
<h4 class="anchored" data-anchor-id="constrastes-e-significancia-1">Constrastes e significancia</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>get_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>contrast_CBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_CBA_evapo_w1, <span class="st">"CBA"</span>)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>contrast_EBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_EBA_evapo_w1, <span class="st">"EBA"</span>)</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>contrast_SBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_SBA_evapo_w1, <span class="st">"SBA"</span>)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) <span class="sc">%&gt;%</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"PF"</span>, contrast) <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"SF_"</span>, contrast)) <span class="sc">%&gt;%</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(contrast, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"tipo1"</span>, <span class="st">"tipo2"</span>), <span class="at">sep =</span> <span class="st">" - "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)) <span class="sc">|</span></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>         (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF − SF</span></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(all_contrasts, <span class="st">"data_group/contrast_PF_SF_evapo.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="painel-evapo" class="level3">
<h3 class="anchored" data-anchor-id="painel-evapo">Painel Evapo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot de pontos</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>plot_point_evapo <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(em_all, region <span class="sc">==</span> region_name) <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_relevel</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_recode</span>(</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"PF"</span> <span class="ot">=</span> <span class="st">"PF"</span>,</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> emmean, <span class="at">color =</span> Tipo, <span class="at">group =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL, <span class="at">ymax =</span> upper.CL),</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_axes) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="sc">-</span><span class="dv">20</span>)) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#02401B"</span>, <span class="st">"lightgreen"</span>, <span class="st">"green1"</span>, <span class="st">"green4"</span>)) <span class="sc">+</span></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1200</span>, <span class="dv">1700</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1200</span>, <span class="dv">1700</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#labs(y = if (show_y) "Evapotranspiration\nfixed effects (mm·yr⁻¹)" else NULL) +</span></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cf">if</span> (show_y) <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Estimated marginal mean"</span>, <span class="st">"evapotranspiration (mm·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>))) <span class="cf">else</span> <span class="cn">NULL</span>)</span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Atualizar ordem dos fatores e renomear os labels</span></span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb144-44"><a href="#cb144-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb144-45"><a href="#cb144-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)),</span>
<span id="cb144-46"><a href="#cb144-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf_label =</span> <span class="fu">fct_recode</span>(tipo_sf,</span>
<span id="cb144-47"><a href="#cb144-47" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb144-48"><a href="#cb144-48" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb144-49"><a href="#cb144-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb144-50"><a href="#cb144-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-51"><a href="#cb144-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-52"><a href="#cb144-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-53"><a href="#cb144-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar coluna categórica para estimate</span></span>
<span id="cb144-54"><a href="#cb144-54" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb144-55"><a href="#cb144-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb144-56"><a href="#cb144-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_cat =</span> <span class="fu">factor</span>(</span>
<span id="cb144-57"><a href="#cb144-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(estimate,</span>
<span id="cb144-58"><a href="#cb144-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="dv">30</span>, <span class="dv">0</span>, <span class="cn">Inf</span>),</span>
<span id="cb144-59"><a href="#cb144-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;−30"</span>, <span class="st">"−30 to 0"</span>, <span class="st">"&gt;0"</span>)</span>
<span id="cb144-60"><a href="#cb144-60" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb144-61"><a href="#cb144-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;−30"</span>, <span class="st">"−30 to 0"</span>, <span class="st">"&gt;0"</span>)</span>
<span id="cb144-62"><a href="#cb144-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-63"><a href="#cb144-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-64"><a href="#cb144-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-65"><a href="#cb144-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap de contrastes</span></span>
<span id="cb144-66"><a href="#cb144-66" aria-hidden="true" tabindex="-1"></a>plot_heat_evapo <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb144-67"><a href="#cb144-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">filter</span>(all_contrasts, region <span class="sc">==</span> region_name), </span>
<span id="cb144-68"><a href="#cb144-68" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> tipo_sf_label, <span class="at">fill =</span> estimate_cat)) <span class="sc">+</span></span>
<span id="cb144-69"><a href="#cb144-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">height =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb144-70"><a href="#cb144-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb144-71"><a href="#cb144-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb144-72"><a href="#cb144-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"&lt;−30"</span> <span class="ot">=</span> <span class="st">"#D6604D"</span>, <span class="st">"−30 to 0"</span> <span class="ot">=</span> <span class="st">"#F4A582"</span>, <span class="st">"&gt;0"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>),</span>
<span id="cb144-73"><a href="#cb144-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"&lt;−30"</span>, <span class="st">"−30 to 0"</span>, <span class="st">"&gt;0"</span>),</span>
<span id="cb144-74"><a href="#cb144-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">drop =</span> <span class="cn">FALSE</span>,</span>
<span id="cb144-75"><a href="#cb144-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"ET (PF − SF)"</span>, <span class="st">"(mm)"</span>)))</span>
<span id="cb144-76"><a href="#cb144-76" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb144-77"><a href="#cb144-77" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb144-78"><a href="#cb144-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb144-79"><a href="#cb144-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-80"><a href="#cb144-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-81"><a href="#cb144-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-82"><a href="#cb144-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_labels) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb144-83"><a href="#cb144-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb144-84"><a href="#cb144-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-85"><a href="#cb144-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb144-86"><a href="#cb144-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-87"><a href="#cb144-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb144-88"><a href="#cb144-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb144-89"><a href="#cb144-89" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb144-90"><a href="#cb144-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb144-91"><a href="#cb144-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-92"><a href="#cb144-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-93"><a href="#cb144-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar gráficos para cada região</span></span>
<span id="cb144-94"><a href="#cb144-94" aria-hidden="true" tabindex="-1"></a>panel_CBA_evapo <span class="ot">&lt;-</span> <span class="fu">plot_heat_evapo</span>(<span class="st">"CBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb144-95"><a href="#cb144-95" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_evapo</span>(<span class="st">"CBA"</span>, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb144-96"><a href="#cb144-96" aria-hidden="true" tabindex="-1"></a>panel_CBA_evapo <span class="ot">&lt;-</span> panel_CBA_evapo <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb144-97"><a href="#cb144-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-98"><a href="#cb144-98" aria-hidden="true" tabindex="-1"></a>panel_EBA_evapo <span class="ot">&lt;-</span> <span class="fu">plot_heat_evapo</span>(<span class="st">"EBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb144-99"><a href="#cb144-99" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_evapo</span>(<span class="st">"EBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb144-100"><a href="#cb144-100" aria-hidden="true" tabindex="-1"></a>panel_EBA_evapo <span class="ot">&lt;-</span> panel_EBA_evapo <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb144-101"><a href="#cb144-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-102"><a href="#cb144-102" aria-hidden="true" tabindex="-1"></a>panel_SBA_evapo <span class="ot">&lt;-</span> <span class="fu">plot_heat_evapo</span>(<span class="st">"SBA"</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb144-103"><a href="#cb144-103" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_evapo</span>(<span class="st">"SBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb144-104"><a href="#cb144-104" aria-hidden="true" tabindex="-1"></a>panel_SBA_evapo <span class="ot">&lt;-</span> panel_SBA_evapo <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb144-105"><a href="#cb144-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-106"><a href="#cb144-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os painéis horizontalmente</span></span>
<span id="cb144-107"><a href="#cb144-107" aria-hidden="true" tabindex="-1"></a>final_panel_evapo <span class="ot">&lt;-</span> (panel_CBA_evapo <span class="sc">|</span> panel_EBA_evapo <span class="sc">|</span> panel_SBA_evapo)</span>
<span id="cb144-108"><a href="#cb144-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-109"><a href="#cb144-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir painel final</span></span>
<span id="cb144-110"><a href="#cb144-110" aria-hidden="true" tabindex="-1"></a>final_panel_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/em_fixed_fixed_evapo.png"</span>,</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> final_panel_evapo,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 4764938 254.5    7437494 397.3  7437494 397.3
Vcells 9081125  69.3   17824054 136.0 14786712 112.9</code></pre>
</div>
</div>
<section id="todos-os-constraste-entre-frações-de-área-1" class="level4">
<h4 class="anchored" data-anchor-id="todos-os-constraste-entre-frações-de-área-1">Todos os constraste entre frações de área</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de modelos</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>modelos <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">CBA =</span> model_CBA_evapo_w1, <span class="at">EBA =</span> model_EBA_evapo_w1, <span class="at">SBA =</span> model_SBA_evapo_w1)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar todos os contrastes PF - SF</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>get_all_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area <span class="sc">*</span> Tipo)</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para todas as regiões</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(modelos, <span class="fu">names</span>(modelos), get_all_contrasts)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(all_contrasts_sup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:
 $ contrast: chr  "(10-20 PF) - (1-10 PF)" "(20-30 PF) - (1-10 PF)" "(20-30 PF) - (10-20 PF)" "(30-40 PF) - (1-10 PF)" ...
 $ estimate: num  51.3 81.2 29.9 101 49.7 ...
 $ SE      : num  6.95 6.95 6.95 6.95 6.95 ...
 $ df      : num  702 702 702 702 702 ...
 $ t.ratio : num  7.37 11.68 4.31 14.52 7.15 ...
 $ p.value : num  2.12e-12 7.77e-28 4.17e-05 8.72e-41 8.80e-12 ...
 $ region  : chr  "CBA" "CBA" "CBA" "CBA" ...
 - attr(*, "estName")= chr "estimate"
 - attr(*, "pri.vars")= chr "contrast"
 - attr(*, "adjust")= chr "fdr"
 - attr(*, "side")= num 0
 - attr(*, "delta")= num 0
 - attr(*, "type")= chr "link"
 - attr(*, "mesg")= chr [1:2] "Degrees-of-freedom method: kenward-roger" "P value adjustment: fdr method for 780 tests"
 - attr(*, "digits")= int 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair contrastes entre PF e SF</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(contrast, <span class="st">"PF"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(contrast, <span class="st">"SF_"</span>))</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair informações usando regex</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Regex para capturar (faixa tipo) - (faixa tipo)</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>extr <span class="ot">&lt;-</span> <span class="fu">str_match</span>(all_contrasts_sup<span class="sc">$</span>contrast,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"</span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">) - </span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar colunas extraídas</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa1 =</span> extr[, <span class="dv">2</span>],</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo1 =</span> extr[, <span class="dv">3</span>],</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa2 =</span> extr[, <span class="dv">4</span>],</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo2 =</span> extr[, <span class="dv">5</span>]</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> sf_levels) <span class="sc">|</span> (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> sf_levels)) <span class="sc">%&gt;%</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa1, faixa2),</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa2, faixa1),</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF - SF</span></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar fatores</span></span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>faixas_niveis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>,</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">factor</span>(faixa_PF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">factor</span>(faixa_SF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">factor</span>(tipo_SF,  <span class="at">levels =</span> sf_levels)</span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação mantendo sinal</span></span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-46"><a href="#cb149-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF =</span> <span class="fu">fct_recode</span>(tipo_SF,</span>
<span id="cb149-47"><a href="#cb149-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb149-48"><a href="#cb149-48" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb149-49"><a href="#cb149-49" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb149-50"><a href="#cb149-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb149-51"><a href="#cb149-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-52"><a href="#cb149-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">case_when</span>(</span>
<span id="cb149-53"><a href="#cb149-53" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">100</span> <span class="sc">~</span> <span class="st">"&lt;-100"</span>,</span>
<span id="cb149-54"><a href="#cb149-54" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">100</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"-100–0"</span>,</span>
<span id="cb149-55"><a href="#cb149-55" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"0–100"</span>,</span>
<span id="cb149-56"><a href="#cb149-56" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"&gt;100"</span></span>
<span id="cb149-57"><a href="#cb149-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb149-58"><a href="#cb149-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">factor</span>(estimate_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;-100"</span>, <span class="st">"-100–0"</span>, <span class="st">"0–100"</span>, <span class="st">"&gt;100"</span>))</span>
<span id="cb149-59"><a href="#cb149-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-60"><a href="#cb149-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-61"><a href="#cb149-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-62"><a href="#cb149-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb149-63"><a href="#cb149-63" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_contrasts_sup, </span>
<span id="cb149-64"><a href="#cb149-64" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> faixa_SF, <span class="at">y =</span> faixa_PF, <span class="at">fill =</span> estimate_class)) <span class="sc">+</span></span>
<span id="cb149-65"><a href="#cb149-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb149-66"><a href="#cb149-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb149-67"><a href="#cb149-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb149-68"><a href="#cb149-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&lt;-100"</span> <span class="ot">=</span> <span class="st">"#D6604D"</span>,</span>
<span id="cb149-69"><a href="#cb149-69" aria-hidden="true" tabindex="-1"></a>  <span class="st">"-100–0"</span> <span class="ot">=</span> <span class="st">"#F4A582"</span>,</span>
<span id="cb149-70"><a href="#cb149-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">"0–100"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>,</span>
<span id="cb149-71"><a href="#cb149-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;100"</span> <span class="ot">=</span> <span class="st">"#4393C3"</span></span>
<span id="cb149-72"><a href="#cb149-72" aria-hidden="true" tabindex="-1"></a>), <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"ET (PF - SF)"</span>, <span class="st">"(mm·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>))))<span class="sc">+</span></span>
<span id="cb149-73"><a href="#cb149-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(tipo_SF <span class="sc">~</span> region) <span class="sc">+</span></span>
<span id="cb149-74"><a href="#cb149-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb149-75"><a href="#cb149-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb149-76"><a href="#cb149-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb149-77"><a href="#cb149-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb149-78"><a href="#cb149-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb149-79"><a href="#cb149-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb149-80"><a href="#cb149-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-81"><a href="#cb149-81" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"SF fractional cover (%)"</span>,</span>
<span id="cb149-82"><a href="#cb149-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"PF fractional cover (%)"</span>)</span>
<span id="cb149-83"><a href="#cb149-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-84"><a href="#cb149-84" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_evapo.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_evapo.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 4746529 253.5    7437494 397.3  7437494 397.3
Vcells 9052545  69.1   17824054 136.0 17823645 136.0</code></pre>
</div>
</div>
</section>
</section>
<section id="random-effect-1" class="level3">
<h3 class="anchored" data-anchor-id="random-effect-1">Random effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para extrair efeitos aleatórios com IC por região</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>extract_random_effects <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Efeitos aleatórios com variância condicional</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  ran <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model, <span class="at">condVar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extrair efeitos por ano</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(ran_df) <span class="ot">&lt;-</span> <span class="st">"effect"</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>  ran_df<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">rownames</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intervalos de confiança (erro padrão)</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">attr</span>(ran<span class="sc">$</span>Ano, <span class="st">"postVar"</span>)[<span class="dv">1</span>, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> ran_df <span class="sc">%&gt;%</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> se,</span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> effect <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper =</span> effect <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">region =</span> region_name</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ran_df)</span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para os três modelos (substitua pelos seus objetos reais)</span></span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>random_cba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_CBA_evapo_w1, <span class="st">"CBA"</span>)</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>random_eba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_EBA_evapo_w1, <span class="st">"EBA"</span>)</span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>random_sba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_SBA_evapo_w1, <span class="st">"SBA"</span>)</span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar tudo</span></span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a>random_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(random_cba, random_eba, random_sba)</span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir que o ano seja ordenável</span></span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a>random_all<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(random_all<span class="sc">$</span>ano))</span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-36"><a href="#cb152-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb152-37"><a href="#cb152-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(random_all, <span class="st">"data_group/random_effects_evapo.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-2" class="level5">
<h5 class="anchored" data-anchor-id="plot-2">Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>p1_rand_evapo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(random_all, <span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> effect)) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="st">"green1"</span>) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2001</span>, <span class="dv">2021</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">#axis.text.x = element_text(angle = 45, hjust = 1),</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>      <span class="co">#strip.text = element_text(face = "bold", size = 13)) +</span></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Evapotranspiration"</span>, <span class="st">"random effects (mm·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>)))</span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a>p1_rand_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/histogram_random_evapo.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="predicted-1" class="level3">
<h3 class="anchored" data-anchor-id="predicted-1">Predicted</h3>
<section id="plot-3" class="level5">
<h5 class="anchored" data-anchor-id="plot-3">Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>model_cba_evapo<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_evapo_w1, model_cba_evapo)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>model_eba_evapo<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_evapo_w1, model_eba_evapo)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>model_sba_evapo<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_evapo_w1, model_sba_evapo)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>r2_cba_evapo_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_CBA_evapo_w1, model_cba_evapo, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>r2_eba_evapo_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_EBA_evapo_w1, model_eba_evapo, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>r2_sba_evapo_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_SBA_evapo_w1, model_sba_evapo, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>all_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(model_cba_evapo<span class="sc">$</span>Evapo, model_cba_evapo<span class="sc">$</span>predicted,</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>              model_eba_evapo<span class="sc">$</span>Evapo, model_eba_evapo<span class="sc">$</span>predicted,</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>              model_sba_evapo<span class="sc">$</span>Evapo, model_sba_evapo<span class="sc">$</span>predicted)</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>rng     <span class="ot">&lt;-</span> <span class="fu">range</span>(all_vals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>pad     <span class="ot">&lt;-</span> <span class="fl">0.02</span> <span class="sc">*</span> <span class="fu">diff</span>(rng)</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>((rng[<span class="dv">1</span>] <span class="sc">-</span> pad)  <span class="sc">/</span> <span class="dv">200</span>) <span class="sc">*</span> <span class="dv">200</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((rng[<span class="dv">2</span>] <span class="sc">-</span> pad)  <span class="sc">/</span> <span class="dv">200</span>) <span class="sc">*</span> <span class="dv">200</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>brks    <span class="ot">&lt;-</span> <span class="fu">seq</span>(lim_min, lim_max, <span class="at">by =</span> <span class="dv">200</span>)</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Função base do gráfico (escala 1:1 e linha 45°)</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, titulo, subtitulo){</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Evapo, predicted)) <span class="sc">+</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span>  </span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Observed ET (mm·yr⁻¹)"</span>,</span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Predicted ET (mm·yr⁻¹)"</span>,  <span class="co"># mostra o eixo y em TODOS</span></span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> titulo,</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitulo</span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="painel-1" class="level5">
<h5 class="anchored" data-anchor-id="painel-1">Painel</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>cba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_cba_evapo, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_cba_evapo_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_cba_evapo))</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>eba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_eba_evapo, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_eba_evapo_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_eba_evapo)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>sba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_sba_evapo, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_sba_evapo_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_sba_evapo)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>p2_pred_evapo <span class="ot">&lt;-</span> (cba_pf <span class="sc">+</span> eba_pf <span class="sc">+</span> sba_pf) <span class="sc">+</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>p2_pred_evapo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_observed_evapo.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-plotting-1" class="level3">
<h3 class="anchored" data-anchor-id="model-plotting-1">Model plotting</h3>
<section id="cba-1" class="level4">
<h4 class="anchored" data-anchor-id="cba-1">CBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo <span class="ot">&lt;-</span> model_cba_evapo <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_CBA_evapo_w1)  </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo <span class="ot">&lt;-</span> model_cba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo[model_cba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_evapo <span class="ot">&lt;-</span> model_cba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>m1_evapo_cba <span class="ot">&lt;-</span> model_cba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Evapo, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1200</span>, <span class="dv">1600</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted evapotranspiration (mm·yr⁻¹) - CBA"</span>,</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>m1_evapo_cba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_evapo_CBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eba-1" class="level4">
<h4 class="anchored" data-anchor-id="eba-1">EBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo <span class="ot">&lt;-</span> model_eba_evapo <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_EBA_evapo_w1)  </span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo <span class="ot">&lt;-</span> model_eba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo[model_eba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_evapo <span class="ot">&lt;-</span> model_eba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>m1_evapo_eba <span class="ot">&lt;-</span> model_eba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Evapo, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1300</span>, <span class="dv">1700</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted evapotranspiration (mm·yr⁻¹) - EBA"</span>,</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>m1_evapo_eba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_evapo_EBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sba-1" class="level4">
<h4 class="anchored" data-anchor-id="sba-1">SBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo <span class="ot">&lt;-</span> model_sba_evapo <span class="sc">%&gt;%</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_SBA_evapo_w1)  </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo <span class="ot">&lt;-</span> model_sba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo[model_sba_all_evapo<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_evapo <span class="ot">&lt;-</span> model_sba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>m1_evapo_sba <span class="ot">&lt;-</span> model_sba_all_evapo <span class="sc">%&gt;%</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Evapo))<span class="sc">+</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Evapo, <span class="at">color =</span> vegetation)) <span class="sc">+</span> </span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation, <span class="at">color =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1000</span>, <span class="dv">1600</span>, <span class="at">by =</span> <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted evapotranspiration (mm·yr⁻¹) - SBA"</span>,</span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Tamanho do texto da legenda</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>m1_evapo_sba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_evapo_SBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="temperature" class="level2">
<h2 class="anchored" data-anchor-id="temperature">TEMPERATURE</h2>
<section id="model-choice-2" class="level3">
<h3 class="anchored" data-anchor-id="model-choice-2">Model choice</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leitura dos dados agrupados por Ano x Tipo x Region x Fração de Área</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>all_pf_sf_temp_model <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data_group/plan_data_group_temp.xlsx"</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a ordem correta das categorias</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>ord_ff   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>lev_tipo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodifica como fatores na ordem correta</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>recode_fac <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> ord_ff, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> lev_tipo)</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Separa por região e aplica a recodificação</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>model_cba_temp <span class="ot">&lt;-</span> all_pf_sf_temp_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"CBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>model_eba_temp <span class="ot">&lt;-</span> all_pf_sf_temp_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"EBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>model_sba_temp <span class="ot">&lt;-</span> all_pf_sf_temp_model <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"SBA"</span>) <span class="sc">%&gt;%</span> <span class="fu">recode_fac</span>()</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria um identificador para cada estrato</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>add_estrato <span class="ot">&lt;-</span> <span class="cf">function</span>(d){</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>estrato_id <span class="ot">&lt;-</span> <span class="fu">interaction</span>(d<span class="sc">$</span>region, d<span class="sc">$</span>ff_area, d<span class="sc">$</span>Tipo, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>  d</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>model_cba_temp <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_cba_temp)</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>model_eba_temp <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_eba_temp)</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>model_sba_temp <span class="ot">&lt;-</span> <span class="fu">add_estrato</span>(model_sba_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fixed-effect-2" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effect-2">Fixed effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CBA</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>model_CBA_temp_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Temp <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_cba_temp)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co"># EBA</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>model_EBA_temp_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Temp <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_eba_temp)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SBA</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>model_SBA_temp_w1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Temp <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Ano),</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> model_sba_temp)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Conferir coeficientes fixos rapidamente</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_CBA_temp_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df   p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 fixed  (Intercept) 25.5        0.0722   354.     20.5 2.66e- 40
 2 fixed  ff_area.L   -0.873      0.0300   -29.1   702.  1.46e-122
 3 fixed  ff_area.Q   -0.0319     0.0300    -1.06  702.  2.88e-  1
 4 fixed  ff_area.C   -0.262      0.0300    -8.74  702.  1.76e- 17
 5 fixed  ff_area^4   -0.0743     0.0300    -2.47  702.  1.36e-  2
 6 fixed  ff_area^5   -0.0685     0.0300    -2.28  702.  2.29e-  2
 7 fixed  ff_area^6   -0.0457     0.0300    -1.52  702.  1.29e-  1
 8 fixed  ff_area^7   -0.0278     0.0300    -0.925 702.  3.55e-  1
 9 fixed  ff_area^8   -0.00608    0.0300    -0.203 702.  8.40e-  1
10 fixed  ff_area^9    0.00859    0.0300     0.286 702.  7.75e-  1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_EBA_temp_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df   p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 fixed  (Intercept) 25.2        0.0706   357.     20.1 8.94e- 40
 2 fixed  ff_area.L   -0.734      0.0162   -45.3   710.  1.58e-211
 3 fixed  ff_area.Q   -0.336      0.0162   -20.7   710.  4.40e- 75
 4 fixed  ff_area.C   -0.323      0.0162   -19.9   710.  1.47e- 70
 5 fixed  ff_area^4   -0.0201     0.0162    -1.24  710.  2.16e-  1
 6 fixed  ff_area^5   -0.0519     0.0162    -3.20  710.  1.45e-  3
 7 fixed  ff_area^6   -0.0742     0.0162    -4.58  710.  5.60e-  6
 8 fixed  ff_area^7   -0.0338     0.0162    -2.08  710.  3.75e-  2
 9 fixed  ff_area^8    0.0179     0.0162     1.10  710.  2.71e-  1
10 fixed  ff_area^9    0.00798    0.0162     0.492 710.  6.23e-  1
# ℹ 30 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(model_SBA_temp_w1, <span class="at">effects=</span><span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   effect term        estimate std.error statistic    df  p.value
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 fixed  (Intercept) 25.1        0.0807   311.     20.2 1.28e-38
 2 fixed  ff_area.L   -0.427      0.0204   -20.9   710.  8.22e-76
 3 fixed  ff_area.Q   -0.300      0.0204   -14.7   710.  1.17e-42
 4 fixed  ff_area.C   -0.289      0.0204   -14.1   710.  4.28e-40
 5 fixed  ff_area^4    0.00969    0.0204     0.474 710.  6.36e- 1
 6 fixed  ff_area^5    0.0254     0.0204     1.24  710.  2.15e- 1
 7 fixed  ff_area^6   -0.0931     0.0204    -4.55  710.  6.17e- 6
 8 fixed  ff_area^7   -0.0538     0.0204    -2.63  710.  8.67e- 3
 9 fixed  ff_area^8    0.0369     0.0204     1.81  710.  7.13e- 2
10 fixed  ff_area^9    0.0209     0.0204     1.02  710.  3.07e- 1
# ℹ 30 more rows</code></pre>
</div>
</div>
<section id="r-square-for-linear-mixed-model-lmm-2" class="level4">
<h4 class="anchored" data-anchor-id="r-square-for-linear-mixed-model-lmm-2">R-square for Linear Mixed Model (LMM)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Helpers coerentes com os pesos do ajuste ----</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>weighted_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(y, w) <span class="fu">sum</span>(w<span class="sc">*</span>y)<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>r2_w_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat, w) {</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  sst <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> <span class="fu">weighted_mean</span>(y, w))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  ssr <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> ssr<span class="sc">/</span>sst</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co"># R² ponderado "marginal" (fixos) e "condicional" (fixos + RE)  </span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>r2_lmer_w <span class="ot">&lt;-</span> <span class="cf">function</span>(m, dat, <span class="at">resp =</span> <span class="st">"Temp"</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"marg"</span>,<span class="st">"cond"</span>)) {</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(type)</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">weights</span>(m))            </span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dat[[resp]]</span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"marg"</span>) <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="sc">~</span><span class="dv">0</span>) <span class="cf">else</span> <span class="fu">predict</span>(m, <span class="at">re.form =</span> <span class="cn">NULL</span>)</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2_w_sse</span>(y, yhat, w)</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular R² ponderado (fixo e cond.) para os modelos principais (w1 = sqrt(n_obs))</span></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>r2_cba_temp <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_temp_w1, model_cba_temp, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_CBA_temp_w1, model_cba_temp, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>r2_eba_temp <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_temp_w1, model_eba_temp, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_EBA_temp_w1, model_eba_temp, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>r2_sba_temp <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_temp_w1, model_sba_temp, <span class="at">type=</span><span class="st">"marg"</span>),</span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">r2_lmer_w</span>(model_SBA_temp_w1, model_sba_temp, <span class="at">type=</span><span class="st">"cond"</span>)</span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>r2_cba_temp; r2_eba_temp; r2_sba_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.2971607 0.8997172 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.4254513 0.9714580 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R2_marg_w R2_cond_w 
0.4489102 0.9670093 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar (opcional)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>r2_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">c</span>(<span class="st">"CBA"</span>,<span class="st">"EBA"</span>,<span class="st">"SBA"</span>),</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_marg_w =</span> <span class="fu">c</span>(r2_cba_temp[<span class="st">"R2_marg_w"</span>], r2_eba_temp[<span class="st">"R2_marg_w"</span>], r2_sba_temp[<span class="st">"R2_marg_w"</span>]),</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_cond_w =</span> <span class="fu">c</span>(r2_cba_temp[<span class="st">"R2_cond_w"</span>], r2_eba_temp[<span class="st">"R2_cond_w"</span>], r2_sba_temp[<span class="st">"R2_cond_w"</span>])</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(r2_tbl, <span class="st">"data_group/r2_weighted_temp.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste múltiplo BH para comparações por faixa.</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>emm_CBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_temp_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_CBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.160894 0.0425 702   3.787  0.0005
 PF - SF_intermediate           0.198618 0.0425 702   4.675  &lt;.0001
 PF - SF_advanced               0.166996 0.0477 702   3.504  0.0010
 SF_early - SF_intermediate     0.037724 0.0425 702   0.888  0.5623
 SF_early - SF_advanced         0.006102 0.0477 702   0.128  0.8981
 SF_intermediate - SF_advanced -0.031622 0.0477 702  -0.664  0.6086

ff_area = 10-20:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.000911 0.0425 702   0.021  0.9829
 PF - SF_intermediate          -0.043123 0.0425 702  -1.015  0.3725
 PF - SF_advanced              -0.114637 0.0477 702  -2.405  0.0492
 SF_early - SF_intermediate    -0.044034 0.0425 702  -1.037  0.3725
 SF_early - SF_advanced        -0.115547 0.0477 702  -2.425  0.0492
 SF_intermediate - SF_advanced -0.071513 0.0477 702  -1.501  0.2678

ff_area = 20-30:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.101295 0.0425 702  -2.384  0.0261
 PF - SF_intermediate          -0.152233 0.0425 702  -3.583  0.0011
 PF - SF_advanced              -0.232581 0.0477 702  -4.880  &lt;.0001
 SF_early - SF_intermediate    -0.050938 0.0425 702  -1.199  0.2309
 SF_early - SF_advanced        -0.131285 0.0477 702  -2.755  0.0120
 SF_intermediate - SF_advanced -0.080347 0.0477 702  -1.686  0.1107

ff_area = 30-40:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.087807 0.0425 702  -2.067  0.0391
 PF - SF_intermediate          -0.186264 0.0425 702  -4.384  &lt;.0001
 PF - SF_advanced              -0.294016 0.0477 702  -6.170  &lt;.0001
 SF_early - SF_intermediate    -0.098458 0.0425 702  -2.318  0.0289
 SF_early - SF_advanced        -0.206209 0.0477 702  -4.327  &lt;.0001
 SF_intermediate - SF_advanced -0.107752 0.0477 702  -2.261  0.0289

ff_area = 40-50:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.109815 0.0425 702  -2.585  0.0149
 PF - SF_intermediate          -0.208063 0.0425 702  -4.898  &lt;.0001
 PF - SF_advanced              -0.319357 0.0477 702  -6.701  &lt;.0001
 SF_early - SF_intermediate    -0.098248 0.0425 702  -2.313  0.0210
 SF_early - SF_advanced        -0.209542 0.0477 702  -4.397  &lt;.0001
 SF_intermediate - SF_advanced -0.111294 0.0477 702  -2.335  0.0210

ff_area = 50-60:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.157313 0.0425 702  -3.703  0.0005
 PF - SF_intermediate          -0.161623 0.0425 702  -3.804  0.0005
 PF - SF_advanced              -0.258221 0.0477 702  -5.418  &lt;.0001
 SF_early - SF_intermediate    -0.004309 0.0425 702  -0.101  0.9192
 SF_early - SF_advanced        -0.100908 0.0477 702  -2.117  0.0516
 SF_intermediate - SF_advanced -0.096599 0.0477 702  -2.027  0.0516

ff_area = 60-70:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.194835 0.0425 702  -4.586  &lt;.0001
 PF - SF_intermediate          -0.154515 0.0425 702  -3.637  0.0006
 PF - SF_advanced              -0.258505 0.0477 702  -5.424  &lt;.0001
 SF_early - SF_intermediate     0.040320 0.0425 702   0.949  0.3429
 SF_early - SF_advanced        -0.063670 0.0477 702  -1.336  0.2184
 SF_intermediate - SF_advanced -0.103990 0.0477 702  -2.182  0.0442

ff_area = 70-80:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.262889 0.0425 702  -6.188  &lt;.0001
 PF - SF_intermediate          -0.269995 0.0425 702  -6.355  &lt;.0001
 PF - SF_advanced              -0.280583 0.0477 702  -5.888  &lt;.0001
 SF_early - SF_intermediate    -0.007107 0.0425 702  -0.167  0.8672
 SF_early - SF_advanced        -0.017694 0.0477 702  -0.371  0.8672
 SF_intermediate - SF_advanced -0.010587 0.0477 702  -0.222  0.8672

ff_area = 80-90:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.024541 0.0436 702  -0.563  0.5738
 PF - SF_intermediate          -0.207631 0.0425 702  -4.887  &lt;.0001
 PF - SF_advanced              -0.268622 0.0477 702  -5.637  &lt;.0001
 SF_early - SF_intermediate    -0.183090 0.0436 702  -4.198  &lt;.0001
 SF_early - SF_advanced        -0.244081 0.0487 702  -5.012  &lt;.0001
 SF_intermediate - SF_advanced -0.060991 0.0477 702  -1.280  0.2412

ff_area = 90-100:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.697898 0.0466 702 -14.962  &lt;.0001
 PF - SF_intermediate          -0.498232 0.0425 702 -11.728  &lt;.0001
 PF - SF_advanced              -0.388819 0.0477 702  -8.159  &lt;.0001
 SF_early - SF_intermediate     0.199666 0.0466 702   4.281  &lt;.0001
 SF_early - SF_advanced         0.309079 0.0515 702   5.999  &lt;.0001
 SF_intermediate - SF_advanced  0.109413 0.0477 702   2.296  0.0220

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>emm_EBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_temp_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_EBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.31134 0.0229 710 -13.576  &lt;.0001
 PF - SF_intermediate          -0.30822 0.0229 710 -13.440  &lt;.0001
 PF - SF_advanced              -0.33912 0.0257 710 -13.183  &lt;.0001
 SF_early - SF_intermediate     0.00312 0.0229 710   0.136  0.8917
 SF_early - SF_advanced        -0.02777 0.0257 710  -1.080  0.3368
 SF_intermediate - SF_advanced -0.03090 0.0257 710  -1.201  0.3368

ff_area = 10-20:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.37596 0.0229 710 -16.394  &lt;.0001
 PF - SF_intermediate          -0.39664 0.0229 710 -17.296  &lt;.0001
 PF - SF_advanced              -0.40282 0.0257 710 -15.659  &lt;.0001
 SF_early - SF_intermediate    -0.02068 0.0229 710  -0.902  0.4411
 SF_early - SF_advanced        -0.02686 0.0257 710  -1.044  0.4411
 SF_intermediate - SF_advanced -0.00618 0.0257 710  -0.240  0.8101

ff_area = 20-30:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.39947 0.0229 710 -17.419  &lt;.0001
 PF - SF_intermediate          -0.41162 0.0229 710 -17.949  &lt;.0001
 PF - SF_advanced              -0.37628 0.0257 710 -14.627  &lt;.0001
 SF_early - SF_intermediate    -0.01216 0.0229 710  -0.530  0.5962
 SF_early - SF_advanced         0.02318 0.0257 710   0.901  0.4413
 SF_intermediate - SF_advanced  0.03534 0.0257 710   1.374  0.2549

ff_area = 30-40:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.36963 0.0229 710 -16.118  &lt;.0001
 PF - SF_intermediate          -0.39441 0.0229 710 -17.199  &lt;.0001
 PF - SF_advanced              -0.35405 0.0257 710 -13.763  &lt;.0001
 SF_early - SF_intermediate    -0.02478 0.0229 710  -1.081  0.3363
 SF_early - SF_advanced         0.01558 0.0257 710   0.606  0.5450
 SF_intermediate - SF_advanced  0.04036 0.0257 710   1.569  0.1757

ff_area = 40-50:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.26783 0.0229 710 -11.679  &lt;.0001
 PF - SF_intermediate          -0.30692 0.0229 710 -13.384  &lt;.0001
 PF - SF_advanced              -0.27221 0.0257 710 -10.582  &lt;.0001
 SF_early - SF_intermediate    -0.03909 0.0229 710  -1.705  0.1331
 SF_early - SF_advanced        -0.00438 0.0257 710  -0.170  0.8648
 SF_intermediate - SF_advanced  0.03471 0.0257 710   1.349  0.2132

ff_area = 50-60:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.23435 0.0229 710 -10.219  &lt;.0001
 PF - SF_intermediate          -0.25669 0.0229 710 -11.193  &lt;.0001
 PF - SF_advanced              -0.23102 0.0257 710  -8.981  &lt;.0001
 SF_early - SF_intermediate    -0.02234 0.0229 710  -0.974  0.3964
 SF_early - SF_advanced         0.00333 0.0257 710   0.129  0.8970
 SF_intermediate - SF_advanced  0.02567 0.0257 710   0.998  0.3964

ff_area = 60-70:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.28210 0.0229 710 -12.301  &lt;.0001
 PF - SF_intermediate          -0.30027 0.0229 710 -13.094  &lt;.0001
 PF - SF_advanced              -0.28100 0.0257 710 -10.923  &lt;.0001
 SF_early - SF_intermediate    -0.01817 0.0229 710  -0.793  0.5447
 SF_early - SF_advanced         0.00110 0.0257 710   0.043  0.9659
 SF_intermediate - SF_advanced  0.01928 0.0257 710   0.749  0.5447

ff_area = 70-80:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.34644 0.0229 710 -15.107  &lt;.0001
 PF - SF_intermediate          -0.35932 0.0229 710 -15.668  &lt;.0001
 PF - SF_advanced              -0.31589 0.0257 710 -12.280  &lt;.0001
 SF_early - SF_intermediate    -0.01287 0.0229 710  -0.561  0.5747
 SF_early - SF_advanced         0.03055 0.0257 710   1.188  0.2824
 SF_intermediate - SF_advanced  0.04343 0.0257 710   1.688  0.1377

ff_area = 80-90:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.41205 0.0229 710 -17.968  &lt;.0001
 PF - SF_intermediate          -0.37377 0.0229 710 -16.298  &lt;.0001
 PF - SF_advanced              -0.33940 0.0257 710 -13.194  &lt;.0001
 SF_early - SF_intermediate     0.03828 0.0229 710   1.669  0.1146
 SF_early - SF_advanced         0.07264 0.0257 710   2.824  0.0073
 SF_intermediate - SF_advanced  0.03436 0.0257 710   1.336  0.1820

ff_area = 90-100:
 contrast                      estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.81646 0.0229 710 -35.603  &lt;.0001
 PF - SF_intermediate          -0.76027 0.0229 710 -33.152  &lt;.0001
 PF - SF_advanced              -0.66797 0.0257 710 -25.966  &lt;.0001
 SF_early - SF_intermediate     0.05619 0.0229 710   2.450  0.0145
 SF_early - SF_advanced         0.14849 0.0257 710   5.772  &lt;.0001
 SF_intermediate - SF_advanced  0.09231 0.0257 710   3.588  0.0004

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>emm_SBA <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_temp_w1, <span class="at">specs =</span> <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_SBA, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ff_area = 1-10:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.587962 0.0289 710 -20.333  &lt;.0001
 PF - SF_intermediate          -0.545589 0.0289 710 -18.868  &lt;.0001
 PF - SF_advanced              -0.507504 0.0324 710 -15.646  &lt;.0001
 SF_early - SF_intermediate     0.042373 0.0289 710   1.465  0.1719
 SF_early - SF_advanced         0.080458 0.0324 710   2.480  0.0200
 SF_intermediate - SF_advanced  0.038085 0.0324 710   1.174  0.2407

ff_area = 10-20:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.452717 0.0289 710 -15.656  &lt;.0001
 PF - SF_intermediate          -0.533649 0.0289 710 -18.455  &lt;.0001
 PF - SF_advanced              -0.533435 0.0324 710 -16.445  &lt;.0001
 SF_early - SF_intermediate    -0.080932 0.0289 710  -2.799  0.0079
 SF_early - SF_advanced        -0.080719 0.0324 710  -2.488  0.0157
 SF_intermediate - SF_advanced  0.000214 0.0324 710   0.007  0.9948

ff_area = 20-30:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.343787 0.0289 710 -11.889  &lt;.0001
 PF - SF_intermediate          -0.504662 0.0289 710 -17.452  &lt;.0001
 PF - SF_advanced              -0.485148 0.0324 710 -14.956  &lt;.0001
 SF_early - SF_intermediate    -0.160875 0.0289 710  -5.563  &lt;.0001
 SF_early - SF_advanced        -0.141361 0.0324 710  -4.358  &lt;.0001
 SF_intermediate - SF_advanced  0.019514 0.0324 710   0.602  0.5476

ff_area = 30-40:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.227962 0.0289 710  -7.883  &lt;.0001
 PF - SF_intermediate          -0.415719 0.0289 710 -14.376  &lt;.0001
 PF - SF_advanced              -0.431674 0.0324 710 -13.308  &lt;.0001
 SF_early - SF_intermediate    -0.187757 0.0289 710  -6.493  &lt;.0001
 SF_early - SF_advanced        -0.203712 0.0324 710  -6.280  &lt;.0001
 SF_intermediate - SF_advanced -0.015955 0.0324 710  -0.492  0.6230

ff_area = 40-50:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.038035 0.0289 710  -1.315  0.2266
 PF - SF_intermediate          -0.203761 0.0289 710  -7.046  &lt;.0001
 PF - SF_advanced              -0.229835 0.0324 710  -7.086  &lt;.0001
 SF_early - SF_intermediate    -0.165726 0.0289 710  -5.731  &lt;.0001
 SF_early - SF_advanced        -0.191800 0.0324 710  -5.913  &lt;.0001
 SF_intermediate - SF_advanced -0.026074 0.0324 710  -0.804  0.4218

ff_area = 50-60:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.171567 0.0289 710   5.933  &lt;.0001
 PF - SF_intermediate          -0.055042 0.0289 710  -1.903  0.0793
 PF - SF_advanced              -0.059707 0.0324 710  -1.841  0.0793
 SF_early - SF_intermediate    -0.226609 0.0289 710  -7.837  &lt;.0001
 SF_early - SF_advanced        -0.231273 0.0324 710  -7.130  &lt;.0001
 SF_intermediate - SF_advanced -0.004665 0.0324 710  -0.144  0.8857

ff_area = 60-70:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.130327 0.0289 710   4.507  &lt;.0001
 PF - SF_intermediate          -0.048096 0.0289 710  -1.663  0.1160
 PF - SF_advanced              -0.071057 0.0324 710  -2.191  0.0432
 SF_early - SF_intermediate    -0.178423 0.0289 710  -6.170  &lt;.0001
 SF_early - SF_advanced        -0.201383 0.0324 710  -6.208  &lt;.0001
 SF_intermediate - SF_advanced -0.022961 0.0324 710  -0.708  0.4793

ff_area = 70-80:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.167226 0.0289 710   5.783  &lt;.0001
 PF - SF_intermediate          -0.027999 0.0289 710  -0.968  0.3332
 PF - SF_advanced               0.122546 0.0324 710   3.778  0.0003
 SF_early - SF_intermediate    -0.195225 0.0289 710  -6.751  &lt;.0001
 SF_early - SF_advanced        -0.044680 0.0324 710  -1.377  0.2026
 SF_intermediate - SF_advanced  0.150545 0.0324 710   4.641  &lt;.0001

ff_area = 80-90:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                  0.136825 0.0289 710   4.732  &lt;.0001
 PF - SF_intermediate           0.001449 0.0289 710   0.050  0.9600
 PF - SF_advanced               0.026896 0.0324 710   0.829  0.5196
 SF_early - SF_intermediate    -0.135376 0.0289 710  -4.682  &lt;.0001
 SF_early - SF_advanced        -0.109929 0.0324 710  -3.389  0.0015
 SF_intermediate - SF_advanced  0.025447 0.0324 710   0.784  0.5196

ff_area = 90-100:
 contrast                       estimate     SE  df t.ratio p.value
 PF - SF_early                 -0.069223 0.0289 710  -2.394  0.0254
 PF - SF_intermediate          -0.202703 0.0289 710  -7.010  &lt;.0001
 PF - SF_advanced              -0.040164 0.0324 710  -1.238  0.2593
 SF_early - SF_intermediate    -0.133480 0.0289 710  -4.616  &lt;.0001
 SF_early - SF_advanced         0.029059 0.0324 710   0.896  0.3706
 SF_intermediate - SF_advanced  0.162538 0.0324 710   5.011  &lt;.0001

Degrees-of-freedom method: satterthwaite 
P value adjustment: BH method for 6 tests </code></pre>
</div>
</div>
<section id="heterocedasticidade-2" class="level5">
<h5 class="anchored" data-anchor-id="heterocedasticidade-2">Heterocedasticidade</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função: resíduos normalizados vs n_obs, com controle de eixos</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>plot_resid_hetero <span class="ot">&lt;-</span> <span class="cf">function</span>(m_lme, dat, region_name,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m_lme, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">n_obs =</span> dat<span class="sc">$</span>n_obs, <span class="at">rnorm =</span> rn),</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(n_obs, rnorm)) <span class="sc">+</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)  </span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#title = region_name,</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cf">if</span> (show_x_lab) <span class="fu">expression</span>(n[obs]<span class="sc">~</span><span class="st">"(log scale)"</span>) <span class="cf">else</span> <span class="cn">NULL</span>,  </span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="cf">if</span> (show_y_lab) <span class="st">"Normalized residuals"</span> <span class="cf">else</span> <span class="cn">NULL</span>             </span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Monta cada painel com as regras pedidas:</span></span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="co"># - CBA: só Y</span></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a>p_het_cba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_CBA_temp_w1, model_cba_temp, <span class="st">"CBA"</span>,</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a><span class="co"># - EBA: só X</span></span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>p_het_eba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_EBA_temp_w1, model_eba_temp, <span class="st">"EBA"</span>,</span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">TRUE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a><span class="co"># - SBA: sem X e sem Y</span></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a>p_het_sba <span class="ot">&lt;-</span> <span class="fu">plot_resid_hetero</span>(model_SBA_temp_w1, model_sba_temp, <span class="st">"SBA"</span>,</span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_x_lab =</span> <span class="cn">FALSE</span>, <span class="at">show_y_lab =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel </span></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>painel_het_temp <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(p_het_cba, p_het_eba, p_het_sba,</span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a>painel_het_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/hetero_residuals_lme_temp.png"</span>, <span class="at">width=</span><span class="dv">8</span>, <span class="at">height=</span><span class="dv">6</span>, <span class="at">dpi=</span><span class="dv">400</span>, <span class="at">bg=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="qq-plot-2" class="level5">
<h5 class="anchored" data-anchor-id="qq-plot-2">QQ Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>qq_lme <span class="ot">&lt;-</span> <span class="cf">function</span>(m, <span class="at">region_name =</span> <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>, <span class="at">show_x_title =</span> <span class="cn">FALSE</span>){</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">rn =</span> rn), <span class="fu">aes</span>(<span class="at">sample =</span> rn)) <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y_title) <span class="fu">element_text</span>() <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="cf">if</span> (show_x_title) <span class="fu">element_text</span>() <span class="cf">else</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> region_name,</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Theoretical quantiles (N(0,1))"</span>,</span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="cf">if</span> (show_y_title) <span class="st">"Sample quantiles"</span> <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a><span class="co"># y só na 1ª coluna (CBA) e x só na 2ª (EBA)</span></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>qq_cba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_CBA_temp_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">TRUE</span>,  <span class="at">show_x_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>qq_eba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_EBA_temp_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>, <span class="at">show_x_title =</span> <span class="cn">TRUE</span>)</span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>qq_sba <span class="ot">&lt;-</span> <span class="fu">qq_lme</span>(model_SBA_temp_w1, <span class="st">""</span>, <span class="at">show_y_title =</span> <span class="cn">FALSE</span>, <span class="at">show_x_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>painel_qq_temp <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(qq_cba, qq_eba, qq_sba, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"hv"</span>)</span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>painel_qq_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/qqplot_temp.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ccc-de-lins-2" class="level4">
<h4 class="anchored" data-anchor-id="ccc-de-lins-2">CCC de Lins</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CBA</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>observado_cba_temp <span class="ot">&lt;-</span> model_cba_temp<span class="sc">$</span>Temp</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>previsto_cba_temp  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_temp_w1)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>ccc_result_cba_temp  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_cba_temp , previsto_cba_temp )</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>ccc_val_cba_temp <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_cba_temp<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="do">## EBA</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>observado_eba_temp <span class="ot">&lt;-</span> model_eba_temp<span class="sc">$</span>Temp</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>previsto_eba_temp  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_temp_w1)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>ccc_result_eba_temp  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_eba_temp , previsto_eba_temp )</span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>ccc_val_eba_temp <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_eba_temp<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a><span class="do">## SBA</span></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Obter os valores observados e previstos</span></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>observado_sba_temp <span class="ot">&lt;-</span> model_sba_temp<span class="sc">$</span>Temp</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>previsto_sba_temp  <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_temp_w1)</span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>ccc_result_sba_temp  <span class="ot">&lt;-</span> <span class="fu">CCC</span>(observado_sba_temp , previsto_sba_temp )</span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>ccc_val_sba_temp <span class="ot">&lt;-</span> <span class="fu">round</span>(ccc_result_sba_temp<span class="sc">$</span>rho.c[, <span class="st">"est"</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="efeitos-para-cada-ff_area-e-classe-florestal-2" class="level4">
<h4 class="anchored" data-anchor-id="efeitos-para-cada-ff_area-e-classe-florestal-2">Efeitos para cada ff_area e classe florestal</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos p/ plot “em_all”</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>em_df_cba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_CBA); em_df_cba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"CBA"</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>em_df_eba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_EBA); em_df_eba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"EBA"</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>em_df_sba <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_SBA); em_df_sba<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="st">"SBA"</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>em_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(em_df_cba, em_df_eba, em_df_sba) <span class="sc">%&gt;%</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo    =</span> <span class="fu">factor</span>(Tipo,    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparações dentro de cada faixa (matriz / pwpm)</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>em_cba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_CBA_temp_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>em_eba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_EBA_temp_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>em_sba_pw <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_SBA_temp_w1, <span class="sc">~</span> Tipo <span class="sc">|</span> ff_area, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                     PF SF_early SF_intermediate SF_advanced
PF               [26.0]   0.0009          &lt;.0001      0.0027
SF_early         0.1609   [25.9]          0.8111      0.9992
SF_intermediate  0.1986   0.0377          [25.8]      0.9107
SF_advanced      0.1670   0.0061         -0.0316      [25.9]

ff_area = 10-20
                       PF  SF_early SF_intermediate SF_advanced
PF                 [25.8]    1.0000          0.7407      0.0770
SF_early         0.000911    [25.8]          0.7280      0.0734
SF_intermediate -0.043123 -0.044034          [25.9]      0.4376
SF_advanced     -0.114637 -0.115547       -0.071513      [25.9]

ff_area = 20-30
                     PF SF_early SF_intermediate SF_advanced
PF               [25.7]   0.0810          0.0021      &lt;.0001
SF_early        -0.1013   [25.8]          0.6277      0.0306
SF_intermediate -0.1522  -0.0509          [25.8]      0.3318
SF_advanced     -0.2326  -0.1313         -0.0803      [25.9]

ff_area = 30-40
                     PF SF_early SF_intermediate SF_advanced
PF               [25.6]   0.1651          &lt;.0001      &lt;.0001
SF_early        -0.0878   [25.7]          0.0950      0.0001
SF_intermediate -0.1863  -0.0985          [25.8]      0.1083
SF_advanced     -0.2940  -0.2062         -0.1078      [25.9]

ff_area = 40-50
                     PF SF_early SF_intermediate SF_advanced
PF               [25.5]   0.0487          &lt;.0001      &lt;.0001
SF_early        -0.1098   [25.6]          0.0961      &lt;.0001
SF_intermediate -0.2081  -0.0982          [25.7]      0.0911
SF_advanced     -0.3194  -0.2095         -0.1113      [25.9]

ff_area = 50-60
                      PF SF_early SF_intermediate SF_advanced
PF                [25.5]   0.0013          0.0009      &lt;.0001
SF_early        -0.15731   [25.7]          0.9996      0.1485
SF_intermediate -0.16162 -0.00431          [25.7]      0.1790
SF_advanced     -0.25822 -0.10091        -0.09660      [25.8]

ff_area = 60-70
                     PF SF_early SF_intermediate SF_advanced
PF               [25.4]   &lt;.0001          0.0017      &lt;.0001
SF_early        -0.1948   [25.6]          0.7783      0.5402
SF_intermediate -0.1545   0.0403          [25.6]      0.1292
SF_advanced     -0.2585  -0.0637         -0.1040      [25.7]

ff_area = 70-80
                      PF SF_early SF_intermediate SF_advanced
PF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.26289   [25.6]          0.9983      0.9825
SF_intermediate -0.27000 -0.00711          [25.6]      0.9961
SF_advanced     -0.28058 -0.01769        -0.01059      [25.7]

ff_area = 80-90
                     PF SF_early SF_intermediate SF_advanced
PF               [25.3]   0.9431          &lt;.0001      &lt;.0001
SF_early        -0.0245   [25.3]          0.0002      &lt;.0001
SF_intermediate -0.2076  -0.1831          [25.5]      0.5761
SF_advanced     -0.2686  -0.2441         -0.0610      [25.6]

ff_area = 90-100
                    PF SF_early SF_intermediate SF_advanced
PF              [24.9]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.698   [25.6]          0.0001      &lt;.0001
SF_intermediate -0.498    0.200          [25.4]      0.0999
SF_advanced     -0.389    0.309           0.109      [25.3]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                      PF SF_early SF_intermediate SF_advanced
PF                [25.5]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.31134   [25.9]          0.9991      0.7021
SF_intermediate -0.30822  0.00312          [25.9]      0.6264
SF_advanced     -0.33912 -0.02777        -0.03090      [25.9]

ff_area = 10-20
                      PF SF_early SF_intermediate SF_advanced
PF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.37596   [25.8]          0.8040      0.7235
SF_intermediate -0.39664 -0.02068          [25.8]      0.9951
SF_advanced     -0.40282 -0.02686        -0.00618      [25.8]

ff_area = 20-30
                     PF SF_early SF_intermediate SF_advanced
PF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.3995   [25.7]          0.9518      0.8042
SF_intermediate -0.4116  -0.0122          [25.7]      0.5162
SF_advanced     -0.3763   0.0232          0.0353      [25.7]

ff_area = 30-40
                     PF SF_early SF_intermediate SF_advanced
PF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.3696   [25.7]          0.7016      0.9303
SF_intermediate -0.3944  -0.0248          [25.7]      0.3972
SF_advanced     -0.3541   0.0156          0.0404      [25.7]

ff_area = 40-50
                      PF SF_early SF_intermediate SF_advanced
PF                [25.3]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.26783   [25.6]          0.3220      0.9982
SF_intermediate -0.30692 -0.03909          [25.7]      0.5318
SF_advanced     -0.27221 -0.00438         0.03471      [25.6]

ff_area = 50-60
                      PF SF_early SF_intermediate SF_advanced
PF                [25.4]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.23435   [25.6]          0.7642      0.9992
SF_intermediate -0.25669 -0.02234          [25.6]      0.7507
SF_advanced     -0.23102  0.00333         0.02567      [25.6]

ff_area = 60-70
                     PF SF_early SF_intermediate SF_advanced
PF               [25.2]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.2821   [25.5]          0.8579      1.0000
SF_intermediate -0.3003  -0.0182          [25.5]      0.8770
SF_advanced     -0.2810   0.0011          0.0193      [25.5]

ff_area = 70-80
                     PF SF_early SF_intermediate SF_advanced
PF               [25.1]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.3464   [25.5]          0.9434      0.6348
SF_intermediate -0.3593  -0.0129          [25.5]      0.3306
SF_advanced     -0.3159   0.0306          0.0434      [25.4]

ff_area = 80-90
                     PF SF_early SF_intermediate SF_advanced
PF               [25.0]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.4120   [25.4]          0.3408      0.0251
SF_intermediate -0.3738   0.0383          [25.4]      0.5404
SF_advanced     -0.3394   0.0726          0.0344      [25.3]

ff_area = 90-100
                     PF SF_early SF_intermediate SF_advanced
PF               [24.5]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.8165   [25.3]          0.0689      &lt;.0001
SF_intermediate -0.7603   0.0562          [25.3]      0.0020
SF_advanced     -0.6680   0.1485          0.0923      [25.2]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ff_area = 1-10
                     PF SF_early SF_intermediate SF_advanced
PF               [25.3]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.5880   [25.9]          0.4591      0.0639
SF_intermediate -0.5456   0.0424          [25.8]      0.6434
SF_advanced     -0.5075   0.0805          0.0381      [25.8]

ff_area = 10-20
                       PF  SF_early SF_intermediate SF_advanced
PF                 [25.2]    &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.452717    [25.6]          0.0270      0.0626
SF_intermediate -0.533649 -0.080932          [25.7]      1.0000
SF_advanced     -0.533435 -0.080719        0.000213      [25.7]

ff_area = 20-30
                     PF SF_early SF_intermediate SF_advanced
PF               [25.1]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.3438   [25.5]          &lt;.0001      &lt;.0001
SF_intermediate -0.5047  -0.1609          [25.6]      0.9316
SF_advanced     -0.4851  -0.1414          0.0195      [25.6]

ff_area = 30-40
                    PF SF_early SF_intermediate SF_advanced
PF              [25.1]   &lt;.0001          &lt;.0001      &lt;.0001
SF_early        -0.228   [25.3]          &lt;.0001      &lt;.0001
SF_intermediate -0.416   -0.188          [25.5]      0.9609
SF_advanced     -0.432   -0.204          -0.016      [25.5]

ff_area = 40-50
                     PF SF_early SF_intermediate SF_advanced
PF               [25.2]   0.5534          &lt;.0001      &lt;.0001
SF_early        -0.0380   [25.2]          &lt;.0001      &lt;.0001
SF_intermediate -0.2038  -0.1657          [25.4]      0.8526
SF_advanced     -0.2298  -0.1918         -0.0261      [25.4]

ff_area = 50-60
                      PF SF_early SF_intermediate SF_advanced
PF                [25.3]   &lt;.0001          0.2275      0.2551
SF_early         0.17157   [25.1]          &lt;.0001      &lt;.0001
SF_intermediate -0.05504 -0.22661          [25.3]      0.9989
SF_advanced     -0.05971 -0.23127        -0.00466      [25.3]

ff_area = 60-70
                     PF SF_early SF_intermediate SF_advanced
PF               [25.2]   &lt;.0001          0.3441      0.1268
SF_early         0.1303   [25.0]          &lt;.0001      &lt;.0001
SF_intermediate -0.0481  -0.1784          [25.2]      0.8940
SF_advanced     -0.0711  -0.2014         -0.0230      [25.2]

ff_area = 70-80
                     PF SF_early SF_intermediate SF_advanced
PF               [25.1]   &lt;.0001          0.7676      0.0010
SF_early         0.1672   [24.9]          &lt;.0001      0.5139
SF_intermediate -0.0280  -0.1952          [25.1]      &lt;.0001
SF_advanced      0.1225  -0.0447          0.1505      [24.9]

ff_area = 80-90
                      PF SF_early SF_intermediate SF_advanced
PF                [24.9]   &lt;.0001          1.0000      0.8406
SF_early         0.13683   [24.8]          &lt;.0001      0.0041
SF_intermediate  0.00145 -0.13538          [24.9]      0.8615
SF_advanced      0.02690 -0.10993         0.02545      [24.9]

ff_area = 90-100
                     PF SF_early SF_intermediate SF_advanced
PF               [24.6]   0.0792          &lt;.0001      0.6027
SF_early        -0.0692   [24.7]          &lt;.0001      0.8070
SF_intermediate -0.2027  -0.1335          [24.8]      &lt;.0001
SF_advanced     -0.0402   0.0291          0.1625      [24.6]

Row and column labels: Tipo
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar matriz como data.frame</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>pw_cba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_cba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>pw_eba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_eba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>pw_sba_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pwpm</span>(em_sba_pw, <span class="at">sort =</span> <span class="cn">FALSE</span>))</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>pw_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pw_cba_df, pw_eba_df, pw_sba_df)</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(pw_df, <span class="at">file =</span> <span class="st">"data_group/matriz_contrastes_pwpm_temp.xlsx"</span>, <span class="at">rowNames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - análises</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>tabela_estilo_fig1 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region   =</span> region,</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover    =</span> Tipo,</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effect   =</span> emmean,</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> ff_area,</span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> upper.CL</span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"TEMP"</span>,</span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Cover, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(Interval, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,<span class="st">"40-50"</span>,</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Region, Cover, Interval) <span class="sc">%&gt;%</span></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Region, Cover, Variable, Effect, Interval, CI_lower, CI_upper)</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>  tabela_estilo_fig1,</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_temp.xlsx"</span>,</span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela final - SI</span></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar tabela base</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> em_all <span class="sc">%&gt;%</span></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cover =</span> <span class="fu">factor</span>(Tipo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interval =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"80-90"</span>,<span class="st">"90-100"</span>))</span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(region, Interval, Cover,</span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">Effect =</span> emmean,</span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_lower =</span> lower.CL,</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">CI_upper =</span> upper.CL)</span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorganizar para formato largo (larger table like Figure 2)</span></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a>tabela_fig2 <span class="ot">&lt;-</span> t2 <span class="sc">%&gt;%</span></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover) <span class="sc">%&gt;%</span></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> region,</span>
<span id="cb196-57"><a href="#cb196-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(Effect, CI_lower, CI_upper),</span>
<span id="cb196-58"><a href="#cb196-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_glue =</span> <span class="st">"{region}_{.value}"</span></span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Interval, Cover)</span>
<span id="cb196-61"><a href="#cb196-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-62"><a href="#cb196-62" aria-hidden="true" tabindex="-1"></a>openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(</span>
<span id="cb196-63"><a href="#cb196-63" aria-hidden="true" tabindex="-1"></a>  tabela_fig2,</span>
<span id="cb196-64"><a href="#cb196-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data_group/emmeans_intervalos_temp_table_final.xlsx"</span>,</span>
<span id="cb196-65"><a href="#cb196-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">rowNames =</span> <span class="cn">FALSE</span></span>
<span id="cb196-66"><a href="#cb196-66" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="constrastes-e-significancia-2" class="level4">
<h4 class="anchored" data-anchor-id="constrastes-e-significancia-2">Constrastes e significancia</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>get_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area<span class="sc">*</span>Tipo, <span class="at">lmer.df =</span> <span class="st">"satterthwaite"</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">by =</span> <span class="st">"ff_area"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>contrast_CBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_CBA_temp_w1, <span class="st">"CBA"</span>)</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>contrast_EBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_EBA_temp_w1, <span class="st">"EBA"</span>)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>contrast_SBA_df <span class="ot">&lt;-</span> <span class="fu">get_contrasts</span>(model_SBA_temp_w1, <span class="st">"SBA"</span>)</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(contrast_CBA_df, contrast_EBA_df, contrast_SBA_df) <span class="sc">%&gt;%</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"PF"</span>, contrast) <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"SF_"</span>, contrast)) <span class="sc">%&gt;%</span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(contrast, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"tipo1"</span>, <span class="st">"tipo2"</span>), <span class="at">sep =</span> <span class="st">" - "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)) <span class="sc">|</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>         (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ff_area =</span> <span class="fu">factor</span>(ff_area, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1-10"</span>,<span class="st">"10-20"</span>,<span class="st">"20-30"</span>,<span class="st">"30-40"</span>,</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"40-50"</span>,<span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span>)),</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)),</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF − SF</span></span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(all_contrasts, <span class="st">"data_group/contrast_PF_SF_temp.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="painel-temp" class="level3">
<h3 class="anchored" data-anchor-id="painel-temp">Painel Temp</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot de pontos</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>plot_point_temp <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_x =</span> <span class="cn">TRUE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(em_all, region <span class="sc">==</span> region_name)<span class="sc">%&gt;%</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tipo =</span> <span class="fu">factor</span>(Tipo) <span class="sc">%&gt;%</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_relevel</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fct_recode</span>(</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"PF"</span> <span class="ot">=</span> <span class="st">"PF"</span>,</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> emmean, <span class="at">color =</span> Tipo, <span class="at">group =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL, <span class="at">ymax =</span> upper.CL),</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>      <span class="co">#axis.text.x = element_blank(),</span></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_axes) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="cf">if</span> (show_y) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="sc">-</span><span class="dv">20</span>)) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="cf">if</span> (show_x) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7F3B08"</span>, <span class="st">"#FEE0B6"</span>, <span class="st">"#FDB863"</span>, <span class="st">"#E08214"</span>)) <span class="sc">+</span></span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="fl">26.5</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">24</span>, <span class="fl">26.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#labs(y = if (show_y) "Temperature\nfixed effects (°C·yr⁻¹)" else NULL) +</span></span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional cover (%)"</span>,</span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="cf">if</span> (show_y) <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Estimated marginal mean"</span>, <span class="st">"temperature (°C·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>))) <span class="cf">else</span> <span class="cn">NULL</span>) </span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb198-41"><a href="#cb198-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-42"><a href="#cb198-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-43"><a href="#cb198-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-44"><a href="#cb198-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Atualizar ordem dos fatores e renomear os labels</span></span>
<span id="cb198-45"><a href="#cb198-45" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb198-46"><a href="#cb198-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb198-47"><a href="#cb198-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf =</span> <span class="fu">factor</span>(tipo_sf, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)),</span>
<span id="cb198-48"><a href="#cb198-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_sf_label =</span> <span class="fu">fct_recode</span>(tipo_sf,</span>
<span id="cb198-49"><a href="#cb198-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb198-50"><a href="#cb198-50" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb198-51"><a href="#cb198-51" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb198-52"><a href="#cb198-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb198-53"><a href="#cb198-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-54"><a href="#cb198-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-55"><a href="#cb198-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar coluna categórica para estimate</span></span>
<span id="cb198-56"><a href="#cb198-56" aria-hidden="true" tabindex="-1"></a>all_contrasts <span class="ot">&lt;-</span> all_contrasts <span class="sc">%&gt;%</span></span>
<span id="cb198-57"><a href="#cb198-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb198-58"><a href="#cb198-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_cat =</span> <span class="fu">factor</span>(</span>
<span id="cb198-59"><a href="#cb198-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(estimate,</span>
<span id="cb198-60"><a href="#cb198-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">0</span>, <span class="cn">Inf</span>),</span>
<span id="cb198-61"><a href="#cb198-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;−0.3"</span>, <span class="st">"−0.3 to 0"</span>, <span class="st">"&gt;0"</span>)</span>
<span id="cb198-62"><a href="#cb198-62" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb198-63"><a href="#cb198-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;−0.3"</span>, <span class="st">"−0.3 to 0"</span>, <span class="st">"&gt;0"</span>)</span>
<span id="cb198-64"><a href="#cb198-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb198-65"><a href="#cb198-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb198-66"><a href="#cb198-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-67"><a href="#cb198-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap de contrastes</span></span>
<span id="cb198-68"><a href="#cb198-68" aria-hidden="true" tabindex="-1"></a>plot_heat_temp <span class="ot">&lt;-</span> <span class="cf">function</span>(region_name, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb198-69"><a href="#cb198-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">filter</span>(all_contrasts, region <span class="sc">==</span> region_name), </span>
<span id="cb198-70"><a href="#cb198-70" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> ff_area, <span class="at">y =</span> tipo_sf_label, <span class="at">fill =</span> estimate_cat)) <span class="sc">+</span></span>
<span id="cb198-71"><a href="#cb198-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">height =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb198-72"><a href="#cb198-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb198-73"><a href="#cb198-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"&lt;−0.3"</span> <span class="ot">=</span> <span class="st">"#4393C3"</span>, <span class="st">"−0.3 to 0"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>, <span class="st">"&gt;0"</span> <span class="ot">=</span> <span class="st">"#D6604D"</span>),</span>
<span id="cb198-74"><a href="#cb198-74" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"&lt;−0.3"</span>, <span class="st">"−0.3 to 0"</span>, <span class="st">"&gt;0"</span>),</span>
<span id="cb198-75"><a href="#cb198-75" aria-hidden="true" tabindex="-1"></a>                      <span class="at">drop =</span> <span class="cn">FALSE</span>,</span>
<span id="cb198-76"><a href="#cb198-76" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"LST (PF − SF)"</span>, <span class="st">"(°C)"</span>)))</span>
<span id="cb198-77"><a href="#cb198-77" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb198-78"><a href="#cb198-78" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb198-79"><a href="#cb198-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb198-80"><a href="#cb198-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-81"><a href="#cb198-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-82"><a href="#cb198-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-83"><a href="#cb198-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="cf">if</span> (show_y_labels) <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="cf">else</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-84"><a href="#cb198-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="cf">if</span> (show_legend) <span class="st">"right"</span> <span class="cf">else</span> <span class="st">"none"</span>,</span>
<span id="cb198-85"><a href="#cb198-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-86"><a href="#cb198-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb198-87"><a href="#cb198-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-88"><a href="#cb198-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb198-89"><a href="#cb198-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb198-90"><a href="#cb198-90" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb198-91"><a href="#cb198-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb198-92"><a href="#cb198-92" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-93"><a href="#cb198-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-94"><a href="#cb198-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-95"><a href="#cb198-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar gráficos para cada região</span></span>
<span id="cb198-96"><a href="#cb198-96" aria-hidden="true" tabindex="-1"></a>panel_CBA_temp <span class="ot">&lt;-</span> <span class="fu">plot_heat_temp</span>(<span class="st">"CBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb198-97"><a href="#cb198-97" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_temp</span>(<span class="st">"CBA"</span>, <span class="at">show_y =</span> <span class="cn">TRUE</span>, <span class="at">show_x =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb198-98"><a href="#cb198-98" aria-hidden="true" tabindex="-1"></a>panel_CBA_temp <span class="ot">&lt;-</span> panel_CBA_temp <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb198-99"><a href="#cb198-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-100"><a href="#cb198-100" aria-hidden="true" tabindex="-1"></a>panel_EBA_temp <span class="ot">&lt;-</span> <span class="fu">plot_heat_temp</span>(<span class="st">"EBA"</span>, <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb198-101"><a href="#cb198-101" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_temp</span>(<span class="st">"EBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_x =</span> <span class="cn">TRUE</span>,  <span class="at">show_legend =</span> <span class="cn">FALSE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb198-102"><a href="#cb198-102" aria-hidden="true" tabindex="-1"></a>panel_EBA_temp <span class="ot">&lt;-</span> panel_EBA_temp <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb198-103"><a href="#cb198-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-104"><a href="#cb198-104" aria-hidden="true" tabindex="-1"></a>panel_SBA_temp <span class="ot">&lt;-</span> <span class="fu">plot_heat_temp</span>(<span class="st">"SBA"</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_labels =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb198-105"><a href="#cb198-105" aria-hidden="true" tabindex="-1"></a>             <span class="fu">plot_point_temp</span>(<span class="st">"SBA"</span>, <span class="at">show_y =</span> <span class="cn">FALSE</span>, <span class="at">show_x =</span> <span class="cn">FALSE</span>, <span class="at">show_legend =</span> <span class="cn">TRUE</span>, <span class="at">show_y_axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb198-106"><a href="#cb198-106" aria-hidden="true" tabindex="-1"></a>panel_SBA_temp <span class="ot">&lt;-</span> panel_SBA_temp <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb198-107"><a href="#cb198-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-108"><a href="#cb198-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todos os painéis horizontalmente</span></span>
<span id="cb198-109"><a href="#cb198-109" aria-hidden="true" tabindex="-1"></a>final_panel_temp <span class="ot">&lt;-</span> (panel_CBA_temp <span class="sc">|</span> panel_EBA_temp <span class="sc">|</span> panel_SBA_temp)</span>
<span id="cb198-110"><a href="#cb198-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-111"><a href="#cb198-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir painel final</span></span>
<span id="cb198-112"><a href="#cb198-112" aria-hidden="true" tabindex="-1"></a>final_panel_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/em_fixed_fixed_temp.png"</span>,</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> final_panel_temp,</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 5095487 272.2    7437494 397.3  7437494 397.3
Vcells 9912301  75.7   17824054 136.0 17823645 136.0</code></pre>
</div>
</div>
<section id="todos-os-constraste-entre-frações-de-área-2" class="level4">
<h4 class="anchored" data-anchor-id="todos-os-constraste-entre-frações-de-área-2">Todos os constraste entre frações de área</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de modelos</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>modelos <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">CBA =</span> model_CBA_temp_w1, <span class="at">EBA =</span> model_EBA_temp_w1, <span class="at">SBA =</span> model_SBA_temp_w1)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar todos os contrastes PF - SF</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>get_all_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> ff_area <span class="sc">*</span> Tipo)</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  contrast_res <span class="ot">&lt;-</span> <span class="fu">contrast</span>(em, <span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">adjust =</span> <span class="st">"fdr"</span>)</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contrast_res)</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>region <span class="ot">&lt;-</span> region_name</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para todas as regiões</span></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(modelos, <span class="fu">names</span>(modelos), get_all_contrasts)</span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(all_contrasts_sup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'summary_emm' and 'data.frame': 2340 obs. of  7 variables:
 $ contrast: chr  "(10-20 PF) - (1-10 PF)" "(20-30 PF) - (1-10 PF)" "(20-30 PF) - (10-20 PF)" "(30-40 PF) - (1-10 PF)" ...
 $ estimate: num  -0.22 -0.358 -0.138 -0.444 -0.224 ...
 $ SE      : num  0.0425 0.0425 0.0425 0.0425 0.0425 ...
 $ df      : num  702 702 702 702 702 ...
 $ t.ratio : num  -5.18 -8.43 -3.25 -10.45 -5.27 ...
 $ p.value : num  6.81e-07 1.04e-15 1.94e-03 5.74e-23 4.35e-07 ...
 $ region  : chr  "CBA" "CBA" "CBA" "CBA" ...
 - attr(*, "estName")= chr "estimate"
 - attr(*, "pri.vars")= chr "contrast"
 - attr(*, "adjust")= chr "fdr"
 - attr(*, "side")= num 0
 - attr(*, "delta")= num 0
 - attr(*, "type")= chr "link"
 - attr(*, "mesg")= chr [1:2] "Degrees-of-freedom method: kenward-roger" "P value adjustment: fdr method for 780 tests"
 - attr(*, "digits")= int 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair contrastes entre PF e SF</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(contrast, <span class="st">"PF"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(contrast, <span class="st">"SF_"</span>))</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair informações usando regex</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Regex para capturar (faixa tipo) - (faixa tipo)</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>extr <span class="ot">&lt;-</span> <span class="fu">str_match</span>(all_contrasts_sup<span class="sc">$</span>contrast,</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"</span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">) - </span><span class="sc">\\</span><span class="st">(([^ ]+) ([^)]+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar colunas extraídas</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa1 =</span> extr[, <span class="dv">2</span>],</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo1 =</span> extr[, <span class="dv">3</span>],</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa2 =</span> extr[, <span class="dv">4</span>],</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo2 =</span> extr[, <span class="dv">5</span>]</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((tipo1 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo2 <span class="sc">%in%</span> sf_levels) <span class="sc">|</span> (tipo2 <span class="sc">==</span> <span class="st">"PF"</span> <span class="sc">&amp;</span> tipo1 <span class="sc">%in%</span> sf_levels)) <span class="sc">%&gt;%</span></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa1, faixa2),</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, faixa2, faixa1),</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, tipo2, tipo1),</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">if_else</span>(tipo1 <span class="sc">==</span> <span class="st">"PF"</span>, estimate, <span class="sc">-</span>estimate),  <span class="co"># garantir PF - SF</span></span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_label =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar fatores</span></span>
<span id="cb203-30"><a href="#cb203-30" aria-hidden="true" tabindex="-1"></a>faixas_niveis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>,</span>
<span id="cb203-31"><a href="#cb203-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80-90"</span>, <span class="st">"90-100"</span>)</span>
<span id="cb203-32"><a href="#cb203-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-33"><a href="#cb203-33" aria-hidden="true" tabindex="-1"></a>sf_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)</span>
<span id="cb203-34"><a href="#cb203-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-35"><a href="#cb203-35" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb203-36"><a href="#cb203-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-37"><a href="#cb203-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_PF =</span> <span class="fu">factor</span>(faixa_PF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb203-38"><a href="#cb203-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">faixa_SF =</span> <span class="fu">factor</span>(faixa_SF, <span class="at">levels =</span> faixas_niveis),</span>
<span id="cb203-39"><a href="#cb203-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF  =</span> <span class="fu">factor</span>(tipo_SF,  <span class="at">levels =</span> sf_levels)</span>
<span id="cb203-40"><a href="#cb203-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb203-41"><a href="#cb203-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-42"><a href="#cb203-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-43"><a href="#cb203-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação mantendo sinal</span></span>
<span id="cb203-44"><a href="#cb203-44" aria-hidden="true" tabindex="-1"></a>all_contrasts_sup <span class="ot">&lt;-</span> all_contrasts_sup <span class="sc">%&gt;%</span></span>
<span id="cb203-45"><a href="#cb203-45" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb203-46"><a href="#cb203-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">tipo_SF =</span> <span class="fu">fct_recode</span>(tipo_SF,</span>
<span id="cb203-47"><a href="#cb203-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF early"</span> <span class="ot">=</span> <span class="st">"SF_early"</span>,</span>
<span id="cb203-48"><a href="#cb203-48" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF intermediate"</span> <span class="ot">=</span> <span class="st">"SF_intermediate"</span>,</span>
<span id="cb203-49"><a href="#cb203-49" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"SF advanced"</span> <span class="ot">=</span> <span class="st">"SF_advanced"</span>)</span>
<span id="cb203-50"><a href="#cb203-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb203-51"><a href="#cb203-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb203-52"><a href="#cb203-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">case_when</span>(</span>
<span id="cb203-53"><a href="#cb203-53" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"&lt;-0.6"</span>,</span>
<span id="cb203-54"><a href="#cb203-54" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"-0.3 – -0.6"</span>,</span>
<span id="cb203-55"><a href="#cb203-55" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">&amp;</span> estimate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"0 – -0.3"</span>,</span>
<span id="cb203-56"><a href="#cb203-56" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"&gt;0"</span></span>
<span id="cb203-57"><a href="#cb203-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb203-58"><a href="#cb203-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate_class =</span> <span class="fu">factor</span>(estimate_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;-0.6"</span>, <span class="st">"-0.3 – -0.6"</span>, <span class="st">"0 – -0.3"</span>, <span class="st">"&gt;0"</span>))</span>
<span id="cb203-59"><a href="#cb203-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb203-60"><a href="#cb203-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-61"><a href="#cb203-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-62"><a href="#cb203-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb203-63"><a href="#cb203-63" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_contrasts_sup, </span>
<span id="cb203-64"><a href="#cb203-64" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> faixa_SF, <span class="at">y =</span> faixa_PF, <span class="at">fill =</span> estimate_class)) <span class="sc">+</span></span>
<span id="cb203-65"><a href="#cb203-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb203-66"><a href="#cb203-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> sig_label), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb203-67"><a href="#cb203-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb203-68"><a href="#cb203-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&lt;-0.6"</span> <span class="ot">=</span> <span class="st">"#2166AC"</span>,</span>
<span id="cb203-69"><a href="#cb203-69" aria-hidden="true" tabindex="-1"></a>  <span class="st">"-0.3 – -0.6"</span> <span class="ot">=</span> <span class="st">"#4393C3"</span>,</span>
<span id="cb203-70"><a href="#cb203-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">"0 – -0.3"</span> <span class="ot">=</span> <span class="st">"#92C5DE"</span>,</span>
<span id="cb203-71"><a href="#cb203-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;0"</span> <span class="ot">=</span> <span class="st">"#F4A582"</span></span>
<span id="cb203-72"><a href="#cb203-72" aria-hidden="true" tabindex="-1"></a>), <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(Delta<span class="sc">~</span><span class="st">"LST (PF - SF)"</span>, <span class="st">"(°C·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>))))<span class="sc">+</span></span>
<span id="cb203-73"><a href="#cb203-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(tipo_SF <span class="sc">~</span> region) <span class="sc">+</span></span>
<span id="cb203-74"><a href="#cb203-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>) <span class="sc">+</span></span>
<span id="cb203-75"><a href="#cb203-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb203-76"><a href="#cb203-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb203-77"><a href="#cb203-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb203-78"><a href="#cb203-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb203-79"><a href="#cb203-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb203-80"><a href="#cb203-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb203-81"><a href="#cb203-81" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"SF fractional cover (%)"</span>,</span>
<span id="cb203-82"><a href="#cb203-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"PF fractional cover (%)"</span>)</span>
<span id="cb203-83"><a href="#cb203-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-84"><a href="#cb203-84" aria-hidden="true" tabindex="-1"></a>heatmap_all_contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_temp.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/contrastes_fixed_efects_temp.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 5075655 271.1    7437494 397.3  7437494 397.3
Vcells 9880282  75.4   17824054 136.0 17823645 136.0</code></pre>
</div>
</div>
</section>
</section>
<section id="random-effect-2" class="level3">
<h3 class="anchored" data-anchor-id="random-effect-2">Random effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para extrair efeitos aleatórios com IC por região</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>extract_random_effects <span class="ot">&lt;-</span> <span class="cf">function</span>(model, region_name) {</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Efeitos aleatórios com variância condicional</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  ran <span class="ot">&lt;-</span> <span class="fu">ranef</span>(model, <span class="at">condVar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extrair efeitos por ano</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(ran_df) <span class="ot">&lt;-</span> <span class="st">"effect"</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>  ran_df<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">rownames</span>(ran<span class="sc">$</span>Ano)</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intervalos de confiança (erro padrão)</span></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">attr</span>(ran<span class="sc">$</span>Ano, <span class="st">"postVar"</span>)[<span class="dv">1</span>, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>  ran_df <span class="ot">&lt;-</span> ran_df <span class="sc">%&gt;%</span></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> se,</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> effect <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper =</span> effect <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">region =</span> region_name</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ran_df)</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar para os três modelos (substitua pelos seus objetos reais)</span></span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>random_cba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_CBA_temp_w1, <span class="st">"CBA"</span>)</span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>random_eba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_EBA_temp_w1, <span class="st">"EBA"</span>)</span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>random_sba <span class="ot">&lt;-</span> <span class="fu">extract_random_effects</span>(model_SBA_temp_w1, <span class="st">"SBA"</span>)</span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar tudo</span></span>
<span id="cb206-31"><a href="#cb206-31" aria-hidden="true" tabindex="-1"></a>random_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(random_cba, random_eba, random_sba)</span>
<span id="cb206-32"><a href="#cb206-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-33"><a href="#cb206-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Garantir que o ano seja ordenável</span></span>
<span id="cb206-34"><a href="#cb206-34" aria-hidden="true" tabindex="-1"></a>random_all<span class="sc">$</span>ano <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(random_all<span class="sc">$</span>ano))</span>
<span id="cb206-35"><a href="#cb206-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-36"><a href="#cb206-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb206-37"><a href="#cb206-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(random_all, <span class="st">"data_group/random_effects_temp.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-4" class="level5">
<h5 class="anchored" data-anchor-id="plot-4">Plot</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>p1_rand_temp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(random_all, <span class="fu">aes</span>(<span class="at">x =</span> ano, <span class="at">y =</span> effect)) <span class="sc">+</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="st">"#E08214"</span>) <span class="sc">+</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2001</span>, <span class="dv">2021</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">#strip.text = element_text(face = "bold", size = 13)) +</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">atop</span>(<span class="st">"Temperature"</span>, <span class="st">"random effects (°C·yr"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="st">")"</span>)))</span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>p1_rand_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/histogram_random_temp.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="predicted-2" class="level3">
<h3 class="anchored" data-anchor-id="predicted-2">Predicted</h3>
<section id="plot-5" class="level4">
<h4 class="anchored" data-anchor-id="plot-5">Plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>model_cba_temp<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_CBA_temp_w1, model_cba_temp)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>model_eba_temp<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_EBA_temp_w1, model_eba_temp)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>model_sba_temp<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_SBA_temp_w1, model_sba_temp)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>r2_cba_temp_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_CBA_temp_w1, model_cba_temp, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>r2_eba_temp_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_EBA_temp_w1, model_eba_temp, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>r2_sba_temp_lab <span class="ot">&lt;-</span> <span class="fu">r2_lmer_w</span>(model_SBA_temp_w1, model_sba_temp, <span class="at">type =</span> <span class="st">"cond"</span>)</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>all_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(model_cba_temp<span class="sc">$</span>Temp, model_cba_temp<span class="sc">$</span>predicted,</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>              model_eba_temp<span class="sc">$</span>Temp, model_eba_temp<span class="sc">$</span>predicted,</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>              model_sba_temp<span class="sc">$</span>Temp, model_sba_temp<span class="sc">$</span>predicted)</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>rng     <span class="ot">&lt;-</span> <span class="fu">range</span>(all_vals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>pad     <span class="ot">&lt;-</span> <span class="fl">0.02</span> <span class="sc">*</span> <span class="fu">diff</span>(rng)</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>((rng[<span class="dv">1</span>] <span class="sc">-</span> pad) <span class="sc">/</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((rng[<span class="dv">2</span>] <span class="sc">+</span> pad) <span class="sc">/</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>brks    <span class="ot">&lt;-</span> <span class="fu">seq</span>(lim_min, lim_max, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Função base do gráfico (escala 1:1 e linha 45°)</span></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, titulo, subtitulo){</span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Temp, predicted)) <span class="sc">+</span></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span>   </span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(lim_min, lim_max), <span class="at">breaks =</span> brks,</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed LST (°C·yr⁻¹)"</span>, </span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Predicted LST (°C·yr⁻¹)"</span>,</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> titulo, <span class="at">subtitle =</span> subtitulo)</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="painel-2" class="level4">
<h4 class="anchored" data-anchor-id="painel-2">Painel</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>cba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_cba_temp, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_cba_temp_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_cba_temp))</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>eba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_eba_temp, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_eba_temp_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_eba_temp)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>sba_pf <span class="ot">&lt;-</span> <span class="fu">make_plot</span>(model_sba_temp, <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r2_sba_temp_lab, <span class="dv">3</span>), <span class="st">" | CCC = "</span>, ccc_val_sba_temp)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Painel</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>p3_pred_temp <span class="ot">&lt;-</span> (cba_pf <span class="sc">+</span> eba_pf <span class="sc">+</span> sba_pf) <span class="sc">+</span></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"serif"</span>)</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>p3_pred_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_observed_temp.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 5134829 274.3    7437494 397.3  7437494 397.3
Vcells 9965809  76.1   17824054 136.0 17823645 136.0</code></pre>
</div>
</div>
</section>
</section>
<section id="model-plotting-2" class="level3">
<h3 class="anchored" data-anchor-id="model-plotting-2">Model plotting</h3>
<section id="cba-2" class="level4">
<h4 class="anchored" data-anchor-id="cba-2">CBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp <span class="ot">&lt;-</span> model_cba_temp <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_CBA_temp_w1)  </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp <span class="ot">&lt;-</span> model_cba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb213-32"><a href="#cb213-32" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb213-33"><a href="#cb213-33" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb213-34"><a href="#cb213-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb213-35"><a href="#cb213-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-36"><a href="#cb213-36" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb213-37"><a href="#cb213-37" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb213-38"><a href="#cb213-38" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb213-39"><a href="#cb213-39" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb213-40"><a href="#cb213-40" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb213-41"><a href="#cb213-41" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb213-42"><a href="#cb213-42" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp[model_cba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb213-43"><a href="#cb213-43" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>model_cba_all_temp <span class="ot">&lt;-</span> model_cba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>m1_temp_cba <span class="ot">&lt;-</span> model_cba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Temp, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">24</span>, <span class="dv">27</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted temperature (°C) - CBA"</span>,</span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb214-30"><a href="#cb214-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb214-31"><a href="#cb214-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-32"><a href="#cb214-32" aria-hidden="true" tabindex="-1"></a>m1_temp_cba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_temp_CBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eba-2" class="level4">
<h4 class="anchored" data-anchor-id="eba-2">EBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp <span class="ot">&lt;-</span> model_eba_temp <span class="sc">%&gt;%</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_EBA_temp_w1)  </span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp <span class="ot">&lt;-</span> model_eba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-35"><a href="#cb216-35" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb216-36"><a href="#cb216-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb216-37"><a href="#cb216-37" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb216-38"><a href="#cb216-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb216-39"><a href="#cb216-39" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb216-40"><a href="#cb216-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb216-41"><a href="#cb216-41" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp[model_eba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb216-42"><a href="#cb216-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>model_eba_all_temp <span class="ot">&lt;-</span> model_eba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>m1_temp_eba <span class="ot">&lt;-</span> model_eba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area <span class="sc">*</span> <span class="dv">10</span>, <span class="at">y =</span> Temp, <span class="at">color =</span> vegetation)) <span class="sc">+</span>  <span class="co"># Define 'color' no aes</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># Ajusta tamanho e transparência dos pontos</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Mantém cor no grupo</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">23</span>, <span class="dv">27</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted temperature (°C) - EBA"</span>,</span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb217-30"><a href="#cb217-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb217-31"><a href="#cb217-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-32"><a href="#cb217-32" aria-hidden="true" tabindex="-1"></a>m1_temp_eba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_temp_EBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sba-2" class="level4">
<h4 class="anchored" data-anchor-id="sba-2">SBA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Atribuindo os dados</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp <span class="ot">&lt;-</span> model_sba_temp <span class="sc">%&gt;%</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">as.integer</span>(ff_area),             </span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetation =</span> <span class="fu">as.character</span>(Tipo),         </span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">predict</span>(model_SBA_temp_w1)  </span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar níveis (se quiser controlar a legenda)</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp <span class="ot">&lt;-</span> model_sba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation,</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>,<span class="st">"SF_early"</span>,<span class="st">"SF_intermediate"</span>,<span class="st">"SF_advanced"</span>)))</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"1-10"</span>,</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"10-20"</span>,</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"20-30"</span>,</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"30-40"</span>,</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"40-50"</span>,</span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"50-60"</span>,</span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">6</span></span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"60-70"</span>,</span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">7</span></span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"70-80"</span>,</span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"80-90"</span>,</span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">9</span></span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>ff_area<span class="sc">==</span> <span class="st">"90-100"</span>,</span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"area"</span>)]<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb219-34"><a href="#cb219-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-35"><a href="#cb219-35" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb219-36"><a href="#cb219-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"PF"</span></span>
<span id="cb219-37"><a href="#cb219-37" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb219-38"><a href="#cb219-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_early"</span></span>
<span id="cb219-39"><a href="#cb219-39" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb219-40"><a href="#cb219-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_intermediate"</span></span>
<span id="cb219-41"><a href="#cb219-41" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp[model_sba_all_temp<span class="sc">$</span>type<span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb219-42"><a href="#cb219-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"vegetation"</span>)]<span class="ot">&lt;-</span><span class="st">"SF_advanced"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar os níveis de 'Tipo'</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>model_sba_all_temp <span class="ot">&lt;-</span> model_sba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vegetation =</span> <span class="fu">factor</span>(vegetation, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF_early"</span>, <span class="st">"SF_intermediate"</span>, <span class="st">"SF_advanced"</span>)))</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>m1_temp_sba <span class="ot">&lt;-</span> model_sba_all_temp <span class="sc">%&gt;%</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Temp))<span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> area<span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> Temp, <span class="at">color =</span> vegetation)) <span class="sc">+</span> </span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">group =</span> vegetation, <span class="at">color =</span> vegetation), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span>  </span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"#ACD39E"</span>, <span class="st">"#5AAE61"</span>, <span class="st">"#1B7837"</span>), </span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="cn">NULL</span>,  </span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PF"</span>, <span class="st">"SF early"</span>, <span class="st">"SF intermediate"</span>, <span class="st">"SF advanced"</span>)) <span class="sc">+</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">23</span>, <span class="dv">27</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ano, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fractional forest coverage (%)"</span>, </span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted temperature (°C) - SBA"</span>,</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Tamanho do texto da legenda</span></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Centraliza título</span></span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a>m1_temp_sba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_temp_SBA.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="painel-predict-all-variables" class="level2">
<h2 class="anchored" data-anchor-id="painel-predict-all-variables">Painel Predict all variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar os três painéis em um único layout 3x3</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>painel_pred_fixed <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  p1_pred_prec, p2_pred_evapo, p3_pred_temp,</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>painel_pred_fixed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/predicted_observed_all_vars.png"</span>,</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> painel_pred_fixed,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="heterocedasticidade-3" class="level3">
<h3 class="anchored" data-anchor-id="heterocedasticidade-3">Heterocedasticidade</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar os três painéis em um único layout 3x3</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>painel_het <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  painel_het_prec, painel_het_evapo, painel_het_temp,</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>painel_het</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/hetero_residuals_lme_all_vars.png"</span>,</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> painel_het,</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="qq-plot-3" class="level3">
<h3 class="anchored" data-anchor-id="qq-plot-3">QQ Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar os três painéis em um único layout 3x3</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>painel_qq <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  painel_qq_prec, painel_qq_evapo, painel_qq_temp,</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>painel_qq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/supplemental_material/qqplot_all_vars.png"</span>,</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> painel_qq,</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="painel-fixed-and-random-effects" class="level2">
<h2 class="anchored" data-anchor-id="painel-fixed-and-random-effects">Painel fixed and random effects</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed Effects</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajuste das margens</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  p1_point_prec <span class="ot">&lt;-</span> final_panel_prec <span class="sc">+</span> </span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">30</span>))</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>  p1_point_evapo <span class="ot">&lt;-</span> final_panel_evapo <span class="sc">+</span> </span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">30</span>)) </span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>  p1_point_temp <span class="ot">&lt;-</span> final_panel_temp <span class="sc">+</span> </span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">30</span>))</span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Criar painel com espaçamento ajustado</span></span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a>  painel_fixed <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>    p1_point_prec, p1_point_evapo, p1_point_temp,</span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  <span class="co"># Letras dos subplots</span></span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb228-23"><a href="#cb228-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"v"</span>,                <span class="co"># Alinhamento vertical</span></span>
<span id="cb228-24"><a href="#cb228-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)        <span class="co"># Força os plots a terem alturas iguais</span></span>
<span id="cb228-25"><a href="#cb228-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb228-26"><a href="#cb228-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-27"><a href="#cb228-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Salvar figura final</span></span>
<span id="cb228-28"><a href="#cb228-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"fig/painels/effect_fix_climate_x_fractional_forest.png"</span>, </span>
<span id="cb228-29"><a href="#cb228-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> painel_fixed, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb228-30"><a href="#cb228-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-31"><a href="#cb228-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"fig/painels/effect_fix_climate_x_fractional_forest.pdf"</span>, </span>
<span id="cb228-32"><a href="#cb228-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> painel_fixed, <span class="at">device =</span> cairo_pdf, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb228-33"><a href="#cb228-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-34"><a href="#cb228-34" aria-hidden="true" tabindex="-1"></a>  painel_fixed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Effects</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajuste das margens</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  p1_rand_prec <span class="ot">&lt;-</span> p1_rand_prec <span class="sc">+</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">20</span>))</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>  p2_rand_evapo <span class="ot">&lt;-</span> p1_rand_evapo <span class="sc">+</span> </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> </span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">20</span>)) </span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>  p3_rand_temp <span class="ot">&lt;-</span> p1_rand_temp <span class="sc">+</span> </span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_x_discrete(expand = c(0.05, 0.05)) + </span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">20</span>))</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Criar painel com espaçamento ajustado</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>  painel_random <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>    p1_rand_prec, p2_rand_evapo, p3_rand_temp,</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  <span class="co"># Letras dos subplots</span></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.label =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"v"</span>,                <span class="co"># Alinhamento vertical</span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)        <span class="co"># Força os plots a terem alturas iguais</span></span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>  painel_random</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="code_climate_forest_regeneration_files/figure-html/unnamed-chunk-95-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Salvar figura final</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"fig/painels/effect_rand_pf_sf.png"</span>,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"fig/painels/effect_rand_pf_sf.pdf"</span>,</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>